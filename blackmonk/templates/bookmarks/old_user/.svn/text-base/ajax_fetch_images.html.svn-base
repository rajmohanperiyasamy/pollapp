{% load i18n %}
{% if err_msg %}
	<div id='alert_bar' class='alert_bar'>
		<span class='icon-alert' width='300px'></span>
		<h4 id='message'>{{ err_msg }}</h4>
	</div>
{% else %}
<style type="text/css">
.alert_bar {
    -moz-transition: all 0.6s ease-in-out 0s;
    background: -moz-linear-gradient(center top , #9A9A9A 0pt, #787878 45px) repeat scroll 0 0 #787878;
    border-bottom: 1px solid rgba(0, 0, 0, 0.224);
    border-radius: 5px 5px 5px 5px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5), 0 0 1px rgba(0, 0, 0, 0.2) inset;
    margin: 0 auto 10px;
    min-height: 36px;
    opacity: 1;
    overflow: hidden;
    padding-left: 10px;
    position: relative;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.35);
    white-space: nowrap;
    width: 600px;
    z-index: 10;
}
.alert_bar .icon-alert {
    float: left;
    height: 16px;
    margin-right: 10px;
    margin-top: 10px;
    width: 16px;
}
.alert_bar h4 {
    color: #FFFFFF;
    float: left;
    font-size: 14px;
    padding: 9px 0;
}
</style>
<div id="Bookmark-add" class="group">
    <div class='bookmark' id="add-new-Bookmark">
        <div class="fields hform">
		<form action="{% url 'bookmark_add_bookmark' %}{%if bookmark %}?aid={{bookmark.id}}{%endif%}" name="mform1" onsubmit="return validate_category()" id="mform1" method="post" class="add_venue">
		{% csrf_token %}
			<input type='hidden' id='id_source_url'		 name='source_url' 	   value="{{source_url}}"></input>
			<input type='hidden' id='id_seo_title' 	 	 name='seo_title'	   value="{{seo_title}}"></input>
        	<input type='hidden' id='id_seo_description' name='seo_description' value="{{seo_description}}"></input>
        	
			<div class="field-group">
				<div class="fields-head"></div>
				<div class="field text-field fd-title">
			        <div class="label"><label for="">{% trans 'Title' %}<span class="required-field">*</span></label></div>
			        <div class="value" >
			            {{form.title}}
			            <span class="tip">
			            	{{ globalsettings.website_url }}/{% trans 'bookmarks' %}/
			            	<input type="text" onkeyup="fillslug(this.value)" name="slug" value="{{ slug }}" id="id_slug" class="default-url">
			            </span>
			        </div>
			    </div>
			</div>
			<div class="field-group">
			    <div class="field select-field">
			        <div class="label"><label for="">{% trans 'Category' %}<span class="required-field">*</span></label></div>
			        <div class="value">
			            {{ form.category }}
			        </div>
			    </div>
			</div>
			<div class="field-group">
				<div class="field text-field fd-title">
			        <div class="label"><label for="">{% trans 'Summary' %}<span class="required-field">*</span></label></div>
			        <div class="value" >
			            {{form.summary}}
			        </div>
			    </div>
			</div>
			<div class="field-group" id='ajax_image_grid' >
				{% if img_url_list %}
				<div class="field text-field">
				    <div class="label"><label for="">{% trans 'Select Image' %}</label></div>
				    <div class="value">
				        <div class="image_grid">
							{% for image in img_url_list %}
				            <div class="image_block {% cycle '' '' '' 'mr_0' %}">
				            	<span class="cform-radio-container"><input class="submit_thumb" name="image_url" value="{{image}}" {% if present_imageurl == image %}checked="checked"{% endif %} type="radio"><span class="cform-radio-element"></span></span>
				                <span class="image_wrap inline-block">
				                	<span class="item-thumb thumb-110">
				                        <span class="thumb-in">
				                            <span class="thumb">
												<img src="{{image}}" class="inline-block">
												<span class="inline-block h100"></span>
											</span>
				                        </span>
				                    </span>
				                </span>
				            </div>
						{% cycle '' '' '' '<div class="clear"></div>'%}
						{% endfor %}
						</div>
				    </div>
				</div> 
				{% endif %}
			</div>
            <div class="form-submit right group">
	            <button class="cform-button" type="button" roll="button" onclick="location.replace('{% url 'bookmark_dash_board' %}')">
	            	<span class="cform-button-text">{% trans 'Cancel' %}</span>
	            </button>
	            <button id="save_button" name="save_button" class="cform-button prime" value="save" >
	            <!-- button id="save_button" name="save_button" class="cform-button prime" type="button" roll="button" -->
	            	<span class="cform-button-text">{% trans 'SAVE' %}</span>
	            </button>
	            
	            <button id="save_draft_button" name="save_draft_button" class="cform-button prime" value="save draft" >
	            	<span class="cform-button-text">{% trans 'SAVE DRAFT' %}</span>
	            </button>
	        </div>
		</form>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$('#id_category').chosen();
		$("#save_button_NOTUSED").live('click',function(event){
			$.ajax({    
				type:		"POST",
				url: 		'{% url 'bookmark_add_bookmark' %}',
			    data:   	"source_url="+$("#id_source_url").val(),
			    dataType: 	"html",
			    success: 	function( result ) {
			    				location.replace('{% url 'bookmark_dash_board' %}')
			    			},
			    error:		function( result ) { 
			    				$("#proceed_with_details").html(result);
			    			}
		  	});
		});
		$("#mform1").validate({
			ignore:'',
			highlight: 		function(element, errorClass){$(element).parent('div').parent('div').addClass('field-error');	$(element).addClass("error");	},
			unhighlight: 	function(element, errorClass){$(element).parent('div').parent('div').removeClass('field-error');$(element).removeClass("error");},
			errorPlacement: function(error, element){},
		   	rules:{
		    	title: 		"required",
		    	slug:		"required",
		    	category:	"required",
		    	summary:	"required",
    			image_url: 	"required"	
		   	}	
		});
	});

function slug(value){
	_slugify_strip_re = /[^\w\s-]/g;
	_slugify_hyphenate_re = /[-\s]+/g;
	value = value.replace(_slugify_strip_re, '').trim().toLowerCase();
	value = value.replace(_slugify_hyphenate_re, '-');
	$("#id_slug").val(value);
}
</script>
{% endif %}