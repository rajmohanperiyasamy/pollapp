{% load thumbnail %}
{% load i18n %}
{% load truncate_filter %}
{% load mptt_comments_tags %}
{% load ds_utils %}
{% if photos %}
<input type="hidden" value="{{view_type}}" name="view_type" id="id_hid_view_type">
<div class="pD20 pDt0 cLrfX">                                                                                     
 	
 	<div class="row-fluid">
     	<div class="tLbR mRb10">
            <div class="tLbR-iR">
				<p class="ib mRb0 mRt4 cLr-lTgRy fS12">{{object_count}} galleries</p>  
                <div class="btn-toolbar pLrT hP">
                    <div id="media-toggle" class="btn-group" data-toggle="buttons-radio">	                                        
                        <button type="button" class="btn btn-link c-gD {% if view_type == 'grid' %}active{% endif %}" onclick="$('#id_hid_view_type').val('grid');"><i aria-hidden="true" class="bUi-iCn-tH-lR-aLt-16"></i></button>
                        <button type="button" class="btn btn-link c-lT mRl5 {% if view_type == 'list' %}active{% endif %}" onclick="$('#id_hid_view_type').val('list');"><i aria-hidden="true" class="bUi-iCn-rE-oDr-aLt-16"></i></button>
                    </div>
                </div>  
            </div>
        </div>
		<ul class="modulesBrowseData fOcL {% if view_type == 'grid' %}mDa-gD mDa-oT-tP pDfX{% else %}mDa-lT mDa-oT-lT{% endif %}">
			{% for photo in photos %}
            <li class="mDa">
                <div class="mDa-iN">
                    <div class="mDa-wPr"> 
                    	<a class="bUi-tMb-wPr tMb-75 fLxiMgW bUi-tMb-aRtCl" href="{{photo.get_absolute_url}}">
                            <span class="bUi-tMb">
                                <span class="bUi-tMb-pRpL">
                                    <span class="bUi-tMb-cLp">
                                        <span class="bUi-tMb-cLp-iN"> <img class="mDa-oT" src="{% if not photo.album_photos.all.0.photo_url %}{% thumbnail photo.album_photos.all.0.photo 162x0 %}{% else %}{{ photo.show_cover_image }}{% endif %}" alt="{{ photo.title }}">
                                            <span class="vRtL-aLn"> </span>
                                        </span>
                                    </span>
                                </span>
                            </span>
                            <div class="mDa-hVr cVr tR-hVr"><span class="bR5"><span class="bDg bRdR-wHt fNcY sMl fS11" href="#"><i aria-hidden="true" class="bUi-iCn-pHt-12 ib mRr5"></i>{{ photo.album_photos.count }}</span></span></div>
                        </a>
                    </div>
                    <div class="mDa-bDy">
                    	<span class="fS11 uC cLr-lTbLu">{{ photo.category }}</span>
                        <h5 class="mDa-hD tRnCt0 mR50 rLvE h35" title="{{ photo.title }}"><a href="{{photo.get_absolute_url}}">{{ photo.title }}</a></h5>
                        <div class="mDa-dTa mRt4 cLrfX">
                           <span class="fS11 cLr-lTgRy pLlT mRb0">{{photo.published_on|timesince|time_up_to:','}} {% trans 'ago' %}</span>
                           <span class="fS11 cLr-lTgRy pLrT iM">
                               <a class="mRr10 cLr-lTgRy" href="javascript:void(0);" title="{{photo.most_viewed}} {% trans 'views' %}"><i aria-hidden="true" class="bUi-iCn-vEw-12 fS14 ib"></i>{{photo.most_viewed}}</a>
                               <a class="cLr-lTgRy" href="{{photo.get_absolute_url}}#id_comment"><i aria-hidden="true" class="bUi-iCn-bBlS-12"></i>{% get_mptt_comment_count for photo as comment_count %}{{comment_count}}</a>
                           </span>
                        </div>                                            
                        <!--div class="mDa-hVr"><a data-toggle="tooltip" data-placement="right" title="Share" class="iCn-lNk btn btn-mini" href="#"><i class="BUI-icon-63"></i>Share</a></div-->
                    </div>
                </div>
            </li>
            {% endfor %}
		</ul>
		{% include 'usercp_pagination.html' %}
 	</div>
</div>   
{% else %}
<div class="pD20 pDt0 cLrfX">                                                                                     
	<div class="hT600 rLvE">
 		<div class="tBl-bLk pDt0">
			<div class="tBl-cEl">
				<span class="iCn-bRdR80 oP25"><i aria-hidden="true" class="bUi-iCn-pHoT-24 fS42-1 cLr-lTgRy ib"></i></span>
				<p class="bLk mRt20 fS16 cLr-lTgRy oP75">You haven't uploaded any photos yet.</p>
				{% ifequal request.user profile.user %}
				<p class="mRt15"><a href="{% url 'user_add_gallery' %}" class="btn btn-danger fS12 fW-bLd">Upload photos</a></p>
				{% endifequal %}
			</div>
		</div>
	</div>
</div> 
{% endif %}                     
<script>
$(document).ready(function(){
	var views = $('#media-toggle');
    var figureItems = $('.main').find('.modulesBrowseData');
    var thumbnaiItem = $('.modulesBrowseData').find('.mDa-oT');
    
    
    function setGridColumn(){        
        $('.mDa-gD').each(function(index, element) {
            if(!$(this).hasClass('dSgDwDt')){
                var gridColumnWidth = $(this).find('.mDa').width();
                $(this).find('.mDa .mDa-oT').css({'width':''+gridColumnWidth+'','height':'auto'}); 
            }
        });    
    }
    
    views.on('click', '.c-lT', function() {
        views.find('.btn').removeClass('active');
        $(this).addClass('active');
        figureItems.removeClass('mDa-gD mDa-oT-tP').addClass('mDa-lT mDa-oT-lT');
        if(figureItems.children('li').hasClass('mDa-gRp')){
            figureItems.find('.mDa-gRp > ul').removeClass('pDfX')
        }
        else{
                figureItems.removeClass('pDfX');    
            }
        thumbnaiItem.css('width','auto');
        $('.fLxiMgH').setrSpVHeight('mDa-lT');
        $('.fLxiMgW').setrSpVWidth(0);
        $('.fLxiMgW30').setrSpVWidth(30);
    });
    views.on('click', '.c-gD', function() {
        views.find('.btn').removeClass('active');
        $(this).addClass('active');
        figureItems.removeClass('mDa-lT mDa-oT-lT').addClass('mDa-gD mDa-oT-tP');
        if(figureItems.children('li').hasClass('mDa-gRp')){
            figureItems.find('.mDa-gRp > ul').addClass('pDfX')
        }
        else{
                figureItems.addClass('pDfX');    
            }
        $('.fLxiMgH').setrSpVHeight('mDa-lT');
        $('.fLxiMgW').setrSpVWidth(0);
        $('.fLxiMgW30').setrSpVWidth(30);
        setGridColumn();
    });
    setGridColumn();
    
    
    $(window).bind("resize orientationchange", (function () {
        setGridColumn();            
    }))    
    
    setTimeout(function(){setGridColumn()});
    
    $('.fLxiMgH').setrSpVHeight('mDa-lT');
});
</script>