{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% load thumbnail %}
{% load ds_banners %}
{% block navigation %}
    {% activetab "selmodule" "banners" %}
    {{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Banner Traffic Repots' %} {% endblock %}
{% block head %}

<style type="text/css">
        /* Optional styles */
        
        .chartscontainer {
            padding: 10px 30px;
            width: 100%;
            -moz-box-sizing:border-box; /* Firefox */
            -webkit-box-sizing:border-box; /* Safari */
            margin: 0 auto;
        }
        
        .chartscontainer ul {
            padding-left: 0;
        }
        
        .chartscontainer li {
            list-style: none;
        }
        
        
        .info{
              padding:30px;
        }
        
        .info li {
            color: #666666;
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .info li .label {
            color: #999999;
            display: inline-block;
            font-weight: normal;
            width: 80px;
        }
        
        .banner_mnthly_info{
            border: 1px solid #EEEEEE;
            width: 100%;
        }
        .banner_mnthly_info tr {
            border: 1px solid #EEEEEE;
        }
        .banner_mnthly_info tr:hover {
            background-color:#fafafa;
            cursor:pointer
        }
        .banner_mnthly_info tr.active {
            background-color:#eee;
        }
        .banner_mnthly_info th {
            border-right: 1px solid #EEEEEE;
            color: #999999;
            font-size: 11px;
            padding: 5px 10px;
        }
        .banner_mnthly_info td {
            border-right: 1px solid #EEEEEE;
            color: #333333;
            padding: 5px 10px;
        }
        
    </style>



<!-- TAGS -->
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}ui/css/jquery.tagit.css" />
<!-- TAGS -->
{% endblock %}
{% block content %}
<div id="staff-platform" class="group">
      <div class="header-bar has-sub">
    <h2>{% trans 'Banner Traffic Report - ' %}{{banner.caption}}</h2>
        <section class="sub-header-bar">
            <div class="group">
                  <div class="filter-view-tabs">
                        <a href="{% url 'staff_banners_manage_banners' %}" class="text-link"><span>{% trans '&larr; Back to Banners' %}</span></a>
                  </div>
                  <div class="add-section-right">
                      <a href="{% url 'staff_banners_add_banner' %}" class="btn-txt-prime" title="{% trans 'Add New Banner' %}"><span class="btn-txt">{% trans 'Add New Banner' %}</span></a>
                  </div> 
            </div>
        </section>                          
         </div>
        <div id="core-wraper" class="group">
            <div class="staff-main">
                  <div class="page-wrap">
                    <div id="articles" class="group">
                        <section class="toolbars">
                            <div class="group">
                                <ul class="toolbar left">
                                    <li class="tool tip tip6">
                                        <label class="inline-block">{% trans 'Year:' %}</label>
                                        <select id="orderSelect" onchange="location.replace('{% url 'staff_banners_banner_traffic_reports' %}?bid={{banner.id}}&year='+$(this).val())" style="width:150px;" class="select-menu">
                                              {% for y in years %}
                                                <option value="{{y.year}}" {% if y.year == selected_date.year %} selected="selected" {% endif %}>{{y|date:"Y"}}</option>
                                              {% endfor %}
                                        </select>                                                    
                                    </li>
                                </ul>
                            </div>
                        </section>
                        <span id="ajax_content_loading" class="load-list-items" style="display:none">
                             <img src="{{STATIC_URL}}ui/images/global/loading.gif" align="...">
                        </span>
                        <div style="display:none;" class="info-bar" id="top_info_bar"></div>
                        <div id="ajax_content_cls" class="group" style="padding-bottom: 20px; border-bottom: 1px solid rgb(230, 230, 230);">
                            {% include 'banners/staff/banner-graph-reports.html'%} 
                        </div> 
                        <div class="info group">
                            <ul style="float: left;">
                                <li>
                                    <span class="label">Caption:</span> {{ banner.caption }}
                                </li>
                                <li>
                                    <span class="label">Zone/Type:</span> {{banner.zones}}
                                </li>
                                <li>
                                    <span class="label">Section:</span> {{banner.section.name}}
                                </li>
                                <li>
                                    <span class="label">Expiry Date:</span> {{banner.expiry_date|date:"M d, Y"|default:"Not Specified"}}
                                </li>
                                <li>
                                    <span class="label">Type:</span> {% if banner.is_script %}Script Banner{% else %}Banner Image{% endif %}  
                                </li>

                            </ul>
                            <ul style="float: left; margin-left: 30px;">
                                <li>
                                    {% if not banner.is_script %}<a href="javascript:void(0);" onclick="banner_image_large_preview('{% url 'staff_banners_banner_image_preview' %}?bid={{banner.id}}','{{banner.caption}}');" title="{% trans 'Large Preview' %}" >{% endif %}<img style="max-height: 100px;" src="{% if banner.image %}{{ banner.image.url }}{% else %}{{ banner.get_default_image }}{% endif %}"/>{% if not banner.is_script %}</a>{% endif %}
                                   <a class="icon-view preview-item"  href="#"></a>  
                                </li>
                            </ul>
                        </div> 
                        <div class="table" style="padding: 10px 30px;" id="id_banner_monthly_div">
                            {% include 'banners/staff/banner-monthly-reports.html' %}  
                        </div>   
                    </div> <!-- end table -->
              </div>  <!-- end page wrap -->
        </div>  <!-- end main-col -->                            
        <div id="aside" class="side-bar">
            {% include 'banners/staff/traffic-reports-faq.html' %}  
        </div>                            
    </div>                                                    
</div>
{% endblock %}            
{% block footer_include %}
    <!--script type="text/javascript" src="{{STATIC_URL}}js/ads/charts-custome.js"></script-->
    <script type="text/javascript" src="{{STATIC_URL}}js/ads/charts/highcharts.js" ></script>
    <script type="text/javascript" src="{{STATIC_URL}}js/ads/charts/exporting.js" ></script>
    
    <script type="text/javascript" src="{{ STATIC_URL }}ui/js/listing_settings.js"></script>
    <script type="text/javascript">
        
        $(function () {
            $('#container').highcharts({
                chart: {
                    type: 'column'
                },
                credits: {
                     enabled: false
                },                        
                title: {
                    text: 'Banner Traffic Reports'
                },
                xAxis: {
                    categories: [
                        
                        {% for br in banner_reports %}
                            '{{br.month|date:"M"}}'{% if not forloop.last %},{% endif %}
                        {% endfor %}
                       
                    ]
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'Views and Clicks'
                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:.1f} </b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0
                    }
                },
                series: [{
                    name: 'Impressions',
                    data: [{% for br in banner_reports %}{{br.views}}{% if not forloop.last %}, {% endif %}{% endfor %}]
        
                }, {
                    name: 'Clicks',
                    data: [{% for br in banner_reports %}{{br.month|get_banner_clicks_mnthly:banner.id}}{% if not forloop.last %}, {% endif %}{% endfor %}]
        
                }]
            });
        });
        function banner_image_large_preview(url,title){
            $.colorbox({width: "800",initialWidth: "800", top:"5%", initialHeight: "200", href:url, title:title });                        
        }
    </script>
<ul class="tour_link">
    <li class="tool-tip tttxt-t1"><a class="link1" href="/bmt/tour/gallery/staff/status.html"></a></li>
    <li class="tool-tip tttxt-t2"><a class="link2" href="/bmt/tour/gallery/staff/listing_type.html"></a></li>
    <li class="tool-tip tttxt-t3"><a class="link3" href="/bmt/tour/gallery/staff/submissions.html"></a></li>
    <li class="tool-tip tttxt-t4"><a class="link4" href="/bmt/tour/gallery/staff/search.html"></a></li>
    <li class="tool-tip tttxt-t5"><a class="link5" href="/bmt/tour/gallery/staff/actions.html"></a></li>
    <li class="tool-tip tttxt-t6"><a class="link6" href="/bmt/tour/gallery/staff/sorting.html"></a></li>
    <li class="tool-tip tttxt-t7"><a class="link7" href="/bmt/tour/gallery/staff/state.html"></a></li>
    <li class="tool-tip tttxt-t8"><a class="link8" href="/bmt/tour/gallery/staff/status_aside.html"></a></li>
    <li class="tool-tip tttxt-t9"><a class="link9" href="/bmt/tour/gallery/staff/settings.html"></a></li>
</ul>
{% endblock %}