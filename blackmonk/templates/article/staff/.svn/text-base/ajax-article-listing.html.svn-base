{% load ds_utils %}
{% load i18n %}		
		<input type="hidden" value="{% url 'staff_article_ajax_list_articles' %}" name="id_listarticle_url" id="id_listarticle_url">
		<input type="hidden" value="{{status}}" name="id_status" id="id_status">
        <input type="hidden" value="{{listing_type}}" name="id_listing_type" id="id_listing_type">
        <input type="hidden" value="{{created}}" name="id_created" id="id_created">
        <input type="hidden" value="{{sort}}" name="id_sort" id="id_sort">
        <input type="hidden" value="{% if search %}{{search}}{% endif %}" name="id_search" id="id_search">
        <input type="hidden" value="" name="id_action" id="id_action">
		<input type="hidden" value="{% url 'staff_article_ajax_action' %}" name="id_action_url" id="id_action_url">
        
        <input type="hidden" value="{{msg}}" name="id_action_msg" id="id_action_msg">
		{% if articles %}
		<ol class="data-table table-lists-container" id="ajax_content_list">
			{% for article in articles %}	
			<li class="table-list" id="li_{{article.id}}">
			        <div class="table-list-container check-item group">
			        		<span id="id_featured_cls_{{article.id}}" class="list-type {% if article.featured %}featured-item{% endif %}"><a class="tttxt" title="{% if article.featured %}{% trans 'Item listed as featured' %}{% endif %}" href="#">{% if article.featured %}{% trans 'Featured' %}{% endif %}</a></span>
							<span class="checkbox-wrap">
								<span class="cform-checkbox-container">
									<input type="checkbox" onclick="fix_action()" status="{{article.status}}" value="{{article.id}}" id="id_checkbox_{{article.id}}" name="artCulture" class="check-overflow cbox check_action">
								<span class="cform-checkbox-element"></span></span>
							</span>
			            <div class="item-info relative-block">
			                <h3 class="title"><a href="{% url 'staff_article_preview' article.id %}">{{article.title}}</a></h3>
			                <p class="ltxt80">{{article.category}} <span class="divider12">|</span> {% trans 'By' %} <a href="{% url 'user_profile' article.created_by.profile_slug %}">{{article.created_by.display_name}}</a> <span class="divider12">|</span>Created on: {{article.created_on|date:"M d, Y"}} {% if article.status == 'P' %}<span class="divider12">|</span>Published on: {{article.published_on|date:"M d, Y"}}{% endif %}</p>
			                <ul class="quick-stats group">
			                    <li class="views"><a class="tttxt" href="javascript:void(0)" title="{% trans 'Viewers' %}"><span class="inline-block icon-view-stats"></span>{{article.most_viewed}}</a></li>
			                    
								<!--li class="cmnt"><a class="tttxt"title="{% trans 'View comments' %}" href="#"><span class="inline-block icon-cmnt-stats"></span></a></li-->
			                </ul>
			                <div class="item-status {% if forloop.counter == 1 %}tip tip8{% endif %} {% if not perms.article.publish_article %} no-options{% endif %} dev_hide_list_status" onclick="display_change_status({{article.id}},$('#id_estatus_{{article.id}}').attr('name'));">
			                	<span class="status-inside inline-block" id="id_span_chge_sts_{{article.id}}">
                                <span title="{% get_status_class article.status %}" id="id_estatus_{{article.id}}" name="{{article.status}}" class="inline-block tttxt status-idty icon-{% get_status_class article.status %}"></span>	  
			                    {% if not perms.article.publish_article %}</span>{% endif %}
								{% if perms.article.publish_article %}
									<span class="arrow"></span></span>
									<ul class="dropdown-list" id="change_status_id_{{article.id}}">
										<li><strong>{% trans 'Update status to...' %}</strong></li>
				                       	<ul id="id_dis_status_{{article.id}}">
				                       	</ul>
				                    </ul>
								{% endif %}
			                </div>                                                        
			            </div>
			            <div class="action-buttons {% if forloop.counter == 1 %}tip tip9{% endif %}">
			                <div class="relative-block">
			                    <span class="item-manage inline-block dev_hide_list_settings" id="id_span_settings_{{article.id}}" onclick="display_settings({{article.id}});"><span class="action-icon icon-manage"></span></span>
			                    <ul class="dropdown-list dev_settingsdrpdwn" id="settings_id_{{article.id}}" style="display:none">
                                    {% if article.album.get_gallery_uploaded_images %}
									   <li><a href="javascript: set_cover_photo_lightbox({{article.album.id}})" >{% trans 'Set Cover Image' %}</a></li>
                                    {% endif %}
				                    {% if perms.article.promote_articles %}
										<li id="id_feature_{{article.id}}" {% if article.featured%}style="display:none"{%endif%}><a href="javascript:void(0)" onclick="feature_article_chk({{article.id}},false)">{% trans 'Feature this' %}</a></li>
										<li id="id_unfeature_{{article.id}}" {% if not article.featured%}style="display:none"{%endif%}><a href="javascript:void(0)" onclick="feature_article({{article.id}},'N');">{% trans 'Non-feature this' %}</a></li>
										<li><span class="line-break"></span></li>
									{% endif %}
									{% if perms.article.change_article %}
										<li><a href="{% url 'staff_article_add_article' %}?aid={{article.id}}">{% trans 'Edit' %}</a></li>
										<li><a title="{% trans 'Title / Description (SEO)' %}" href="{% url 'staff_article_seo' article.id %}" class="bm-add-gadget light_box">{% trans 'Update SEO' %}</a></li>
									{% endif %}
										<li><a title="{% trans 'view Stats' %}" href="{% url 'common_get_modules_elements_views' article.id 'article' 0 %}">{% trans 'View Stats' %}</a></li>
										<li><a title="{% trans 'Article Logs' %}" class="bm-add-gadget light_box" href ="{% url 'common_log' %}?obj_id={{ article.id }}&type=article">Audit Logs</a></li>
										<li><span class="line-break"></span></li>			                       	
									{% if perms.article.delete_article %}
								    	<li><a onclick="if(confirm(gettext('Are you sure you want to delete the selected article?'))){filter_action({{article.id}},'DEL');return false;}" href="javascript:void(0)">{% trans 'Delete' %}</a></li>
									{% endif %}
			                    </ul>
							</div>                                                              	                                                         
			            </div>
			        </div>
			    </li> 
			{% endfor %}
			</ol>
			{% include 'common/pagination_ajax.html'%}  
			{% else %}
				<div class="no-data"> <p>{% trans 'Sorry , No articles found !' %}</p></div>
         	{% endif %}
			<!-- script type="text/javascript" src="{{STATIC_URL}}ui/js/application.js"></script -->
			<script>
				function status_function(id,status){
						$('#id_dis_status_'+id).html('');
						if(status=='P'){
							ahtml = '<li><a onclick="save_status('+id+',\'B\');" href="javascript:void(0);">{% trans 'Blocked' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else if(status=='S'){
							ahtml = '<li><a onclick="save_status('+id+',\'B\');" href="javascript:void(0);">{% trans 'Blocked' %}</a></li>'
							ahtml+= '<li><a onclick="save_status('+id+',\'P\');" href="javascript:void(0);" >{% trans 'Publish now' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else if(status=='N'){
							ahtml = '<li><a onclick="save_status('+id+',\'P\');" href="javascript:void(0);" >{% trans 'Publish' %}</a></li>'
							ahtml+= '<li><a onclick="save_status('+id+',\'R\');" href="javascript:void(0);" >{% trans 'Reject' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else if(status=='B'){
							ahtml = '<li><a onclick="save_status('+id+',\'P\');" href="javascript:void(0);" >{% trans 'Publish' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else if(status=='R'){
							ahtml = '<li><a onclick="save_status('+id+',\'P\');" href="javascript:void(0);" >{% trans 'Publish' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else if(status=='D'){
							ahtml = '<li><a onclick="save_status('+id+',\'P\');" href="javascript:void(0);" >{% trans 'Publish' %}</a></li>'
							$('#id_dis_status_'+id).append(ahtml);
						}
						else{
							return false;
						}
					}
					function feature_article_chk(id,val){
							$.ajax({
							type: "GET",
							url: "{% url 'staff_article_feature_count' %}",
							data: 0,
							success: function(data){
								if(data==1){
                                    feature_article(id,'F');
                                    /*
    									if(val){$.colorbox({width: "550",initialWidth: "550", top:"60", title: gettext("Feature Article"), initialHeight: "200", href:'{% url 'staff_article_feature_article_lightbox' %}?aid='+id+''});}
    									else{
                                        }
                                    */
								}else{
									alert(gettext('Sorry!! You can feature only 8 articles'));
								}
							}
						});	
					}
					function feature_article(id,v){
						var DataString="id="+id+"&status="+v;
						$.ajax({
							type: "GET",
							url: "{% url 'staff_article_feature_article' %}",
							data: DataString,
							success: function(data){
								if(data){
									$('.dev_hide_list_settings ul.dropdown-list').hide();
									$('span.item-manage').removeClass('active')
									if(v=='F'){
										$('#id_feature_'+id).hide();
										$('#id_unfeature_'+id).show();
										$('#id_featured_cls_'+id).addClass('featured-item');
										show_msg(gettext('Selected article successfully featured.'),'alert-success');
									}else{
										$('#id_unfeature_'+id).hide();
										$('#id_feature_'+id).show();
										$('#id_featured_cls_'+id).removeClass('featured-item');
										show_msg(gettext('Selected article successfully non-featured.'),'alert-success');
									}	
								}else{
									show_msg(gettext('Oops!!! Not able to process your request.'),'alert-error');
								}
							}
						});
						
					}
					function save_status(id,status){
						$('#id_estatus_'+id).addClass('loading');
						var DataString="id="+id+"&status="+status;
						$.ajax({
							type: "GET",
							url: "{% url 'staff_article_change_status' %}",
							data: DataString,
							success: function(data){
								if(data!=0){
									$('#id_estatus_'+id).removeClass('loading');
									$('#id_estatus_'+id).replaceWith(data);
									$('#change_status_id_'+id).hide();
									$('#id_span_chge_sts_'+id).removeClass('active')
									$('#id_checkbox_'+id).attr('status',status);
									show_count('all');
								}else{
									show_msg(gettext('Oops!!! Not able to process your request.'),'e');
								}
							}
						});
				}
				
			</script>

				 