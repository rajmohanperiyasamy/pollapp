{% extends base %}
{% load tabs %}
{% load truncate_filter bm_attraction_tags %}
{% load mptt_comments_tags %}
{% load thumbnail %}
{% load i18n %}
{% load ds_utils %}
{% block pagetitle %}{% if category %}{% seo_format_tag module='Attraction' title=category.seo_title code='LT' category=category.name as seo_meta_title %}{% else %}{% seo_format_tag module='Attraction' title=seo.seo_title code='MT' as seo_meta_title %}{% endif %}{{seo_meta_title}} {% if page > 1 %}| page {{ page }} {% endif %}{% endblock %}
{% block meta %}
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="description" content="{{ seo.seo_description }}" />
{% endblock %}
{% block head %}
	<script src="{{STATIC_URL}}themes/js/jquery.bUislider.js"></script>
	<script src="{{STATIC_URL}}themes/js/bootstrap-collapse.js"></script>
	<script src="{{STATIC_URL}}themes/js/jquery.raty.js"></script>
	<script type="text/javascript" src="{{STATIC_URL}}js/report_data.js"></script>
	<script type="text/javascript" src="{{STATIC_URL}}js/get_report_data.js"></script>
	<script type="text/javascript">
    $(document).ready(function(){
	 $('.bids').each(function(){
			bids.push($(this).val());
		});
		$('.bicts').each(function(){
			var cat=$(this).val();
			cat=cat.toString();
			var a='&';
			var b='and';
			category_name=cat.replace(a,b)
	        category.push(category_name);
	        });
        module_listing(bids,category);
	});
	
	</script>
	<script>	
		$(function(){
           
           $('.bM-dEvRtng').each(function(){
			  var rating = $(this).attr('data-rating');							
			  $(this).raty({ score: rating });							
		   });
					
           var sL1 = $('#restaurant-hero-media');
		   sL1 = sL1.bUiSlider({
				   mode: 'fade',
				   pager:false,
				   speed:600,
				   onSlideNext:function(){
						   $('#restaurant-hero-text').parent().parent().find('.bUi-next').trigger('click');
				   },
				   onSlidePrev:function(){	
						   $('#restaurant-hero-text').parent().parent().find('.bUi-prev').trigger('click');
				   },
				   	onSliderLoad:function(){
	                    $('.fLxiMgW').setrSpVWidth(0);
	                }
	                
		   });
		   var sL2 = $('#restaurant-hero-text');
		   sL2 = sL2.bUiSlider({
				   pager:false,
				   speed:600,
				   onSlideNext:function(){
						   $('#restaurant-hero-media').parent().parent().find('.bUi-next').trigger('click');
				   },
				   onSlidePrev:function(){
						   $('#restaurant-hero-media').parent().parent().find('.bUi-prev').trigger('click');
				   },
				   onSliderLoad:function(){
	                    $('.fTrD-bL').setfTrDtXtHeight();
	                }
		   });
				
		});
	</script>
{% endblock %}
{% block navigation %}
	{% activetab "topnav" "attractions" %}
	{{ block.super }}
{% endblock %}
{% block content %}
{% get_attraction_categories as attract_category %}
	<div class="container-fluid">
	<div class="pD2015 bM-bX sRcHbR">
                    <div class="row-fluid">
                        <div class="span9 fRm">
                            <form class="form-search mRb0" action="{% url 'attraction-search'%}">
                                <div class="mDl">
                                    <h3 class="mDl-nM">
                                        <i class="bUi-iCn-aTtR-24 fS16" aria-hidden="true"></i>
                                        <span class="ib">Attraction
                                            <i class="bUi-iCn-aNg-rT-12 cLr-lTgRy hMp" aria-hidden="true"></i>
                                        </span>
                                    </h3>
                                </div>
                                <div class="span5">
                                    <input type="text" placeholder="Search for Attraction" value="" name="keyword" id="keyword" class="">
                                </div>
                                <div class="span3">
                                    <select class="bUiSlCt-wHt w100DrD" id='category' name='category'>
                                        <option>All Categories</option>
										{% with attract_category as categories %}
										{% for cat in categories %}
											<option>{{cat.name}}</option>
										{% endfor %}
										{% endwith %}
                                    </select>
                                </div>
                                <div class="ib sUb-bTn mRl12 mRl0mP">
                                    <button class="btn btn-primary" type="submit">
                                    <i class="bUi-iCn-sRh-16" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
        <div class="row-fluid">
        	<div class="span8 main">
				{% if not keyword %}
        		{% get_featured_attractions limit=10 as featured_attractions_list %}
        		{% with featured_attractions_list as featured_attractions %}
        		{% if featured_attractions %}
            	<section class="sCn pD0">
                    <div class="fTrD-bL mRb0 fTrD-mDm mDa-40 aDpTv cTrL-dFt">
                        <div class="fTrD-gR">
                            <div class="fTrD-bL-iN">
                                <ul id="restaurant-hero-media" class="fTrD-iTmS" style="width:10000px;">
                                	{% for attraction in featured_attractions %}
	                                    <li class="fTrD-iTm bS-bRdR" style="float:left;" itemscope itemtype="http://schema.org/TouristAttraction">
											<input type="hidden" id="fbids" name="fbids" class="bids" value="{{attraction.id}}">
	                                        <a href="{{attraction.get_absolute_url}}" class="fTrD-tXt sDw bLk" itemprop="url">
	                                            <div class="vAlGn">
	                                                <div class="fTrD-tXt-iN">
	                                                    <h3 class="fTrD-hD w100P mRb10" itemprop="name" title="{{attraction.name}}">
	                                                    	<span  class="ib">{{attraction.name}}</span>  
	                                                        <div class="mRb0 sTr-rT ib pLrT hMp" itemscope itemtype="http://schema.org/AggregateRating">
	                                                        	{% if attraction.rating != 0 %}
	                                                            <span class="rT-oVrL-sCr ib fS16" itemprop="ratingValue">{{attraction.rating}}</span>
	                                                            <div id="star" data-rating="{{attraction.rating}}" class="sTr-wPr sTr-rT-rD iCn16 rEd cLr-dRk bM-dEvRtng"></div>
																<meta itemprop="worstRating" content="1"/>
                           									    <meta itemprop="bestRating" content="5"/>
	                                                            {% endif %} 	
	                                                            <span class="cLr-lTgRy fS11 sPrTr ib mRt4 hMp" itemprop="reviewCount">{% get_mptt_comment_count for attraction as comment_count %}{{comment_count}} {% trans 'reviews' %}</span>
	                                                        </div>
	                                                    </h3>
	                                                </div>
	                                            </div>
	                                        </a>
	                                        <!-- /.TrD-tXt -->
	                                    </li>
                                    {% endfor %}
                                </ul>
                                <!-- /.fTrD-iTms -->
                                <ul id="restaurant-hero-text" class="fTrD-iTmS">
                                	{% for attraction in featured_attractions %}
	                                    <li class="fTrD-iTm bS-bRdR"  itemscope itemtype="http://schema.org/TouristAttraction">
											<input type="hidden" id="fbids" name="fbids" class="bids" value="{{attraction.id}}">
	                                        <figure class="fTrD-mDa">
	                                        	<div class="fTrD-mDa-hVr">
	                                                <a class="lBl tL dFt mNi uC" title="{% trans 'Go to' %} {{attraction.category.all.0.name}}" href="{{attraction.category.all.0.get_absolute_url}}">{{attraction.category.all.0.name}}</a>
	                                            </div>
	                                            <a class="bUi-tMb-wPr fLxiMgW" title="{{attraction.name}}" href="{{attraction.get_absolute_url}}" itemprop="url">
	                                                <span class="bUi-tMb">
	                                                    <span class="bUi-tMb-pRpL">
	                                                        <span class="bUi-tMb-cLp">
	                                                            <span class="bUi-tMb-cLp-iN">
																	{% if attraction.album.album_photos.all.0.photo %}
																		{% with attraction.album.album_photos.all.0.photo as attraction_img %}
		                                                                <img class="mDa-oT" src="{{STATIC_URL}}/images/grey.gif" data-src="{% thumbnail attraction_img 805x0 %}" title="{{attraction.name}}" alt="{{attraction.name}}" itemprop="image">
																		<span class="vRtL-aLn"></span>
																		{% endwith %}
																	{% else %}
																		<span class="iCn-bRdR50 oP25" title="{{attraction.name}}"><i aria-hidden="true" class="bUi-iCn-aTtR-24 cLr-gRy ib"></i></span><div class="vRtL-aLn"></div>
																	{% endif %}
	                                                            </span>
	                                                        </span>
	                                                    </span>
	                                                </span>
	                                            </a>
	                                        </figure>
	                                        <!-- /.TrD-mDa -->
	                                    </li>
                                    {% endfor %}
                                </ul>
                                <!-- /.fTrD-iTms --> 
                            </div>
                            <!-- /.fTrD-bL-iN --> 
                        </div>
                        <!-- /.fTrD-gR --> 
                    </div>
                    <!-- /.fTrD-bL -->
                </section>
                {% endif %}
                {% endwith %}
				{% endif %}
                <div class="row-fluid">
					<div class="tLbR mRt20">
                        <div class="tLbR-iR">
							<div class="sCn-tTl pLlT mRb0">
                                <h2>{% if keyword %}Search result for {{keyword}}{% else %}{{category.name|default:"All Attractions"}}{% endif %}</h2>
                            </div>                         	
                            <div class="btn-toolbar pLrT hP">
                                <div id="media-toggle" class="btn-group pLrT" data-toggle="buttons-radio">	 
                                	<a class="btn btn-link c-lT mRr5" type="button" title='{% trans "Map View" %}' href="{% url 'locality_map_attractions' %}"><i aria-hidden="true" class="bUi-iCn-mP-vEw-aLt-16"></i></a>                                       
                                    <button type="button" title='Grid View' class="btn btn-link c-gD {% if view_type == 'grid' %}active{% endif %}" onclick="change_url_parm('grid');" ><i aria-hidden="true" class="bUi-iCn-tH-lR-aLt-16"></i></button>
                                    <button type="button" title='List View' class="btn btn-link c-lT mRl5 {% if view_type == 'list' %}active{% endif %}" onclick="change_url_parm('list');"><i aria-hidden="true" class="bUi-iCn-rE-oDr-aLt-16"></i></button>
                                </div>
                                <div class="pLrT mRr10">
									{% with attract_category as categories %}
                                    <select data-link="true" class="bUiSlCtbtn-link tXt-sMl">
                                    	{% get_total_attractions_count as total_count %}
                                        <option {% if not category %}selected="selected"{% endif %} data-subtext=" {{total_count}}" data-location="{% url 'attraction_home' %}">{% trans 'All Attractions ' %}</option>
                                        {% for cat in categories %}
                                        <option {% if cat.id == category.id %}selected="selected"{% endif %} data-subtext=" {{cat.get_attractions_count}}" data-location="{{cat.get_absolute_url}}">{{cat}} </option>	
                                        {% endfor %}
                                    </select>
                                    {% endwith %}
                                </div>
                            </div>  
                        </div>
                    </div>
					<ul class="modulesBrowseData tHcL {% if view_type == 'grid' %}mDa-gD mDa-oT-tP pDfX{% else %}mDa-lT mDa-oT-lT{% endif %}">
						{% if attractions %}
						{% with attractions as view_attractions  %}
						{% for attraction in view_attractions %}
                        <li class="mDa" itemscope itemtype="http://schema.org/TouristAttraction">
                            <div class="mDa-iN">
                                <div class="mDa-wPr"> 
                                	<a class="bUi-tMb-wPr tMb-75 fLxiMgW bUi-tMb-aRtCl" title="{{attraction.name}}" href="{{attraction.get_absolute_url}}" itemprop="url">
                                        <span class="bUi-tMb">
                                            <span class="bUi-tMb-pRpL">
                                                <span class="bUi-tMb-cLp">
													{% if attraction.album.album_photos.all.0.photo %}
														{% with attraction.album.album_photos.all.0.photo as attraction_img %}
	                                                    <span class="bUi-tMb-cLp-iN"> <img class="mDa-oT" src="{{STATIC_URL}}/images/grey.gif" data-src="{% thumbnail attraction_img 260x0 %}" title="{{attraction.name}}" alt="{{attraction.name}}" itemprop="image">
	                                                        <span class="vRtL-aLn"> </span>
	                                                    </span>
														{% endwith %}
													{% else %}
														<span class="iCn-bRdR50 oP25" title="{{attraction.name}}"><i aria-hidden="true" class="bUi-iCn-aTtR-24 cLr-gRy ib"></i></span><div class="vRtL-aLn"></div>
													{% endif %}
                                                </span>
                                            </span>
                                        </span>
                                    </a>
                                </div>
                                <div class="mDa-bDy">
                                	<span class="cLr-lTbLu fS12 mRb0 tRnCt">{% for cat in attraction.category.all %}{{cat.name}}{% if not forloop.last %}, {% endif %}{% endfor %}</span>
                                    <h4 class="mDa-hD tRnCt0 fW200 mR50 rLvE h44" title="{{attraction.name}}" itemprop="name"><a href="{{attraction.get_absolute_url}}" itemprop="url">{{attraction.name}}</a></h4>
                                    <p class="fS12 cLr-gRy pDt5 hD-gD">Discovery Cove is a beautiful, tropical oasis. The park is well run, and the entire staff is very friendly. Buy the picture CD that the park sells if members of your group are...</p>
                                    {% with attraction.venue as venue %}
                                    <div class="mDa-dTa mRt4 cLrFx" itemscope itemtype="http://schema.org/Place">
                                       <a href="javascript:void(0);" onclick="set_center({{ venue.lat }}, {{ venue.lon }}, {{ venue.zoom }});$('html, boy').animate({scrollTop: $('#map-canvas').offset().top}, 400);" class="fS12 cLr-lTgRy pLlT tRnCt"><i aria-hidden="true" class="bUi-iCn-mP-mKr-12"></i> <span itemprop="address">{{venue.venue}}</span></a>
										<span itemprop="geo" itemscope itemtype="http://schema.org/GeoCoordinates">
										<meta itemprop="latitude" content="{{ venue.lat }}"/><meta itemprop="longitude" content="{{ venue.lon }}"/>
										</span>
                                    </div>  
                                    {% endwith %}                                          
                                    <!--div class="mDa-hVr"><a data-toggle="tooltip" data-placement="right" title="Share" class="iCn-lNk btn btn-mini" href="#"><i aria-hidden="true" class="bUi-iCn-sHr-aLt-16 ib"></i></a></div-->
                                </div>
                            </div>
                        </li>
                        {% endfor %}
						{% endwith %}
						{% else %}
							<div class="hT600 rLvE sCn">
				                <div class="tBl-bLk pDt0">
				                    <div class="tBl-cEl">
				                        <span class="iCn-bRdR80 oP25"><i class="bUi-iCn-aRtL-24 fS42-1 cLr-gRy ib" aria-hidden="true"></i></span>
				                        <p class="bLk mRt20 fS16 cLr-lTgRy oP75">No Attractions found {% if category %}under category '{{category.name}}'{% endif %}.</p>
				                    </div>
				                </div>
				            </div>
						{% endif %}
					</ul>
					{% include 'default/common/pagination-white.html' %}
				</div>
            </div><!--main-->
            <aside class="sD-bR span4 mSnRy">
            	<div>
					<section class="tXt-cTr pD15 bNr-aD" id="banner_placement_right"></section> 
				</div>
                <div>
                    <section class="sCn pD15">
                        <div id="map-canvas" style="height:450px"></div>
                    </section>
                </div>
                <div>
					{% include 'default/likebox.html' %}
				</div>
            </aside>
        </div>
    </div>
    
<script src="http://maps.googleapis.com/maps/api/js?v=3&sensor=false{% if globalsettings.google_map_key %}&key={{ globalsettings.google_map_key }}{% endif %}" type="text/javascript"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/general/google_map.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}themes/js/gmap-markerwithlabel.js"></script>
<script type="text/javascript">
var markers=[];
$(document).ready(function(){
    {% for attraction in attractions %}
            {% with attraction.venue as venue %}
                var marker = new Object();
                marker["lat"] = {{venue.lat}};
                marker["lng"] = {{venue.lon}};
                marker["zoom"] = {{venue.zoom}};
                marker["name"] = "{{ attraction.name }}";
                marker["title"] = "2";
                marker["label"] = "{{forloop.counter}}",
                marker["address"] = "{{ venue.name|escape|linebreaks }}{{ venue.address1 }} - {{venue.zip }}";
                marker["icon"]="{{STATIC_URL}}themes/img/icons/marker-regular.png";
                markers.push(marker);
            {% endwith %}
    {% endfor %}
    {% if featured_attractions %}
        {% for attraction in featured_attractions %}
                {% with attraction.venue as venue %}
	                var marker = new Object();
	                marker["lat"] = {{venue.lat}};
	                marker["lng"] = {{venue.lon}};
	                marker["zoom"] = {{venue.zoom}};
	                marker["name"] = "{{ attraction.name }}";
	                marker["title"] = "2";
	                marker["address"] = "{{ venue.name|escape|linebreaks }}{{ venue.address1 }} - {{venue.zip }}";
	                marker["icon"]="{{STATIC_URL}}themes/img/icons/marker-regular.png";
	                markers.push(marker);
            {% endwith %}
        {% endfor %}
    {% endif %}
    load_multi_marker_with_numeric_overlay('map-canvas',{{ globalsettings.google_map_lat }}, {{ globalsettings.google_map_lon }}, {{ globalsettings.google_map_zoom }},markers)            
});
</script>   
{% endblock %}
