{% extends base %}
{% load modulotag %}
{% load truncate_filter %}
{% load comparison %}
{% load tabs %}
{% load thumbnail %}
{% load i18n %}
{% load ds_utils %}
{% load mptt_comments_tags %}
{% load bm_restaurant_tags %}
{% block pagetitle %}{% seo_format_tag module='Restaurants' title=seo.seo_title code='MT' as seo_meta_title %}{{seo_meta_title}}{% endblock %}
{% block meta %}
    <meta name="description" content="{{ seo.seo_description }}" />
{% endblock %}
{% block head %}
    <script src="{{STATIC_URL}}themes/js/jquery.bUislider.js"></script>
    <script src="{{STATIC_URL}}themes/js/bootstrap-collapse.js"></script>
    <script src="{{STATIC_URL}}themes/js/bootstrap-typeahead.js"></script>
    
    
    <script type="text/javascript" src="{{STATIC_URL}}js/report_data.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}js/restaurants/restaurant.js"></script>
   
    <script type="text/javascript">
    var rest_update_value_url = '{% url 'restaurants_get_selected_values' %}';
    var rest_filter_url = '{% url 'restaurants_filter_restaurants' %}';
    var pathname = window.location.pathname;
    org_path=pathname;
    $(document).ready(function(){
        var bids=new Array();
        var cat='';
        var category=new Array();
        var category_name='';
        
         $('.bids').each(function(){
                bids.push($(this).val());
        
            });
            $('.bicts').each(function(){
                var cat=$(this).val();
                cat=cat.toString();
                var a='&';
                var b='and';
                category_name=cat.replace(a,b)
                category.push(category_name);
                });
        reports_data(pathname,bids,category,org_path)
    });
    </script>
{% endblock %}
{% block navigation %}
    {% activetab "topnav" "restaurants" %}
    {{ block.super }}
{% endblock %}
{% block content %}
    <div class="container-fluid"> 
        {% include 'default/restaurants/top-search.html' %}
        <ul class="bRdCrB" itemscope itemtype="http://schema.org/WebPage">
            <li itemscope itemtype="http://www.data-vocabulary.org/Breadcrumb">
                <a itemprop="url" href="{% url 'restaurants_restaurants_home' %}"><span itemprop="title">Restaurants</span></a>
                <span class="sPrTr"></span>
            </li>
            <li itemscope itemtype="http://www.data-vocabulary.org/Breadcrumb" class="aCtV">
				<span itemprop="title">
                {% if selected_cuisine %}{{selected_cuisine.name}}{% elif sel_prices %}{{sel_prices|get_price_range_fmt}}{% elif sel_category %}{{sel_category.name}}{% else %}{{sel_feature.name|default:"All"}}{% endif %}
            	</span>
			</li>
        </ul>
        <div class="pG-hD">
            <h3>
                <span class="pLlT"><a href="javascript:void(0)" class="cLr-dRk" data-toggle="collapse" data-target="#parent-category" data-toggle-icon="bUi-iCn-cRt-t-12">{{selected_cuisine.name|default:"Cuisines"}} <i aria-hidden="true" class="bUi-iCn-cRt-b-12 cLr-lTgRy"></i></a></span>
                {% if restaurants %}<span class="pGn-rSlT pLrT" id="id_pgntn_ranges">{% trans 'Showing' %} {{from_range}}-{{to_range}} {% trans 'of' %} {{count}}</span>{% endif %}
            </h3>
        </div>
        <div id="parent-category" class="collapse">
            {% get_restaurants_cuisines as cuisines %}
            <ul class="pD015 nav nav-list cMpCt mRb30 fOcL pDfX fW-bLd fS12 sP12mX767 fOmX767">
                {% for cusine in cuisines %}
                    <li {% if cusine.id == selected_cuisine.id %}class="active"{% endif %}><a href="{% url 'restaurants_restaurants_listing' cusine.slug %}">{{cusine.name}}</a></li>
                {% endfor %}
            </ul>
        </div>
        <div class="row-fluid">
            <div class="main span8">
                <div class="row-fluid">
                    <div class="span3 sP12mX767">
                        <section class="sCn pD200">
                            <input type="hidden" id="id_selected_cuisine" value="{% if selected_cuisine %}{{selected_cuisine.id}}{% else %}0{% endif %}">
                            <div class="pD015 mRb20" style="{% if sel_prices or sel_category or sel_feature %}display:block;{% else %}display:none;{% endif %}" id="id_append_values_div">
                                <a href="javascript:void(0);" onclick="remove_selected_values($(this),'{% if sel_prices %}price{% elif sel_category %}catgrs{% else %}ftrs{% endif %}','{% if sel_prices %}{{sel_prices}}{% elif sel_category%}{{sel_category.id}}{% else %}{{sel_feature.id}}{% endif %}');" class="lBl bS-bRdR dFt fS11 mRb5 mRr5 bM-dEv-aNchR">
                                    {% if sel_prices %}{{sel_prices|get_price_range_fmt}}{% elif sel_category %}{{sel_category.name}}{% else %}{{sel_feature.name}}{% endif %}<span class="fS14 mRl5">&times;</span>
                                </a>
                                <a href="javascript:void(0);" onclick="clear_all_selected_values();" class="bLk fS11 cLr-lTgRy">Clear all</a>
                            </div>
                            <ul class="nav nav-list fS12">
                                <li class="nav-header">{% trans 'Price' %}</li>
                                <ul class="nav nav-list cMpCt fOmX767 pDfX pD0  w100mN768 mRb10" id="id_rest_prices">
                                    <li><label for="price_25" title="$"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="price_25" {% if sel_prices == 25 %}checked="true"{% endif %} value="25" onclick="filter_contents();"> $<!--span class="lSt-cNt">(340)</span--></label></li>
                                    <li><label for="price_50" title="$$"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="price_50" {% if sel_prices == 50 %}checked="true"{% endif %} value="50" onclick="filter_contents();"> $$<!--span class="lSt-cNt">(288)</span--></label></li>
                                    <li><label for="price_75" title="$$$"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="price_75" {% if sel_prices == 75 %}checked="true"{% endif %} value="75" onclick="filter_contents();"> $$$<!--span class="lSt-cNt ">(241)</span--></label></li>
                                    <li><label for="price_100" title="$$$$"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="price_100" {% if sel_prices == 100 %}checked="true"{% endif %} value="100" onclick="filter_contents();"> $$$$<!--span class="lSt-cNt">(180)</span--></label></li>
                                </ul>
                                {% get_restaurants_categories as categories %}
                                {% if categories %}
                                <li class="divider oTsT-hRz"></li>
                                <li class="nav-header">{% trans 'Good For' %}</li>
                                <ul class="nav nav-list cMpCt fOmX767 pDfX pD0  w100mN768" id="id_rest_categories">
                                    {% for cat in categories %}
                                    <li><label for="catgrs_{{cat.id}}" title="{{cat.name}}"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="catgrs_{{cat.id}}" {% if sel_category.id == cat.id %}checked="true"{% endif %} value="{{cat.id}}" onclick="filter_contents();"> {{cat.name}}<!--span class="lSt-cNt">()</span--></label></li>
                                    {% endfor %}
                                </ul>
                                <li><a href="#" class="tXt-lNk cLr-lTgRy">Show More <i aria-hidden="true" class="bUi-iCn-aNg-b-aLt-12 ib"></i></a></li>
                                {% endif %}
                                {% get_restaurants_features as features %}
                                {% if features %}
                                <li class="divider oTsT-hRz"></li>
                                <li class="nav-header">{% trans 'Features' %}</li>
                                <ul class="nav nav-list cMpCt fOmX767 pDfX pD0  w100mN768" id="id_rest_features">
                                    {% for feature in features %}
                                    <li><label for="ftrs_{{feature.id}}" title="{{feature.name}}"><input class="mRt-4 bM-dEv-cBx" type="checkbox" id="ftrs_{{feature.id}}" {% if sel_feature.id == feature.id %}checked="true"{% endif %} value="{{feature.id}}" onclick="filter_contents();"> {{feature.name}}<!--span class="lSt-cNt">()</span--></label></li>
                                    {% endfor %}
                                </ul>
                                <li><a href="#" class="tXt-lNk cLr-lTgRy">Show More <i aria-hidden="true" class="bUi-iCn-aNg-b-aLt-12 ib"></i></a></li>
                                {% endif %}
                            </ul>
                        </section>
                    </div>
                    <div class="span9 sP12mX767">
                        {% get_featured_restaurants limit=20 cuisine=selected_cuisine as featured_restaurants %}
                        {% with featured_restaurants as featured_restaurants %}
                        {% if featured_restaurants %}
                        <section class="sCn pD0">
                            <div class="fTrD-bL mRb0 fTrD-mDm mDa-45 aDpTv cTrL-dFt">
                                <div class="fTrD-gR">
                                    <div class="fTrD-bL-iN">
                                        <ul id="restaurant-hero-media" class="fTrD-iTmS">
                                            {% for restaurant in featured_restaurants %}
                                            <li class="fTrD-iTm">
                                                <div class="fTrD-tXt sTrP">
                                                    <div class="vAlGn">
                                                        <div class="fTrD-tXt-iN bDrRbLbR">
                                                            <h4 class="fTrD-hD w100P"><a href="{{restaurant.get_absolute_url}}" class="ib" title="{{restaurant.name}}">{{restaurant.name}}</a> <div class="mRb0 sTr-rT ib pLrT"><span class="rT-oVrL-sCr ib fS16">{{restaurant.ratings}}</span> <span class="sTr-wPr sTr-rT-rD iCn16 rEd mRt-10 cLr-dRk" id="id_fb_rating_{{restaurant.id}}"></span><a href="#" class="cLr-lTgRy fS11 sPrTr ib mRt4 hMp">{% get_mptt_comment_count for restaurant as comment_count %}{{comment_count}} reviews</a></div></h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- /.TrD-tXt -->
                                            </li>
                                            {% endfor %}
                                        </ul>
                                        <!-- /.fTrD-iTms -->
                                        <ul id="restaurant-hero-text" class="fTrD-iTmS">
                                            {% for restaurant in featured_restaurants %}
                                            <li class="fTrD-iTm bS-bRdR">
                                                <figure class="fTrD-mDa">
                                                    <span class="bUi-tMb-wPr fLxiMgW" href="{{restaurant.get_absolute_url}}">
                                                        <span class="bUi-tMb">
                                                            <span class="bUi-tMb-pRpL">
                                                                <span class="bUi-tMb-cLp">
                                                                    <span class="bUi-tMb-cLp-iN">
                                                                        <img class="mDa-oT" src="{% if restaurant.logo.logo %}{% thumbnail restaurant.logo.logo 600x0 %}{% endif %}" alt="{{restaurant.name}}">
                                                                        <span class="vRtL-aLn">
                                                                        </span>
                                                                    </span>
                                                                </span>
                                                            </span>
                                                        </span>
                                                    </span>
                                                </figure>
                                            </li>
                                            {% endfor %}
                                        </ul>
                                        <!-- /.fTrD-iTms --> 
                                    </div>
                                    <!-- /.fTrD-bL-iN --> 
                                </div>
                                <!-- /.fTrD-gR --> 
                            </div>
                            <!-- /.fTrD-bL -->
                        </section>
                        {% endif %}
                        {% endwith %}
                        <div class="tLbR hP mRb10">
                            <div class="tLbR-iR">
                                <div class="pLlT">
                                    <select class="bUiSlCtbtn-link tXt-sMl" onchange="$('#id_sort').val($(this).val()),$('#id_hid_pgntn').val('1'),filter_contents();">
                                        <option value="-id">{% trans 'Best Match' %}</option>
                                        <option value="-ratings">{% trans 'Highest Rated' %}</option>
                                        <option value="-ratings">{% trans 'Most Reviewed' %}</option>
                                    </select>
                                </div>
                                <div class="btn-toolbar pLrT">
                                    <div id="media-toggle" class="btn-group" data-toggle="buttons-radio">
                                        <button type="button" class="btn btn-link active c-lT" onclick="$('#id_hid_view_type').val('list');"><i aria-hidden="true" class="bUi-iCn-rE-oDr-16"></i></button>
                                        <button type="button" class="btn btn-link c-gD" onclick="$('#id_hid_view_type').val('grid');"><i aria-hidden="true" class="bUi-iCn-tH-16"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="id_append_contents_div">
                            {% include 'default/restaurants/part-restaurants-list.html' %}
                        </div>
                    </div>
                </div>
            </div>
            <aside class="sD-bR span4 vR">
                <div>
                    <section class="sCn pD15">
                        <div id="map-canvas" style="height:450px"></div>
                    </section>
                </div>
                <div>
                    {% include 'default/likebox.html' %}
                </div>
            </aside>
        </div>
    </div>
    
{% endblock %}
