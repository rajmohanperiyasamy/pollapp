{% extends 'default/locality/map/base.html' %}
{% load modulotag %}
{% load truncate_filter %}
{% load mptt_comments_tags %}
{% load comparison %}
{% load i18n %}
{% load tabs %}
{% load thumbnail %}
{% load ds_utils %}
{% block pagetitle %}{{seo.seo_title}} | {{ globalsettings.domain }} {% endblock %}
{% block meta %}
    <meta name="description" content="{{ seo.seo_description }}" />
{% endblock %}
{% block head %}
    
{% endblock %}
{% block navigation %}
    {% activetab "modulenav" "cinemas" %}
    {{ block.super }}
{% endblock %}
{% block content %}
    <div id="site">
        <div class="row-fluid">
            <div id="site" >
                <div class="expolre">
                    <div class="gGl-mP-cNvS">
                        <div id="map-canvas"></div>
                    </div>
                    <div class="result-container" id="id_result_div"> 
                        <div class="sCn">
                            <div class="" style="padding: 15px; margin-bottom: 11px; background-color: rgb(245, 245, 245); border-bottom: 1px solid rgb(221, 221, 221);">
                                <form class="form-search rLvE mRb0" method="GET" action="{% url 'locality_map_cinemas' %}">
                                    <input type="hidden" name="search" value="true">
                                    <input type="text" id="id_q" name="q" value="{% if q %}{{ q }}{% endif %}" placeholder="Nearby cinemas" class="search-query iSp9 fS14 h35" style="width: 100% ! important; border-color: rgb(221, 221, 221);">
                                    <button type="submit" class="btn btn-primary fS12 fW-bLd lH1 aBsLt rGt0 t0 " style="border-radius: 0px 2px 2px 0px; padding: 8px 12px; background-color: transparent; color: rgb(187, 187, 187);"> <i aria-hidden="true" class="bUi-iCn-sRh-16 "></i></button>
                                </form>
                            </div>
                            <input type="hidden" id="load_more_url" value="{% url 'locality_map_map_ajax_filter_cinemas' %}">
                            <input type="hidden" id="id_search_status" value="{{search}}">
                            <input type="hidden" id="page_number" value="{{next}}">
                            <input type="hidden" id="id_fl_counter" value="{{fl_counter}}">
                            <ul class="modulesBrowseData mDa-lT mDa-oT-lT iNsT-10 mRl15" id="id_content_ul">
                                {% include 'default/locality/map/ajax-theatres-list.html' %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- #site-wrapper --> 
<script type="text/javascript" src="{{STATIC_URL}}js/locality/global-map-location.js"></script> 
<script type="text/javascript">
var markers=[];
var icon_lrg = "{{STATIC_URL}}themes/img/icons/map-pointer.png";
var icon_sml = "{{STATIC_URL}}themes/img/icons/a-small.png";

$(document).ready(function(){
                             
    {% for theater in theaters %}
        {% with theater.address as addr %}
            var marker = new Object();
            marker["lat"] = {{addr.lat}};
            marker["lng"] = {{addr.lon}};
            marker["zoom"] = {{addr.zoom}};
            marker["icon"] = icon_lrg;
             
            var contentString = '<ul id="map-view'+{{theater.id}}+'" class="cLrFx map-info modulesBrowseData mDa-lT mDa-oT-lT">';
            contentString+='<li class="mDa mR0"><div class="mDa-bDy pD0"><div class="pLlT iM">';
            contentString+='<span class="pD15 bLk pDr10mP pDl0mP"><i aria-hidden="true" class="bUi-iCn-mP-mKr-16 cLr-rEd fS24"></i></span></div>';
            contentString+='<div class="cLr-lT"><h5 class="mDa-hD tRnC mRt10 mRb5 w85P rLvE" title="{{ theater.name }}">';
            contentString+='<a href="{{theater.get_absolute_url}}" class="fW-bLd">{{ theater.name }}</a></h5>';
            contentString+='<div class="mDa-dTa fS12 cLr-gRy"><span>{{theater.address.address1}}{% if theater.address.address2 %}, {{theater.address.address2}}{% endif %}{% if theater.address.city %}, {{theater.address.city}}{% endif %}{% if theater.address.zip %} {{theater.address.zip}}{% endif %}</span>{% if theater.address.phone %}<span class="sPrTr">{{theater.phone}}</span>{% endif %}</div>';
            contentString+='</div><a href="{% url "locality_map_map_get_direction" %}?aid={{addr.id}}&objid={{theater.id}}&src=cinemas" title="{% trans "Directions" %}" class="aBsLt bR10"><i aria-hidden="true" class="bUi-iCn-dRt-20 fS12 "></i></a></div></li></ul>';
            
            marker['content_info'] = contentString;
            markers.push(marker);
        {% endwith %}
    {% endfor %}
    
    {% if other_theaters %}
        {% for theater in other_theaters %}
                {% with theater.address as addr %}
                    var marker = new Object();
                    marker["lat"] = {{addr.lat}};
                    marker["lng"] = {{addr.lon}};
                    marker["zoom"] = {{addr.zoom}};
                    marker["icon"] = icon_sml;
                    
                    var contentString = '<ul id="map-view'+{{theater.id}}+'" class="cLrFx map-info modulesBrowseData mDa-lT mDa-oT-lT">';
                    contentString+='<li class="mDa mR0"><div class="mDa-bDy pD0"><div class="pLlT iM">';
                    contentString+='<span class="pD15 bLk pDr10mP pDl0mP"><i aria-hidden="true" class="bUi-iCn-mP-mKr-16 cLr-rEd fS24"></i></span></div>';
                    contentString+='<div class="cLr-lT"><h5 class="mDa-hD tRnC mRt10 mRb5 w85P rLvE" title="{{ theater.name }}">';
                    contentString+='<a href="{{theater.get_absolute_url}}" class="fW-bLd">{{ theater.name }}</a></h5>';
                    contentString+='<div class="mDa-dTa fS12 cLr-gRy"><span>{{theater.address.address1}}{% if theater.address.address2 %}, {{theater.address.address2}}{% endif %}{% if theater.address.city %}, {{theater.address.city}}{% endif %}{% if theater.address.zip %} {{theater.address.zip}}{% endif %}</span>{% if theater.address.phone %}<span class="sPrTr">{{theater.phone}}</span>{% endif %}</div>';
                    contentString+='</div><a href="{% url "locality_map_map_get_direction" %}?aid={{addr.id}}&objid={{theater.id}}&src=cinemas" title="{% trans "Directions" %}" class="aBsLt bR10"><i aria-hidden="true" class="bUi-iCn-dRt-20 fS12 "></i></a></div></li></ul>';
                    
                    marker['content_info'] = contentString;
                    markers.push(marker);
                {% endwith %}
        {% endfor %}
     {% endif %}   
    
    setTimeout(function(){load_global_map('map-canvas',{{ globalsettings.google_map_lat }}, {{ globalsettings.google_map_lon }}, {{ globalsettings.google_map_zoom }}, markers, false)},500);
});

</script>
{% endblock %} 
