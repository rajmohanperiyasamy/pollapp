{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% block navigation %}
	{% activetab "selmodule" "polls" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Polls' %} {% endblock %}
{% block head %}
	<script type="text/javascript" src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
{% endblock %}
{% block content %}
 <div id="staff-platform" class="group">
  	<div class="header-bar has-sub">
	<h2>{% trans 'Polls' %}</h2>
        <section class="sub-header-bar">
            <div class="group">
                  <div class="filter-view-tabs">
                        <ul class="left">
                              <li><label>{% trans 'View:' %}</label></li>
                              <li class="view-tab tip tip1" id="filter_a">
                                    <a title="{% trans 'View All' %}" name="all" id="listing_all" class="view-both tttxt-n active first" href="javascript:void(0)"><span>All</span></a>
                                    <a title="{% trans 'Pending Only' %}" name="N" id="listing_pending" class="view-pending tttxt-n" href="javascript:void(0)"><span>Pending</span></a>
                                    <a title="{% trans 'Published only' %}"  name="P" id="listing_published" class="view-published tttxt-n" href="javascript:void(0)"><span>Published</span></a>
                                    <a title="{% trans 'Blocked only' %}" name="B" id="listing_blocked" class="view-withdrawn tttxt-n last" href="javascript:void(0)"><span>{% trans 'Blocked' %}</span></a>                                                
                              </li>
                              <li class="view-tab tip tip2" id="filter_c">
                                    <a title="{% trans 'View All' %}" class="view-both tttxt-n active first" name="all" href="javascript:void(0)"><span>{% trans 'All' %}</span></a>
                                    <a title="{% trans 'Show my Polls' %}"  name="CSM" class="view-mine tttxt-n" href="javascript:void(0)"><span>{% trans 'Your' %}</span></a>
                                    <a title="{% trans 'Show Polls posted by others' %}" name="CSO" class="view-others tttxt-n last" href="javascript:void(0)"><span>{% trans 'Others' %}</span></a>
                              </li>
                        </ul>
                        <form action="staff_polls_ajax_list_polls" id="polls-search-form" class="module-search tip tip3">
                            <button role="button" class="cform-button search-button" id="btnSearch" type="button" onclick="$('#id_search').val('true'),hm_search();"><span class="search-icon">{% trans 'Search' %}</span></button>
                            <div class="inline-block relative-block">
                                <!--span onclick="clear_search();" class="reset txt-button tttxt" id="close_search" title="{% trans 'Clear Search' %}" style="{% if not search %}display:none;{% endif %}">Clear search</span-->
								<input type="text" placeholder="{% trans 'Search polls' %}" onkeydown="if (event.keyCode == 13) document.getElementById('btnSearch').click();" onkeyup="$('.search_adv2').val(this.value);" name="search_keyword" id="id_search_keyword" class="search-list-items search_adv1">
							    <div class="call-advanced-search">
                                    <span class="arrow-down tttxt" title="{% trans 'Show search options' %}"></span>
                                </div> 
                                <div id="advanced-search-options" style="display: none;">
                                	<div class="search-head">
                                    	<!-- h5>Search</h5 -->
                                    	<span class="inline-block icon-close close-this"></span>
                                    </div>
                                    <div class="advanced-search-fields">
                                		<dl class="vertical">
                                			<dt><label>{% trans 'Search' %}</label></dt>
                                			<dd>
                                            	<input type="text" placeholder="{% trans 'keywords' %}" class="search_adv2" onkeyup="$('.search_adv1').val(this.value);" name="search_keyword1" id="id_search_keyword1" style="width:161px;height:25px;">
                                			</dd>                                                        
                                			<dt></dt>
                                			<dd>
                                            	<select style="width: 165px;" class="select-menu" id="search_type">
                                                    <option value="">{% trans 'All' %}</option>
			                                        <option value="title">&nbsp;{% trans 'Title' %}</option>
													<option value="postedby">&nbsp;{% trans 'Posted By' %}</option>
                                				</select>
                                			</dd>
                                			<dt></dt>
											<dd>
                                            	<select style="width: 165px;" class="select-menu" id="search_status">
                                                    <option value="">{% trans 'Status' %}</option>
			                                        <option value="P">&nbsp;{% trans 'Published' %}</option>
                                                    <option value="N">&nbsp;{% trans 'Pending' %}</option>
													<option value="B">&nbsp;{% trans 'Blocked' %}</option>
													<option value="E">&nbsp;{% trans 'Expired' %}</option>
                                				</select>
                                			</dd>
											<dt></dt>
                                		</dl>
									</div>                                                        
                                	<div class="form-submit"><button type="button" class="btn-txt-blue small advnc_search" onclick="$('#id_search').val('true'),hm_search();" role="button"><span class="btn-txt">{% trans 'aSearch' %}</span></button></div>
                                </div> 
                                                                                                                         
							</div>                                                
                        </form>
                  </div>
                  <div class="add-section-right">
                        <a href="{% url 'staff_polls_add_poll' %}" class="btn-txt-prime {% if not perms.polls.add_poll %}disabled{% endif %}" title="{% trans 'Add New Poll' %}"><span class="btn-txt">{% trans 'Add New Poll' %}</span></a>
                  </div> 
            </div>
        </section>                          
 		</div>
		<div id="core-wraper" class="group">
        	<div class="staff-main">
              	<div class="page-wrap">
					<div id="polls" class="group">
                        <section class="toolbars">
                            <div class="group">
                                <ul class="toolbar left">
                                    <li class="master-check tool">
										<span class="cform-checkbox-container"><input type="checkbox" value="true"  id="master_check" name="master-check"><span class="cform-checkbox-element"></span></span>
									</li>
                                    {% if perms.polls.delete_polls or perms.polls.publish_polls %}
									<li class="tool action_status tip tip4">
                                        <select  data-placeholder={% trans 'Action' %} id="actionSelect" class="select-menu" onchange="$('#id_action').val($(this).val()),action();" style=" width:140px;">
                                          <option value="#"></option>
										  {% if perms.polls.delete_poll %}
                                          	<option value="DEL">{% trans 'Delete' %}</option>
										  {% endif %}
										  
                                        </select>
                                    </li>
									{% endif %}
                                    <li class="tool tip tip5">                                                       
                                        <label class="inline-block">{% trans 'Sort by:' %}</label>
                                        <select id="orderSelect" onchange="$('#id_sort').val($(this).val()),hm_sort();" style="width:140px;" class="select-menu">
                                              <option value="-created_on" selected="">{% trans 'Newest' %}</option>
                                              <option value="created_on">{% trans 'Oldest' %}</option>
                                              <!-- option value="-most_Voted">{% trans 'Most Voted' %}</option-->
                                        </select>                                                    
                                    </li>
                                </ul>
                                {% include 'common/pagination_top.html'%} <!-- pagination top -->  
                            </div>
                        </section>
						<span id="ajax_content_loading" class="load-list-items" style="display:none">
						 	<img src="{{STATIC_URL}}ui/images/global/loading.gif" align="...">
						</span>
						<div style="display:none;" class="info-bar" id="top_info_bar"></div>
						<div id="id_content_listing" class="group">
                              {% include 'polls/staff/ajax-poll-listing.html'%} 
						</div>	                                       
                    </div> <!-- end table -->
              </div>  <!-- end page wrap -->
        </div>  <!-- end main-col -->                            
        <div id="aside" class="side-bar">
        	<input type="hidden" value="{% url 'staff_polls_ajax_state' %}" name="id_polls_status_url" id="id_polls_status_url">
        	<div id="module-stats" class="section">
            	<div class="group">
                    <h5>{% trans 'State' %}</h5>
                    <div class="stats-toggle tip tip6">
                        <a class="state-all statefltr {% if status == 'all' %}active{% endif %} tttxt" onclick="show_count('all');"  href="javascript:void(0)" id="id_status_all" title="{% trans 'Show all state' %}"><span class="icon-state-all"></span></a>                                                    
                        <a class="state-you statefltr {% if status == 'mine' %}active{% endif %} tttxt" onclick="show_count('mine');" href="javascript:void(0)" id="id_status_mine" title="{% trans 'Show your state' %}"><span class="icon-state-you"></span></a>                                    </div>
					<span id="ajax_loading" class="loading-stats"  style="display:none;"><img src="{{STATIC_URL}}ui/images/global/loading-s.gif" align="..."></span>
				</div>
            	<ol class="stats-summary" id="id_module_state_listing">
                	 <li class="pending-state"><strong id="id_pend">{{ pending }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Pending' %}</a></li>
			         <li class="published-state"><strong id="id_pub">{{ published }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Published' %}</a></li>
			         <li class="expired-state"><strong id="id_exp">{{ expired }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Expired' %}</a></li>
			         <li class="blocked-state"><strong id="id_blk">{{ blocked }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Blocked' %}</a></li>
			         <li class="sum"><strong id="id_tot">{{ total }}</strong> {% trans 'total polls posted.' %}</li>
                </ol>
            </div>
			<div class="section">
				<a class="quick_help" href="https://docs.google.com/a/doublespring.com/document/d/1qSud3JD7RY5ybuy5vj2Es2lSQmb2Iuwcu8SpHlb5b1Y/edit#bookmark=id.4dm8wwlbrbzh" target="_blank"><span class="icon">?</span>Quick help</a><hr>
				<h6>Polls:</h6>
				<p>People's opinions and views on a particular subject for the purpose of analysis.</p>
				<p>For single and multiple choice questions you predefine answers, for rating questions you predefine the subjects to be rated. Enter one answer or subject per line into the 'choices' text fields.</p>
			</div>
        </div>                            
	</div>                                                    
</div>
{% endblock %}			
{% block footer_include%}
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/polls/poll_staff.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}ui/js/listing_settings.js"></script>    
<script type="text/javascript">
	checkall = function(){
			var cb = document.getElementById("master_check");
			if(cb.checked){
				$(".cbox").attr("checked","true");
			}if(!cb.checked){
				$(".cbox").removeAttr("checked");
			}
	}
	
</script>
<script type="text/javascript">
	$(document).ready(function(){

		$('.tool.action_status .chzn-container').addClass('chzn-disabled , disabled_chosen');

		$('.article_tpe').colorbox({width: "560",initialWidth: "560", top:"60", initialHeight: "200"});
		
		$(".iframe").colorbox({width:"800", height:"560", iframe:true});

		
	}); 			
</script>	
<script type="text/javascript">
function txtarealimit(txtobj,len){
	var txtvalue = txtobj.value;
	var the_len = txtvalue.length;
	if (the_len > len){
		txtobj.value = txtvalue.substring(0,len);
	}
	txtobj.scrollTop=txtobj.scrollHeight;
}
function save_seo(option){
	var flag = $('#mform').validate().form()
	var id=0;
	if(flag==true){
		var dataString='&slug='+encodeURIComponent($('#id_slug').val());
		dataString+='&seo_title='+encodeURIComponent($('#id_seo_title').val());
		dataString+='&seo_description='+encodeURIComponent($('#id_seo_description').val());
		$('#ajax_content_seo').hide();
		$('#ajax_content_loading_seo').show();
		$.ajax({
		type: "POST",
		url: $("#mform").attr("action"),
		data: dataString,
		dataType:'JSON',
		success: function(data){
				$('#ajax_content_loading_seo').html(data.msg);
				if(data.status){
					show_msg(data.msg,data.mtype);
					$.colorbox.close();
				}else{
					$('#ajax_content_loading_seo').hide();
					$('#ajax_content_seo').empty().html(data.lightbox_html);
					$('#ajax_content_seo').fadeIn(2000);
				}
			}
		});
	}
}
</script>
<ul class="tour_link">
    <li class="tool-tip tttxt-t1"><a class="link1" href="/bmt/tour/polls/staff/status.html"></a></li>
    <li class="tool-tip tttxt-t2"><a class="link2" href="/bmt/tour/polls/staff/submissions.html"></a></li>
    <li class="tool-tip tttxt-t3"><a class="link3" href="/bmt/tour/polls/staff/search.html"></a></li>
    <li class="tool-tip tttxt-t4"><a class="link4" href="/bmt/tour/polls/staff/actions.html"></a></li>
    <li class="tool-tip tttxt-t5"><a class="link5" href="/bmt/tour/polls/staff/sorting.html"></a></li>
    <li class="tool-tip tttxt-t6"><a class="link6" href="/bmt/tour/polls/staff/state.html"></a></li>
    <li class="tool-tip tttxt-t7"><a class="link7" href="/bmt/tour/polls/staff/status_aside.html"></a></li>
    <li class="tool-tip tttxt-t8"><a class="link8" href="/bmt/tour/polls/staff/settings.html"></a></li>
</ul>
{% endblock %}					