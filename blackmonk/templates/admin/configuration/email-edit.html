{% load i18n %}
<script type="text/javascript">
    $(document).ready(function(){
        $.validator.addMethod("desc_required", function(value, element) {
            $('#temp_content').val(edt.getData());
            if($('#temp_content').val()!=''){return true;}
            else{return false;}
        },"Please enter a template content.");
        $("#mform").validate({
            ignore:'',
            highlight: function(element, errorClass){$(element).parent('div').parent('div').addClass('field-error');$(element).addClass("error");},
            unhighlight: function(element, errorClass){$(element).parent('div').parent('div').removeClass('field-error');$(element).removeClass("error");},
            errorPlacement: function(error, element){},
               rules:{
                subject: "required",
                temp_content: "dec_required",
               }
        });
    });
</script>
<div id="edit-email">
    <form method="post" id="mform" name="mform" action="{% url 'admin_configuration_save_emailtemplate' %}">{% csrf_token %}
        <div class="fields vform">
            <div class="field-group">
            <input type="hidden" value="{{ email_temp.code }}" name="template_code" id="id_template_code">
                <div class="field text-field fd-title">
                    <div class="label"><label>{% trans 'Subject' %}</label></div>
                    <div class="value"><input type="text" id="id_title" placeholder="Subject" value="{{ subject }}" name="subject"  style="width:480px;"></div>
                </div>
                <div class="field text-field">
                    <div class="label"><label></label>{% trans 'Body' %}</div>
                    <div class="value" style="height:300px;"><textarea  name="temp_content" id="id_temp_content" rows="6">{{ template }}</textarea></div>
                </div>
                <div class="field variable-details">
                    <h4>{% trans 'Variables Description' %}</h4>
                    <p>{% trans 'Use the variables below in your message text. The system will replace the variable with a corresponding value from the database. The variables must be in ALL CAPITAL LETTERS.' %} </p>
                    {% for key,value in dcrip.items %}
                    <div class="variables group">
                        <span class="variable-label">{{ value }}</span>
                        <span class="variable-value">{{ key}}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="modal-base form-submit group">
           <button role="button" class="cform-button prime right"  type="submit"><span class="cform-button-text">{% trans 'Save' %}</span></button>
        </div>
    </form>
    <script type="text/javascript" src="{{ STATIC_URL }}ui/js/inline.js"></script>
    <script type="text/javascript">
    try{
        var instance = CKEDITOR.instances['id_temp_content'];
        CKEDITOR.remove(instance);
    }
    catch(e){}
    /*
    CKEDITOR.on( 'instanceCreated', function( e ){
        e.editor.addCss('body { font-size:12px; font-family:Arial, "Times New Roman", Verdana;}');
    });
    var edt=CKEDITOR.replace( 'id_temp_content', {
        customConfig : '{{ STATIC_URL }}js/ckeditor/custome_config.js',
        toolbar : 'Basic',
    });
	*/
        edt=CKEDITOR.replace( 'id_temp_content',{
            customConfig : '{{ STATIC_URL }}js/ckeditor/custome_config.js',
            toolbar : 'Full',
            //width:500,height:400,
            //filebrowserImageUploadUrl : '{%url 'article_upload_from_editor' %}'
        });
    </script>
</div>
