{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load get_example %}
{% block navigation %}
	{% activetab 'topnav' 'site' %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% if misc %}{% trans 'Misc | Update Attribute' %}{% else %}{% trans 'Misc | Add Attribute' %}{% endif %} {% endblock %}
{% block head %}
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
	<div id="admin-platform" class="group">
    	<div class="header-bar">
        	<div id="nav-roll">
            	<ul>
                	<li id="modules-index" class="first"><a href="{% url 'admin_portal' %}" style="z-index:9"><span class="icon"></span>{% trans 'Affiliate' %}</a></li>
					<li><a href="{% url 'admin_config_manage_things_to_do' %}" style="z-index:8">{% trans 'Places To See' %}</a></li>
				</ul>
			</div>
		</div>
		<div id="core-wraper" class="group">
        	<div class="admin-main col_12">
            	{% block leftnavigation %}
					{% activetab 'topnav' 'prog' %}
					{% activetab 'leftnav' 'placestosee' %}
					{{ block.super }}
				{% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
					<div class="page-wrap">
                    	<div class="page-head br_0">
                        	<h2>{% trans 'Places To See Affiliate Program' %}</h2>
							<p class="ltxt80">{% trans 'Integrate' %} <a href="http://www.viator.com" target="_blank" rel="nofollow">Viator</a> {% trans 'Affiliate in your website to retrieve places-to-see.' %}</p>
                        </div>
						<div id="page_content_holder" class="group">
							{% if form.errors %}
								<div class="messageerror" >
									<strong>{% trans 'There is a problem with your submission' %}</strong>
						            <ul style="list-style:square;margin-left:20px;">
						           		{% for field in form %}
						           			{% if  field.errors%}<li>{%for error in field.errors%}{{error}}{%endfor%}</li>{% endif %}
						          	 	{% endfor %}
									</ul>
							 	</div>
							{% endif %}
							{% if seoform.errors %}
								<div class="messageerror">
									<strong>{% trans 'There is a problem with your submission' %}</strong>
						            <ul style="list-style:square;margin-left:20px;">
						           		{% for field in seoform %}
						           			{% if  field.errors%}<li>{%for error in field.errors%}{{error}}{%endfor%}</li>{% endif %}
						          	 	{% endfor %}
									</ul>
							 	</div>
							{% endif %}
						    <form action="{% url 'admin_config_manage_things_to_do' %}" name="mform" id="mform" method="post" class="add_category">{% csrf_token %}
						        <div class="fields hform"> 
						            <div class="field-group" style="padding:10px 0;"> 
						                <!--div class="field text-field">
						                    <div class="label"><label for="">{% trans 'Name' %}<span class="required-field">*</span></label></div>
						                    <div class="value">{{form.attr_name}}</div>
						                </div> 
										<div class="field text-field">
						                    <div class="label"><label for="">{% trans 'Attribute Key' %}<span class="required-field">*</span></label></div>
						                    <div class="value">{{form.attr_key}} </div>
						                </div--> 
						                <div class="field text-field">
						                    <div class="label"><label for="">{% trans 'URl' %}<span class="required-field">*</span></label></div>
						                    <div class="value">
												<input type="hidden" value="Viator Things To Do"	id="id_attr_name" name="attr_name"/>
												<input type="hidden" value="VIATOR_URL"	id="id_attr_key" name="attr_key"/>
												{{form.attr_value}}
											</div>
						                </div>
										<div class="field text-field">	
						                	<div class="label"><label>{% trans 'Meta Title (SEO)' %}<span class="required-field">*</span></label></div>	
						                	<div class="value"><input type="text" id="id_meta_title" {% if form.errors %} value="{{form.meta_title.data}}" {% else %}value="{{seo.seo_title}}" {% endif %} class="fm" placeholder="{% trans 'Enter a short title' %}" maxlength="400"  name="meta_title" autocomplete="off"></div>	
						                </div>
										<div class="field text-field">	
						                	<div class="label"><label>{% trans 'Meta Description (SEO)' %}<span class="required-field">*</span></label></div>	
						                	<div class="value"><textarea onkeyup="txtarealimit(this,400);" class="fm" name="meta_description" id="id_meta_description" rows="4">{% if form.errors %}{{form.meta_description.data}}{% else %}{{seo.seo_description}} {% endif %} </textarea></div>	
						                </div>
						            </div><!--/field-group-->
						                                                          
						        </div> 
						        <div class="form-submit right group trp-bg right" style="padding-right:0;">
									<button role="button" class="cform-button" id="url_validate_button" type="button" style="margin-right:3px;"><span class="cform-button-text">{% trans 'Validate API' %}</span></button>
						           <button role="button" class="cform-button prime" type="submit"><span class="cform-button-text">{% trans 'SAVE' %}</span></button>
						        </div>                                                
						    </form>
						</div> 
												
						
	               	</div>
	         	</div>                       
	       	</div>    
		<div id="aside" class="side-bar col_4">
			<div class="section">
				<a class="quick_help" href="https://docs.google.com/a/doublespring.com/document/d/156Uk5kBmlq8ThOO2UDmXP02gFuLrF6pFMyHeaH8aeBE/edit#bookmark=id.fxr7puj7cwc8" target="_blank"><span class="icon">?</span>Quick help</a>
				<hr>
				<h5>{% trans 'Viator API Page:' %}</h5>
				<p>{% trans 'Integrate Viator API and add ‘Places to see’ section on your website' %}</p>
				<hr>
				<h6>{% trans 'URL:' %}</h6>
				<p>{% trans 'Register on viator partner site https://www.partner.viator.com/partner/register/register.jspa and generate a URL for your location' %}</p>
				<hr>
				<h6>{% trans 'Page Title (SEO):' %}</h6>
				<p>{% trans 'Enter SEO Title in 70 characters or less. SEO Title is important for search ranking – please include keywords.' %}</p>
				<hr>
				<h6>{% trans 'Description:' %}</h6>
				<p>{% trans 'Enter compelling description of the web page in 160 characters or less.' %}</p>
			</div>                                    
		</div>     	                        
		</div>                                                    
	</div>
</div>
<script type="text/javascript">
$(document).ready(function(){
	$("#mform").validate({
		ignore:'',
		highlight: function(element, errorClass){$(element).parent().parent().addClass('field-error');$(element).addClass('error');},
		unhighlight: function(element, errorClass){$(element).parent().parent().removeClass('field-error');$(element).removeClass('error');},
		errorPlacement: function(error, element){},
	   	rules:{
			attr_value: "required",
			meta_title:"required",
			meta_description:"required"
	   	}
	});
	$('#url_validate_button').live("click",function(){
		var flag=$("#mform").validate().form();
		if(flag){
			$.ajax({
				type:'get',
				url:'{% url 'admin_api_check_url_exist' %}',
				data:"url="+$('#id_attr_value').val(),
				success:function(data){
					if(data=='1'){show_msg('URL specified is valid.','alert-success')}
					else{show_msg('Oops!!! Invalid URL.','alert-error')}
				}
			
			})
		}
	})
});
</script>

{% endblock %}
