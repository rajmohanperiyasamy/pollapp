{% load i18n %}  
{% load ds_utils %}
{% load truncate_filter %}
{% load thumbnail %}
 	
  <!-- Hidden Fields -->
  <input type="hidden" name="view_by" id="id_view_by" value="{{view_by}}">	
  <input type="hidden" name="url" id="id_hidden_url" value="{% url 'admin_ajax_display_staff' %}">
  <input type="hidden" name="url" id="id_hidden_action_url" value="{% url 'admin_ajax_staff_action' %}">    		
  <input type="hidden" value="{% if search %}{{search}}{% endif %}" name="id_search" id="id_search">
  <input type="hidden" name="update_rolls_url" id="id_update_rolls_url" value="{% url 'admin_ajax_update_staff_rolls_count' %}">
  <input type="hidden" name="delete_url" id="id_delete_url" value="{% url 'admin_ajax_delete_staff' %}">
  <input type="hidden" value="" name="id_action" id="id_action">
  <!-- Hidden Fields -->

{% if profiles %}  
<ul id="staffs" class="cat-list-container">
    <li class="cat-list-row hdr-rw">
        <div class="cat-list-row-inner group">
            <div class="cat-list-column member-login">
            	{% trans 'Login' %}                                                 
            </div>
            <div class="cat-list-column member-last-login">
            	{% trans 'Last Login' %}
            </div>
            <div class="member-roles">
            	{% trans 'Role' %}
            </div>
		</div>
	</li> 
	<div id="id_append_list"> <!-- Extra Div Shaan -->     
	{% for profile in profiles %} 
	<input type="hidden" class="dev_allids" value="{{profile.user.id}}">
	<li class="cat-list-row" id="id_user_list_{{profile.user.id}}">    
        <div class="cat-list-row-inner group">
            <div class="cat-list-column member-login">
            	<a href="{% url 'admin_ajax_user_profile' %}?uid={{profile.user.id}}" title="{% trans 'Profile Information' %}" class="bm-add-gadget light_box">
                	<div class="user-icon">
					{% if profile.image %}
						<img src="{% thumbnail profile.image 48x48 %}" class="inline-block o3"></div>
					{% else %}
						<img src="{{STATIC_URL}}images/generic.gif" width="48" height="48" class="inline-block o3"></div>
					{% endif %}
                	<h5 class="username">{{profile.user.first_name}}</h5>
					<span class="email" title="{{profile.user.email}}">{{profile.user.useremail|truncate_chars:28}}</span>
				</a>                                                    
            </div>
            <div class="cat-list-column member-last-login">
            	<span class="time">{{profile.user.last_login|get_readable_time_format}} {% trans 'ago' %}</span>
            </div>
            <div class="cat-list-column ovr-visible member-roles">
            	<div class="select-role">
                    <select class="select-menu lb_select-menu" style="width:116px;" {% if profile.user.is_superuser %} disabled="disabled" {% endif %} onchange="if($(this).val()=='na'){alert('Please select a valid option');}else{update_roll({{profile.user.id}},$(this).val(),'{% url 'admin_ajax_update_staff_roll' %}')}">
					  {% if profile.user.is_superuser %}
							<option value="0" selected="">Admin</option>
					  {% else %}
						<option value="na">{% trans 'Not Assigned' %}</option>
					  {% for group in groups %}
						<option value="{{group.id }}" {% if profile.groups.all.0.id == group.id %}selected=""{% endif %}>{{group.name|title}}</option>
					  {% endfor %}
					  {% endif %}	
                    </select>                
                </div>                                   
            </div>
            <div class="action-buttons">
              	<div class="group">
                    {% if not profile.is_superuser %}
					<a href="{% url 'admin_ajax_delete_type' profile.id %}" target="_blank" class="btn-txt bm-add-gadget" title="Delete / Deactivate User"><span class="action-icon icon-delete"></span></a>
					<a title="{% trans 'Update Staff Account' %}"  href="{% url 'admin_ajax_update_staff' %}?uid={{profile.user.id}}" class="txt-button tttxt-n bm-add-gadget light_box"><span class="action-icon icon-edit"></span></a>
                    {% endif %}
				</div>
            </div>
            <div class="member-status">
                <div class="relative-block dev_hide_list_status" onclick="change_status({{profile.id}});" id="id_change_status_div_{{profile.id}}">
                    <span class="status-inside inline-block" id="id_change_status_span_{{profile.id}}">
                        <span class="inline-block status-idty {% if profile.status == 'A' %}icon-active-user{% else %}icon-inactive-user{% endif %}" id="id_change_status_span_icon_{{profile.id}}"></span>
                        <span class="arrow"></span>
                    </span>
                    <ul class="dropdown-list" id="id_change_status_ul_{{profile.id}}">
                        <li><a href="javascript:void(0)" id="id_change_status_text_{{profile.id}}" onclick="save_status({{profile.id}});">{% if profile.status == 'A' %}{% trans 'Deactivate' %}{% else %}{% trans 'Activate' %}{% endif %}</a></li>
                    </ul>    
                </div>                                                     
            </div>
		</div>
	</li> 
	{% endfor %}
	</div> <!-- Extra Div Shaan Ends-->
</ul>
<div id="pagenation">{% include 'admin/usermgmt/ajax-pagination.html' %}</div>
{% else %}
<div class="no-data"> <p>{% trans 'Sorry , No staffs found !' %}</p></div>
{% endif %}
<script type="text/javascript" src="{{STATIC_URL}}ui/js/inline.js"></script>
