{% load i18n %}
<div id="ajax_content_loading" style="display:none;padding-top:222px;padding-bottom:222px;text-align:center;">
	<img src="{{STATIC_URL}}ui/images/global/loading-s.gif"><br><p>{% trans 'Saving Settings' %}</p>
</div>
<div id="ajax_content" class="group">
	<form action="{% url 'admin_portal_classifieds_approval' %}" name="mform" id="mform" method="post">{% csrf_token %}
	<ul class="overview-list group">
			<li class="list-item-container group">
            	<div class="col-dt">
                	<div class="col-inner">
                    	<h5>{% trans 'Classifieds listed' %}</h5>
                    </div>
				</div>
                <div class="col-dd">
                	<div class="col-inner">
                    	<h3>{{classifieds_count}}</h3>
                        <p><span class="ltxt80">{% trans 'Featured' %}: {{featured_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Sponsored' %}: {{sponsored_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Free' %}: {{basic_classifieds}}</span></p>
						<p><span class="ltxt80">{% trans 'Published' %}:&nbsp;{{published_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Pending' %}:&nbsp;{{pending_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Drafted' %}:&nbsp;{{drafted_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Rejected' %}:&nbsp;{{rejected_classifieds}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Blocked' %}:&nbsp;{{blocked_classifieds}}</span></p><p><span class="ltxt80">{% trans 'Expired' %}:&nbsp;{{expired_classifieds}}</span></p>
                        <a href="{% url 'staff_classified_home' %}" class="action edit-icon tttxt start-modal" title="{% trans 'Manage Classifieds' %}">{% trans 'Manage' %}</a>
                   	</div>                                                    
              	</div>
			</li> 
			<li class="list-item-container group">
            	<div class="col-dt">
                	<div class="col-inner">
                    	<h5>{% trans 'Categories' %}</h5>
                   	</div>
               	</div>
                <div class="col-dd">
                	<div class="col-inner">
                    	<h3>{{category}}</h3>
						<p><span class="ltxt80">{% trans 'Parent Category' %}:{{parent_category}}</span><span class="divider13">|</span><span class="ltxt80">{% trans 'Sub Category' %}: {{sub_category}}</span></p>
                        <a href="{% url 'admin_portal_classifieds_category' %}" class="action edit-icon tttxt start-modal" title="{% trans 'Manage Categories' %}">{% trans 'Manage' %}</a>
                  	</div>                                                    
				</div>
			</li>
			<li class="list-item-container group">
            	<div class="col-dt">
                	<div class="col-inner">
                    	<h5>{% trans 'Attribute' %}</h5>
                   	</div>
               	</div>
                <div class="col-dd">
                	<div class="col-inner">
                    	<h3>{{total_atr}}</h3>
                        <a href="{% url 'admin_portal_classifieds_attribute' %}" class="action edit-icon tttxt start-modal" title="{% trans 'Manage Attribute' %}">{% trans 'Manage' %}</a>
                  	</div>                                                    
				</div>
			</li>
			<li class="list-item-container group">
            	<div class="col-dt">
                	<div class="col-inner">
                    	<h5>{% trans "Listing Level" %}</h5>
                   	</div>
               	</div>
                <div class="col-dd">
                	<div class="col-inner">
						{% for level in payment_level %}
							<p><span class="ltxt80">{{level.level_label}}</span></p>
						{% endfor %}
						<a href="{% url 'admin_portal_classifieds_price' %}" class="action edit-icon tttxt start-modal" title="{% trans 'Manage Pricing' %}">{% trans 'Manage' %}</a>
                  	</div>                                                    
				</div>
			</li>
        </ul>
		<div class="fields vform no_head"> 
            <div id="meta-tags" class="field-group">
                <div class="fields-head">
                    <h3>{% trans 'Page Title (SEO)' %}</h3>
                    <p class="ltxt80">{% trans 'Write a short page title. This title is used in the search results of search engines like Google.' %}</p> 
                </div>  
                <div class="field text-field">	
                    <div class="value">
                        <input class="fxl" title="{% trans 'Meta Title' %}" name="meta_title" id="id_meta_title" type="text" placeholder="{% trans 'Enter a short title' %}" {% if seo_form.errors %} value="{{seo_form.meta_title.data}}" {% else %}value="{{seo.seo_title}}" {% endif %}  >
                    </div>	
                </div>
            </div>   
        </div> 
        <div class="fields vform no_head"> 
            <div id="meta-tags" class="field-group">
                <div class="fields-head">
                    <h3>{% trans 'Page Description (SEO)' %}</h3>
                    <p class="ltxt80">{% trans 'In one or two short sentences to describe your page. This description is used in the search results of search engines like Google.' %}</p> 
                </div>  
                <div class="field text-field">	
                    <div class="value">
                        <textarea rows="8" id="id_meta_description" name="meta_description" class="fxl" placeholder="{% trans 'Enter description' %}" onkeyUp="txtarealimit(this,400);">{% if seo_form.errors %}{{seo_form.meta_description.data}}{% else %}{{seo.seo_description}} {% endif %}</textarea>
                    </div>	
                </div>
            </div>   
        </div>
	{% include 'admin/portal/emailsettingsvalidate.html'%}
		<section id="approval-requirements" class="section hidable">
        	<div class="section-head">
            	<h3 class="section-title">{% trans 'Classified Approval Settings' %}</h3>
           	</div>
            <div class="section-content">
            	<div class="section-explanation">
                	<p class="ltxt80">{% trans 'Select the below options to approve the Classified Ad automatically when:' %}</p>
               	</div>                                         
                <ul class="cform-list">
                	<li class="cform-input-section"><label><span class="cform-checkbox-container">{{approval_form.free}}<span class="cform-checkbox-element"></span></span> {% trans 'Someone posts a new Classified Ad' %}</label></li>
                    <li class="cform-input-section"><label><span class="cform-checkbox-container">{{approval_form.free_update}}<span class="cform-checkbox-element"></span></span> {% trans 'Someone updates an existing Classified Ad' %}</label></li>
					<li class="cform-input-section"><label><span class="cform-checkbox-container">{{approval_form.paid}}<span class="cform-checkbox-element"></span></span> {% trans 'Someone posts a new Sponsored/Featured Classified Ad' %}</label></li>
					<li class="cform-input-section"><label><span class="cform-checkbox-container">{{approval_form.paid_update}}<span class="cform-checkbox-element"></span></span> {% trans 'Someone updates an existing  Sponsored/Featured Classified Ad' %}</label></li>
              	</ul>
			</div>                                                                                                    
     	</section> 
        <section id="email-notification" class="section hidable">
        	<div class="section-head">
            	<h3 class="section-title">{% trans 'Automatic email notifications' %}</h3>
           	</div>   
            <div class="section-content">
            	<div class="section-explanation">
                	<p class="ltxt80">{% trans 'Select the below options to send automatic email notifications when:' %}</p>
               	</div>                                           
				<div class="fields hform">
                <ul class="cform-list">
                	<li class="cform-input-section">
						<label><span class="cform-checkbox-container  checked"><input type="checkbox" id="on_add" {% if emailsettings.a_A %}checked="checked"{% endif %} class="cform-checkbox" name="on_add"><span class="cform-checkbox-element"></span></span> {% trans 'Someone posts a new Classified Ad' %}</label>
						<!--span style="display:block;margin-left:25px;"><input id="on_add_email"  name="on_add_email" value="{% if emailsettings.e_A %}{{emailsettings.e_A}}{% else %}{{request.user.email}}{% endif %}" type="text" style="width: 300px;{% if not emailsettings.a_A %}display:none;{% endif %}"></span-->
					</li>
                    <li class="cform-input-section">
						<label><span class="cform-checkbox-container  checked"><input type="checkbox" id="on_update" {% if emailsettings.a_U %}checked="checked"{% endif %} class="cform-checkbox" name="on_update"><span class="cform-checkbox-element"></span></span> {% trans 'Someone updates an existing Classified Ad' %}</label>
						<span style="display:block;margin-left:25px;"><input id="on_update_email" maxlength="60" name="on_update_email" value="{% if emailsettings.e_U %}{{emailsettings.e_U}}{% elif emailsettings.e_A %}{{emailsettings.e_A}}{% else %}{{request.user.email}}{% endif %}" type="text" style="width: 300px;{% if not emailsettings.a_U and not emailsettings.a_A %}display:none;{% endif %}"></span>
					</li>
               	</ul>                                                
			</div>                                                    
       	</section>

		<section id="email-notification" class="section">
        	<div class="section-head">
            	<h3 class="section-title"><span class="cform-checkbox-container  checked"><input type="checkbox" id="save_Oodle" checked="checked"  class="cform-checkbox" name="save_Oodle" onclick="show_oodle()"><span class="cform-checkbox-element"></span></span>{% trans 'Oodle API Settings' %}</h3>
           	</div>   
            <div class="section-content" id="oodle_content">
				<div class="section-explanation">
	                <p class="ltxt80">{% trans 'Specify the' %} <a href="http://api.oodle.com/" target="_blank" rel="nofollow" >{% trans "Oodle" %}</a> {% trans 'API settings.' %}</p>
    	        </div> 
				<div class="fields hform">
				<div class="field-group">              
					<div class="field text-field">
                	    <div class="label"><label>{% trans 'API KEY' %}</label></div>
                    	<div class="value">{{oodel_form.api_key}}</div>
    	            </div> 
					<div class="field text-field">
                	    <div class="label"><label>{% trans 'Radius' %}</label></div>
                    	<div class="value">{{oodel_form.radius}}</div>
    	            </div> 
					<div class="field text-field">
                	    <div class="label"><label>{% trans 'Location' %}</label></div>
                    	<div class="value">{{oodel_form.location}}</div>
    	            </div> 
					<div class="field text-field">
                	    <div class="label"><label>{% trans 'Region' %}</label></div>
                    	<div class="value">{{oodel_form.region}}</div>
    	            </div> 
				</div>  
				</div>                                                                                           			
			</div>                                                    
       	</section>  
        <section class="form-submit trp-bg right" style="padding-right:0;">
			<button role="button" class="cform-button" id="url_validate_button" type="button" style="margin-right:3px;"><span class="cform-button-text">{% trans 'Validate API' %}</span></button>
        	<button role="button" class="cform-button prime right" type="button" onclick="save_approval()"><span class="cform-button-text">{% trans 'Save Changes' %} </span></button>
		</section>                                             
	</form>                                       	   
</div>
<script type="text/javascript">
$(document).ready(function(){
	$("#mform").validate({
		highlight: function(element, errorClass){$(element).parent().parent().addClass('field-error');$(element).addClass('error');},
		unhighlight: function(element, errorClass){$(element).parent().parent().removeClass('field-error');$(element).removeClass('error');},
		errorPlacement: function(error, element){},
	   	rules:{
			api_key:"required",
			radius:"required",
			location:"required",
			region:"required"
	   	}
	});
	$('#url_validate_button').live("click",function(){
		var flag=$("#mform").validate().form();
		if(flag){
			var dataString='api_key='+$('#id_api_key').val();
			dataString+='&radius='+$('#id_radius').val();
			dataString+='&location='+$('#id_location').val();
			dataString+='&region='+$('#id_region').val();
			$.ajax({
				type:'post',
				url:'{% url 'admin_validate_oodle_api' %}',
				data:dataString,
				success:function(data){
					if(data=='Valid'){show_msg('API details specified is valid.','alert-success')}
					else{show_msg(data,'alert-error')}
				}
			})
		}
	});
});
</script>
<script type="text/javascript">
function show_oodle(){
	if($('#save_Oodle').is(':checked')){
		$('#oodle_content').show(300);
	}else{
		$('#oodle_content').hide(300);
	}
}
</script>