{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load get_example %}
{% block navigation %}
	{% activetab 'topnav' 'site' %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'News Provider' %} {% endblock %}
{% block head %}
<link rel="stylesheet" href="{{STATIC_URL}}ui/css/colorbox.css" type="text/css" />
<script type="text/javascript" src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
<script type="text/javascript">
$(document).ready(function(){
	$('#master-check').click(function(){
		if($("#master-check").is(':checked')){$(".check-overflow").attr('checked',true);}
		else{$(".check-overflow").attr('checked',false);}
	});
});
</script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript">
function txtarealimit(txtobj,len){
	var txtvalue = txtobj.value;
	var the_len = txtvalue.length;
	if (the_len > len){
		txtobj.value = txtvalue.substring(0,len);
	}
	txtobj.scrollTop=txtobj.scrollHeight;
}
function save_provider(option){
	var flag = $('#mform').validate().form();
	if(flag==true){
		var dataString='name='+encodeURIComponent($('#id_name').val());
		dataString+='&address='+encodeURIComponent($('#id_address').val());
		try{
			dataString+='&id='+$('#id_id').val();
			id=$('#id_id').val();
		}catch(ex){}
		$('#ajax_content').hide();
		$('#ajax_content_loading').show();
		$.ajax({
		type: "POST",
		url: "{% url 'admin_portal_news_provider_update' %}",
		data: dataString,
		dataType:'JSON',
		success: function(data){
				$('#div_'+id).remove();
				$('#category').append(data.append_html);
				$('#edit_link'+data.id).colorbox({width: "560",initialWidth: "560", top:"5%", initialHeight: "200"});
				$('#ajax_content_loading').html(data.msg);
				if(data.status){
					if(option==0){
						show_msg(data.msg,data.mtype);
						$.colorbox.close();
					}
				}
				$('#ajax_content').empty().html(data.lightbox_html);
				$('.modal-form .select-menu').chosen({disable_search_threshold:10});
	  			$('.field-group [title]').tipsy({trigger: 'focus', gravity: 'w',ftip:true});
				$('html, body').animate({scrollTop:0}, 'fast');
				setTimeout(function(){
					$('#ajax_content_loading').hide();
				    $('#ajax_content').fadeIn(2000);
					$.colorbox.resize();
				},1000);
			}
		});
	}
}
function delete_provider(ids){
	if(ids==0){
		var ids=[];
		$('.check-overflow').each(function(){
			if($(this).is(':checked')){
				ids.push($(this).val());
			}
		});
	}
	if(ids=='' || ids==null){
		alert(gettext('Please select Provider(s).'))
	}
	else{
		if(confirm(gettext('Are you sure want to delete seleced Provider(s) ?'))){
			$.ajax({
			type: "GET",
			url: "{% url 'admin_portal_news_provider_delete' %}",
			data: 'id='+ids,
			dataType:'JSON',
			success: function(data){
					if(data.status==1){
						try{
							$('#div_'+ids).remove();
						}catch(ex){}
						for(i=0;i<ids.length;i++){
							$('#div_'+ids[i]).remove();
						}
					}
					show_msg(data.msg,data.mtype);
				}
			});
		}
	}
}
</script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
	<div id="admin-platform" class="group">
    	<div class="header-bar">
        	<div id="nav-roll">
            	<ul>
                	<li id="modules-index" class="first"><a href="{% url 'admin_portal' %}" style="z-index:9"><span class="icon"></span>{% trans 'Modules' %}</a></li>
                    <li><a href="{% url 'admin_portal_news' %}" style="z-index:8">{% trans 'News' %}</a></li>
                    <li><a href="{% url 'admin_portal_news_provider' %}" style="z-index:7">{% trans 'Provider' %}</a></li>
				</ul>
			</div>
		</div>
		<div id="core-wraper" class="group">
        	<div class="admin-main col_12">
        		{% block leftnavigation %}
					{% activetab 'topnav' 'site' %}
					{% activetab 'leftnav' 'news' %}
					{% activetab 'leftnavsub' 'news_pro' %}
					{{ block.super }}
				{% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
					<div class="page-wrap">
                    	<div class="page-head br_0">
                        	<h2>{% trans 'Providers' %}</h2>
                            <p class="ltxt80">{% trans "Try to add the News Provider in the news module.Eg:'CNN.com'." %}</p> 
						</div>
						 <div class="cat-list group" id="email-configuration-list">
                        	<section class="toolbars">
                            	<div class="group">
                                	<ul class="toolbar left">
                                    	<li class="mas-check"><span class="checkbox-wrap tttxt-n" title="{% trans 'Select' %}">
										<span class="cform-checkbox-container"><input type="checkbox" id="master-check" name="master-check" class="master-check"><span class="cform-checkbox-element"></span></span>
										</span></li>  
                                        <li class="mas-delete"><a href="javascript:delete_provider(0)" title="{% trans 'Delete' %}" class="tttxt-n active"><span class="icon icon-delete"></span></a></li>
                                    	</li>
									</ul>
                                    <span style="float:right">
                                    	<a href="{% url 'admin_portal_news_provider_update' %}" title="{% trans 'Add New Provider' %}" class="btn-txt-inline-prime bm-add-gadget"><span class="btn-txt">{% trans 'Add New Provider' %}</span></a>
									</span>
								</div>
							</section>
                            <ul class="cat-list-container" id="category">
                            	{% for cat in providers %}
								<!--li class="cat-list-row" id="div_{{cat.id}}">
                                	<div class="cat-list-row-inner group">
                                    	<span class="checkbox-wrap">
                                    	<span class="cform-checkbox-container"><input type="checkbox" id="category" value="{{cat.id}}" name="category" class="check-overflow"><span class="cform-checkbox-element"></span></span>
                                    	</span>
                                        <div class="cat-list-column cat-name"><h3>{{cat}}</h3></div>
                                       
									    <div class="cat-list-column email-status">
											<div class="relative-block">
                                                <span  class="status-inside inline-block active "><span id="span_act_class_{{ cat.id }}" class="inline-block status-idty {% if cat.is_active %}icon-active-email{% else %}icon-inactive-email{% endif %}"></span><span  class="arrow"></span></span>
                                                <ul class="dropdown-list">
                                                    <li><strong>{% trans 'Change status to...' %}</strong></li>
													<li class="clk_li_hide"><a href="javascript:void(0);" id="active_{{ cat.id }}" onclick="change_status({{ cat.id }})">{% if cat.is_active %}{% trans 'Inactive' %}{% else %}{% trans 'Active' %}{% endif %}</a></li>
												</ul> 
                                            </div> 
										</div>
										<div class="cat-list-column action-buttons">
                                        	<div class="group">
                                                <a href="{% url 'admin_portal_news_provider_update' %}?id={{cat.id}}" title="{% trans 'Update Provider' %}" class="tttxt-n bm-add-gadget"><span class="icon icon-edit"></span></a>
                                                <a title="{% trans 'Delete' %}" class="tttxt-n" href="javascript:delete_provider({{cat.id}})"><span class="icon icon-delete"></span></a>
                                            </div>                                                            
										</div>
									</div>
								</li--> 
								 <li class="cat-list-row" id="div_{{cat.id}}">
	                                    <div class="cat-list-row-inner group">
	                                        <div class="cat-list-column email-name" style="padding-top:4px;">
	                                            <span class="checkbox-wrap"><span class="cform-checkbox-container"><input type="checkbox" id="category" value="{{cat.id}}" name="category" class="check-overflow"><span class="cform-checkbox-element"></span></span></span>
                                       			<div class="cat-list-column cat-name"><h3>{{cat}}</h3></div>
	                                        </div>
	                                         <div class="cat-list-column email-status">
	                                            <div class="relative-block">
	                                                <span  class="status-inside inline-block active "><span id="span_act_class_{{ cat.id }}" class="inline-block status-idty {% if cat.is_active %}icon-active-email{% else %}icon-inactive-email{% endif %}"></span><span  class="arrow"></span></span>
	                                                <ul class="dropdown-list">
	                                                    <li><strong>{% trans 'Change status to...' %}</strong></li>
															<li class="clk_li_hide"><a href="javascript:void(0);" id="active_{{ cat.id }}" onclick="change_status({{ cat.id }})">{% if cat.is_active %}{% trans 'Inactive' %}{% else %}{% trans 'Active' %}{% endif %}</a></li>
													</ul> 
	                                            </div> 
	                                        </div>
											<div class="action-buttons">
	                                            <div class="group">
	                                                <a title="{% trans 'Delete' %}" class="tttxt-n" href="javascript:delete_provider({{cat.id}})"><span class="icon icon-delete"></span></a>
	                                            </div>  
	                                        </div>
											<div class="action-buttons">
	                                            <div class="group">
	                                                <a href="{% url 'admin_portal_news_provider_update' %}?id={{cat.id}}" title="{% trans 'Update Provider' %}" class="tttxt-n bm-add-gadget"><span class="icon icon-edit"></span></a>
	                                            </div>  
	                                        </div>
	                                    </div>
	                                </li>  
								{% endfor %}                                           
							</ul>                         
                    	</div>
                	</div>
            	</div>                       
            </div>                            
			{% include 'admin/portal/news/provider-faq.html' %}                          
		</div>                                                    
	</div>
</div>
<script type="text/javascript">
$(document).ready(function() {
	$('.status-inside').removeClass('active');
	$('.email-status .relative-block').click(function(){
	       $('ul.dropdown-list').hide();
	       $('.status-inside').removeClass('active');
	       $(this).find('.status-inside').addClass('active');
	       $(this).find('ul.dropdown-list').show();
	});        
	$('div#content, li.clk_li_hide').click(function() {
		$('ul.dropdown-list').hide();
		$('.status-inside').removeClass('active');
	});
	$('.email-status .relative-block, ul.dropdown-list').click(function(event){
		event.stopPropagation();
	});
});
</script>
<script>
function change_status(id){
	$('#span_act_class_'+id).addClass('loading');
	var DataString="id="+id;
	$.ajax({
		type: "GET",
		url: "{% url 'admin_portal_news_provider_change_status' %}",
		data: DataString,
		success: function(data){
			if(data!=0){
				$('#span_act_class_'+id).removeClass('loading');
				if(data=='2'){
					$('#active_'+id).empty().html(gettext('Inctive'));
					$('#span_act_class_'+id).removeClass('icon-inactive-email');
					$('#span_act_class_'+id).addClass('icon-active-email');
				}else{
					$('#active_'+id).empty().html(gettext('Active'));
					$('#span_act_class_'+id).removeClass('icon-active-email');
					$('#span_act_class_'+id).addClass('icon-inactive-email');
				}
			}else{
				$('#span_act_class_'+id).removeClass('loading');
				show_msg(gettext('Oops!!! Not able to process your request.'),'e');
			}
		}
	});
}
</script>
{% endblock %}
				
				
				
				
				
				
				
				
				
				