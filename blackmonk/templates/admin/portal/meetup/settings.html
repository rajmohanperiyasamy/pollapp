{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load upload_tags %}
{% load get_example %}
{% block navigation %}
	{% activetab 'topnav' 'site' %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Meetup Details' %} {% endblock %}
{% block head %}
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
	<div id="admin-platform" class="group">
    	<div class="header-bar">
        	<div id="nav-roll">
            	<ul>
                	<li id="modules-index" class="first"><a href="{% url 'admin_portal' %}" style="z-index:9"><span class="icon"></span>{% trans 'Affiliate' %}</a></li>
                    <li><a href="{% url 'admin_portal_meetup_settings' %}" style="z-index:8">{% trans 'Meetup' %}</a></li>
				</ul>
			</div>
		</div>
		<div id="core-wraper" class="group">
        	<div class="admin-main col_12">
            	{% block leftnavigation %}
					{% activetab 'topnav' 'prog' %}
					{% activetab 'leftnav' 'meetup' %}
					{{ block.super }}
				{% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
					<div class="page-wrap">
                    	<div class="page-head br_0">
                            <h2>{% trans 'Meetup Details' %}</h2>
                            <p class="ltxt80">{% trans 'Meetup details for fetching data from' %} <a href="http://www.meetup.com/" target="_blank" rel="nofollow">{% trans 'meetup.com' %}</a></p>
                        </div>
						{% include 'admin/portal/meetup/include_settings.html' %}
	               	</div>
	         	</div>                       
	       	</div>                            
	       {% include 'admin/portal/meetup/settings-faq.html' %}                    
		</div>                                                    
	</div>
</div>
{% upload_js %}
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.jfp.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.fup.appln.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	$("#mform").validate({
		highlight: function(element, errorClass){$(element).parent('div').parent('div').addClass('field-error');$(element).addClass('error');},
		unhighlight: function(element, errorClass){$(element).parent('div').parent('div').removeClass('field-error');$(element).removeClass('error');},
		errorPlacement: function(error, element){},
	   	rules:{
	   			api_key:"required",
			    city:"required",
			    state:"required",
			    country:"required",
			    lat:"number",
			    lon:"number",
			    radius:"required",
				meta_title:"required",
				meta_description:"required",

	   	}
	});
	$('#url_validate_button').live("click",function(){
		var flag=$("#mform").validate().form();
		if(flag){
			var dataString='';
			dataString+='api_key='+encodeURIComponent($('#id_api_key').val());
			dataString+='&city='+encodeURIComponent($('#id_city').val());
		    dataString+='&zip='+encodeURIComponent($('#id_zip').val());
		    dataString+='&state='+encodeURIComponent($('#id_state').val());
		    dataString+='&country='+encodeURIComponent($('#id_country').val());
		    dataString+='&lat='+encodeURIComponent($('#id_lat').val());
		    dataString+='&lon='+encodeURIComponent($('#id_lon').val());
		    dataString+='&radius='+encodeURIComponent($('#id_radius').val());
			$.ajax({
				type:'post',
				url:'{% url 'admin_validate_meetup_api' %}',
				data:dataString,
				success:function(data){
					if(data=='1'){show_msg('API details specified is valid.','alert-success')}
					else{show_msg('Oops!!! API details specified is invalid.','alert-error')}
				}
			
			})
		}
	});
});
function save_settings(){
	var flag = $('#mform').validate().form();
	if(flag){
		var dataString='';
		dataString+='api_key='+encodeURIComponent($('#id_api_key').val());
		dataString+='&city='+encodeURIComponent($('#id_city').val());
	    dataString+='&zip='+encodeURIComponent($('#id_zip').val());
	    dataString+='&state='+encodeURIComponent($('#id_state').val());
	    dataString+='&country='+encodeURIComponent($('#id_country').val());
	    dataString+='&lat='+encodeURIComponent($('#id_lat').val());
	    dataString+='&lon='+encodeURIComponent($('#id_lon').val());
	    dataString+='&radius='+encodeURIComponent($('#id_radius').val());
		
		dataString+='&meta_title='+$('#id_meta_title').val();
		dataString+='&meta_description='+$('#id_meta_description').val();
		
		$('#basic-options').hide();
		$('#ajax_content_loading').show();
		$.ajax({
		type: "post",
		url: "{% url 'admin_portal_meetup_settings' %}",
		data: dataString,
		dataType:'json',
		success: function(data){
				show_msg(data.msg,data.mtype);
				$('#ajax_content_loading').hide();
				$('#basic-options').fadeIn(2500).html(data.html);
			}
		});
	}
}
</script>
{% endblock %}
				
				
				
				
				
				
				
				
				
				