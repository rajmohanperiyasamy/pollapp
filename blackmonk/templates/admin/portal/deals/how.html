{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load get_example %}
{% block navigation %}
	{% activetab 'topnav' 'site' %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Deals How it Works' %} {% endblock %}
{% block head %}
<link rel="stylesheet" href="{{STATIC_URL}}ui/css/colorbox.css" type="text/css" />
<script type="text/javascript" src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
<script type="text/javascript">
$(document).ready(function(){
	$('#master-check').click(function(){
		if($("#master-check").is(':checked')){$(".check-overflow").attr('checked',true);}
		else{$(".check-overflow").attr('checked',false);}
	});
	$('#master-check').click(function(){
		if($("#master-check").is(':checked')){
			$(".check-overflow").attr('checked',true);
			$('#mass_delete').removeClass('inactive');
			$('#mass_delete').addClass('active');
		}else{
			$(".check-overflow").attr('checked',false);
			$('#mass_delete').removeClass('active');
			$('#mass_delete').addClass('inactive');
		}
	});
	
	$(".check-overflow").click(function(){
		if ($(".check-overflow").is(':checked')){
			$('#mass_delete').removeClass('inactive');
			$('#mass_delete').addClass('active');
		}else{
			$('#mass_delete').removeClass('active');
			$('#mass_delete').addClass('inactive');
		}		
	});
});
</script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript">
function delete_how(ids){
	if(ids==0){
		var ids=[];
		$('.check-overflow').each(function(){
			if($(this).is(':checked')){
				ids.push($(this).val());
			}
		});
	}
	if(ids=='' || ids==null){
		alert(gettext('Please select step(s).'))
	}
	else{
		if(confirm(gettext('Are you sure want to delete seleced step(s) ?'))){
			$.ajax({
			type: "GET",
			url: "{% url 'admin_portal_deals_how_delete' %}",
			data: 'id='+ids,
			dataType:'JSON',
			success: function(data){
					if(data.status==1){
						try{
							$('#div_'+ids).remove();
						}catch(ex){}
						for(i=0;i<ids.length;i++){
							$('#div_'+ids[i]).remove();
						}
					}
					show_msg(data.msg,data.mtype);
				}
			});
		}
	}
}
</script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
	<div id="admin-platform" class="group">
    	<div class="header-bar">
        	<div id="nav-roll">
            	<ul>
                	<li id="modules-index" class="first"><a href="{% url 'admin_portal' %}" style="z-index:9"><span class="icon"></span>{% trans 'Modules' %}</a></li>
                    <li><a href="{% url 'admin_portal_deals' %}" style="z-index:8">{% trans 'Deals' %}</a></li>
                    <li><a href="{% url 'admin_portal_deals_how' %}" style="z-index:7">{% trans 'How it Works' %}</a></li>
				</ul>
			</div>
		</div>
		<div id="core-wraper" class="group">
        	<div class="admin-main col_12">
        		{% block leftnavigation %}
					{% activetab 'topnav' 'site' %}
					{% activetab 'leftnav' 'deals' %}
					{% activetab 'leftnavsub' 'deal_how' %}
					{{ block.super }}
				{% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
					<div class="page-wrap">
                    	<div class="page-head br_0">
                        	<h2>{% trans 'How it Works' %}</h2>
							<p class="ltxt80">{% trans "Try to add the steps which will explain the user to buy the deal." %}</p>
						</div>
                        <div id="article-categories" class="cat-list group">
                        <ul id="id_how_first">	
                        	<li class="cat-list-row" id="div_{{faq.id}}">
                                	<div class="cat-list-row-inner group">
                                        <div class="cat-list-column cat-name" style="width: 440px;"><h3>{% trans 'Description :' %} <span style="color:#666; font-weight:normal; font-size:11px;">{{ how_description.content|truncatewords:8 }}</span></h3></div>
                                        <div class="cat-list-column action-buttons">
                                        	<div class="group">
                                            	<!--a title="{% trans 'View Stats' %}" class="tttxt-n" href="#"><span class="icon icon-stats"></span></a-->
                                                <a href="{% url 'admin_portal_deals_update_dcrptn' %}?did=dcr" title="{% trans 'Update Description' %}" class="tttxt-n bm-add-gadget"><span class="icon icon-edit"></span></a>
                                            </div>                                                            
										</div>
									</div>
								</li> 
							</ul>	 
                        	<section class="toolbars">
                            	<div class="group">
                                	<ul class="toolbar left">
                                    	<li class="mas-check"><span class="checkbox-wrap tttxt-n" title="{% trans 'Select' %}">
										<span class="cform-checkbox-container"><input type="checkbox" id="master-check" name="master-check" class="master-check"><span class="cform-checkbox-element"></span></span>
										</span></li>  
                                        <li class="mas-delete"><a href="javascript:delete_how(0)" title="{% trans 'Delete' %}" id="mass_delete" class="tttxt-n inactive"><span class="icon icon-delete"></span></a></li>
									</ul>
                                    <span style="float:right">
                                    	<a href="javascript:void(0);" onclick="show_stp();" title="{% trans 'Add New Step' %}" class="btn-txt-inline-prime"><span class="btn-txt">{% trans 'Add New Step' %}</span></a>
									</span>
								</div>
							</section>
                            <ul class="cat-list-container" id="category">
                            	{% for hw in how %}
								<li class="cat-list-row" id="div_{{hw.id}}">
                                	<div class="cat-list-row-inner group">
                                    	<span class="checkbox-wrap">
											<span class="cform-checkbox-container"><input type="checkbox" id="category" value="{{hw.id}}" name="category" class="check-overflow"><span class="cform-checkbox-element"></span></span>
										</span>
                                        <div class="cat-list-column cat-name"><h3>{% trans 'Step' %} {{ forloop.counter }} : {{hw.heading}}</h3></div>
                                        <div class="cat-list-column action-buttons">
                                        	<div class="group">
                                            	<!--a title="{% trans 'View Stats' %}" class="tttxt-n" href="#"><span class="icon icon-stats"></span></a-->
                                                <a href="{% url 'admin_portal_deals_add_howit' %}?id={{hw.id}}" title="{% trans 'Update Step' %}{{ forloop.counter }}" class="tttxt-n bm-add-gadget"><span class="icon icon-edit"></span></a>
                                                <a title="{% trans 'Delete' %}" class="tttxt-n" href="javascript:delete_how({{hw.id}})"><span class="icon icon-delete"></span></a>
                                            </div>                                                            
										</div>
									</div>
								</li>  
								{% endfor %} 
								                                          
							</ul>                          
                    	</div>
                	</div>
            	</div>                       
            </div>                            
			{% include 'admin/portal/deals/how-it-faq.html' %}                          
		</div>                                                    
	</div>
</div>
<script>
	function show_stp(){
		var count = $(".cat-list-row").length;
		if(count<='5'){
			$.colorbox({width: "560",initialWidth: "560",href:"{% url 'admin_portal_deals_add_howit' %}", top:"5%",initialHeight: "200",title:gettext("Add New Step")});
		}else{
			alert(gettext("You can add only 5 steps !"))
		}
	}
	</script>
{% endblock %}
	