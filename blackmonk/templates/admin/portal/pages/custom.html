{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load get_example %}
{% block navigation %}
	{% activetab 'topnav' 'site' %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Pages |Custom Pages' %} {% endblock %}
{% block head %}
<script type="text/javascript">
function change_status(id){
  $('.dev_hide_list_status ul.dropdown-list').hide();
  $('span.status-inside').removeClass('active');
  $('#id_change_status_ul_'+id).toggle();
  $('#id_change_status_span_'+id).toggleClass('active');
}
function save_status(id){
    $('#id_change_status_span_icon_'+id).addClass('loading');
    var DataString="id="+id;
    var url = '{% url 'admin_custom_page_status' %}';
    $.ajax({
        type: "GET",
        url: url,
        data: DataString,
        dataType:'JSON',
        success: function(data){
            if(data.success){
                $('#id_change_status_span_icon_'+id).removeClass('loading');
                $('#id_change_status_span_icon_'+id).removeClass('icon-active-user icon-inactive-user').addClass(data.status_class);
                $('#id_change_status_ul_'+id).hide();
                $('#id_change_status_span_'+id).removeClass('active');
                $('#id_change_status_text_'+id).text(gettext(data.status_text));
            }else{
                show_msg(gettext('Oops!!! Not able to process your request.'),'alert-error');
            }
        }
    });                 
}
</script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
	<div id="admin-platform" class="group">
    	<div class="header-bar">
        	<div id="nav-roll">
            	<ul>
					<li id="modules-index" class="first"><a href="{% url 'admin_home' %}" style="z-index:9"><span class="icon"></span>{% trans 'DashBoard' %}</a></li>
                	<li><a href="{% url 'admin_custom_page' %}" style="z-index:8"><span class="icon"></span>{% trans 'Custom Pages' %}</a></li>
				</ul>
			</div>
		</div>
		<div id="core-wraper" class="group">
        	<div class="admin-main col_12">
        		{% block leftnavigation %}
					{% activetab 'leftnav' 'pages' %}
					{% include 'admin/portal/pages/left-navigation.html'%}
					{{ block.super }}
				{% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
					<div class="page-wrap">
                    	<div class="page-head br_0">
                        	<h2>{% trans 'Custom Pages' %}</h2>
							<p class="ltxt80">{% trans 'Add/Update static pages of your website. Eg: Terms and conditions, Disclaimer and About Us.' %}</p>
						</div>
                        <div id="custom_page" class="cat-list group">
                        	<section class="toolbars">
                            	<div class="group">
                                    <span style="float:right">
                                    	<a href="{% url 'edit_resources' 0 %}" title="{% trans 'Add New Page' %}" class="btn-txt-inline-prime"><span class="btn-txt">{% trans 'Add New Page' %}</span></a>
									</span>
								</div>
							</section>
                            <ul class="cat-list-container" id="category">
                            	{% for page in custom_pages %}
								<li class="cat-list-row" id="div_{{page.id}}">
                                	<div class="cat-list-row-inner group">
                                        <div class="cat-list-column cat-name"><h3><a href="/{{page.slug}}.html">{{page}}</a></h3></div>
                                        <div class="cat-list-column action-buttons">
                                        	<div class="group">
                                                <a href="{% url 'edit_resources' page.id %}" title="{% trans 'Update Page' %}" class="tttxt-n"><span class="icon icon-edit"></span></a>
                                                <a onclick="delete_page('{{page.id}}');" href="javascript:void(0)" title="{% trans 'Delete Page' %}" class="tttxt-n"><span id="icon_{{page.id}}" class="icon icon-delete"></span></a>
                                            </div> 
										</div>
										<div class="cat-list-row-inner group member-status" style="float:right;margin-right:10px;padding-top:4px;">
							                <div class="relative-block dev_hide_list_status" onclick="change_status({{page.id}});" id="id_change_status_div_{{page.id}}">
							                    <span class="status-inside inline-block" id="id_change_status_span_{{page.id}}"><span class="inline-block status-idty {% if page.is_active %}icon-active-user{% else %}icon-inactive-user{% endif %}" id="id_change_status_span_icon_{{page.id}}"></span><span class="arrow"></span></span>
							                    <ul class="dropdown-list" id="id_change_status_ul_{{page.id}}">
							                        <li><strong>{% trans 'Update status to...' %}</strong></li>
							                        <li><a href="javascript:void(0)" id="id_change_status_text_{{page.id}}" onclick="save_status({{page.id}});">{% if page.is_active %}{% trans 'Inactive' %}{% else %}{% trans 'Active' %}{% endif %}</a></li>
							                    </ul>  	 
							                </div>                                                     
										</div>
							            </div>
								</li>  
								{% endfor %}
							</ul>
                    	</div>
                	</div>
            	</div>                       
            </div>                            
			 {% include 'admin/portal/pages/faq.html' %}                                   
		</div>                                                    
	</div>
</div>
<script type="text/javascript">
function delete_page(page_id){
	$("#icon_"+page_id).addClass("icon-loading");
	$.ajax({    
		type:		"post",
		url: 		'{% url 'admin_custom_page_delete' %}',
	    data:   	"page_id="+page_id,
	    dataType: 	"json",
	    success: 	function( result ) {
						if(result.status == 1){
							$("#div_"+page_id).hide();
							show_msg("The custom page has been deleted successfully.", "alert-success");
						}
						else{
							show_msg("Cannot process your request, try again later.", "alert-error");
							$("#icon_"+page_id).removeClass("icon-loading");
						}
	    			},
	    error:		function( result ) {
	    				show_msg("Cannot process your request, try again later.", "alert-error");
						$("#icon_"+page_id).removeClass("icon-loading");
	    			}
  	});
};
</script>
{% endblock %}