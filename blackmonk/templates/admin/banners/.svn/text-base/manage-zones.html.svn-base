{% extends "admin/admin_base.html" %}
{% load tabs %}
{% load i18n %}
{% load get_example %}
{% block navigation %}
    {% activetab 'topnav' 'config' %}
    {{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Banner Ads Zones' %} {% endblock %}
{% block head %}
<link rel="stylesheet" href="{{STATIC_URL}}ui/css/colorbox.css" type="text/css" />
<script type="text/javascript" src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('#master-check').click(function(){
        if($("#master-check").is(':checked')){$(".check-overflow").attr('checked',true);}
        else{$(".check-overflow").attr('checked',false);}
    });
});
</script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript">
function txtarealimit(txtobj,len){
    var txtvalue = txtobj.value;
    var the_len = txtvalue.length;
    if (the_len > len){
        txtobj.value = txtvalue.substring(0,len);
    }
    txtobj.scrollTop=txtobj.scrollHeight;
}
function save_banner_zone(){
    var flag = $('#mform').validate().form()
    var id=0;
    var url = $('#mform').attr('action');
    if(flag==true){
        var dataString='name='+encodeURIComponent($('#id_name').val());
        dataString+='&slot='+encodeURIComponent($('#id_slot').val());
        dataString+='&height='+encodeURIComponent($('#id_height').val());
        dataString+='&width='+encodeURIComponent($('#id_width').val());
        var modules = String($('#id_sections').val()).split(',');
        for(i=0;i<modules.length;i++){
            dataString+='&sections='+modules[i];
        }
        $('#ajax_content').hide();
        $('#ajax_content_loading').show();
        $.ajax({
        type: "POST",
        url: url,
        data: dataString,
        dataType:'JSON',
        success: function(data){
                if(data.status){
                   $('#ajax_content_loading').html(data.msg);             
                   $('#id_list_banner_zones').empty().append(data.html);
                   $('.update_zone_link').colorbox({width: "560",initialWidth: "560", top:"0", initialHeight: "200"}); 
                   setTimeout(function(){$('#ajax_content').fadeIn(300);$.colorbox.close();show_msg(gettext(data.msg),data.mtype);},500);             
                }
                else{
                     $('#ajax_content').empty().html(data.html);
                     $('.modal-form .select-menu').chosen({disable_search_threshold:10});
                     $('.field-group [title]').tipsy({trigger: 'focus', gravity: 'w',ftip:true});
                     setTimeout(function(){$('#ajax_content_loading').hide();$('#ajax_content').fadeIn(2000);$.colorbox.resize();},1000);
                }                
            }
        });
    }
}
function delete_zone(ids){
    if(ids==0){
        var ids=[];
        $('.check-overflow').each(function(){
            if($(this).is(':checked')){
                ids.push($(this).val());
            }
        });
    }
    if(ids=='' || ids==null){
        alert(gettext('Please select zone(s).'))
    }
    else{
        if(confirm(gettext('Are you sure want to delete selected zone(s) ?'))){
            $.ajax({
            type: "GET",
            url: "{% url 'admin_configuration_banners_delete_banner_zone' %}",
            data: 'id='+ids,
            dataType:'JSON',
            success: function(data){
                    if(data.status){
                        try{
                            $('#div_'+ids).remove();
                        }catch(ex){}
                        for(i=0;i<ids.length;i++){
                            $('#div_'+ids[i]).remove();
                        }
                    }
                    show_msg(data.msg,data.mtype);
                }
            });
        }
    }
}
</script>
{% endblock %}
{% block content %}
<div id="admin_wrapper">
    <div id="admin-platform" class="group">
        <div class="header-bar">
            <div id="nav-roll">
                <ul>
                    <li id="config-index" class="first"><a href="{% url 'admin_configuration' %}" style="width:120px;z-index:9"><span class="icon"></span>{% trans 'Settings' %}</a></li>
                    <li><a href="{% url 'admin_configuration_mange_banner_zones' %}" style="z-index:8">{% trans 'Banner Ads' %}</a></li>
                    <li><a style="z-index:7">{% trans 'Zones/Types' %}</a></li>
                </ul>
            </div>
        </div>
        <div id="core-wraper" class="group">
            <div class="admin-main col_12">
                {% block leftnavigation %}
                    {% activetab 'topnav' 'config' %}
                    {% activetab 'leftnav' 'banners' %}
                    {% activetab 'leftnavsub' 'banner-zones' %}
                    {{ block.super }}
                {% endblock %}
                <div class="left-nav-list-bg"></div>
                <div class="col_9 mr_0">
                    <div class="page-wrap">
                        <div class="page-head br_0">
                            <h2>{% trans 'Zones/Types' %}</h2>
                            <p class="ltxt80">{% trans "Try to add the category that best fits in the article module. For example: 'Health & Wellness'." %}</p> 
                        </div>
                        <div id="article-categories" class="cat-list group">
                            <section class="toolbars">
                                <div class="group">
                                    <ul class="toolbar left">
                                        <li class="mas-check">
                                            <span class="checkbox-wrap tttxt-n" title="{% trans 'Select' %}">
                                                <span class="cform-checkbox-container"><input type="checkbox" id="master-check" name="master-check" class="master-check"><span class="cform-checkbox-element"></span></span>
                                            </span>
                                        </li>  
                                        <li class="mas-delete"><a href="javascript:delete_zone(0)" title="{% trans 'Delete' %}" class="tttxt-n inactive"><span class="icon icon-delete"></span></a></li>
                                    </ul>
                                    <span style="float:right">
                                        <a href="{% url 'admin_configuration_banners_add_zone' %}" title="{% trans 'Add New Zone' %}" class="btn-txt-inline-prime bm-add-gadget"><span class="btn-txt">{% trans 'Add New Zone' %}</span></a>
                                    </span>
                                </div>
                            </section>
                            <ul class="cat-list-container" id="id_list_banner_zones">
                                {% include 'admin/banners/include-banner-zones.html' %}                                        
                            </ul>                          
                        </div>
                    </div>
                </div>                       
            </div>                            
            {% include 'admin/banners/banner-zones-faq.html' %}                            
        </div>                                                    
    </div>
</div>
{% endblock %}
