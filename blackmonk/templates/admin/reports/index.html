{% extends "admin/admin_base.html" %}
{% load tabs %}
{% block navigation %}
    {% activetab 'topnav' 'report' %}
    {{ block.super }}
{% endblock %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}themes/green/css/LE_MetaId99.css">
<style>
#counttable td {width: 100px;}
//.title td{font-weight: bold;}
</style>
<div id="content">
<div class="group">
    
    <div id="staff_wrapper" class="admin-main col_12">
        
        <form action="" id="filter_form" method="get">
            <div class="aCtV">
                <h2>Site Report</h2>
            </div>
            <div class="aCtV wHt bDrB">
                <div class="ib">
                    <span class="cform-radio-container">
                        <input type='radio' class="aLgN cform-checkbox" value='all' onclick="$('#filter_form').submit()" {% if usergroup == 'all' %}checked{% endif %} name='usergroup' onclick="$('#useremail').attr('disabled','disabled');">
                        <span class="cform-radio-element"></span>
                    </span>
                    <span class="aLgN"> All User</span>
                    <span class="cform-radio-container">
                        <input type='radio' class="aLgN cform-checkbox" value='staff' onclick="$('#filter_form').submit()" {% if usergroup == 'staff' %}checked{% endif %} name='usergroup' onclick="$('#useremail').attr('disabled','disabled');">
                        <span class="cform-radio-element"></span>
                    </span>
                    <span class="aLgN"> Staff Activities</span>
                    <span class="cform-radio-container">
                        <input type='radio' class="aLgN cform-checkbox" value='user' onclick="$('#filter_form').submit()" {% if usergroup == 'user' %}checked{% endif %} name='usergroup' onclick="$('#useremail').attr('disabled','disabled');">
                        <span class="cform-radio-element"></span>
                    </span>
                    <span class="aLgN"> User Activities</span>
                    <span class="cform-radio-container">
                        <input type='radio' class="aLgN cform-checkbox" value='singleuser' {% if usergroup == 'singleuser' %}checked{% endif %} name='usergroup' onclick="$('#useremail').removeAttr('disabled');">
                        <span class="cform-radio-element"></span>
                    </span>
                    <span class="aLgN"> Selected User</span>
                </div>
                <!-- div id="date_label" class="btn-group right bm-report fLtR">
                    <a id="Day" href="#" class="">
                        <span>Day</span>
                    </a>
                    <a id="2day" href="#" class="">
                        <span>2 Day</span>
                    </a>
                    <a id="Week" href="#" class="first active">
                        <span>Week</span>
                    </a>
                    <a id="Month" href="#" class="last">
                        <span>Month</span>
                    </a>
                    <a id="Year" href="#" class="last">
                        <span>Year</span>
                    </a>
                </div -->
             </div>
            <div class="aCtV wHt pDt2">
             <input type="text" class="fTwT" id="useremail" name="useremail" value="{% if useremail %}{{useremail}}{% endif %}" placeholder='select user' {% if usergroup != 'singleuser' %}disabled="disabled"{% endif %}>
             <input type="text" id="id_start_date" readonly="readonly" autocomplete="off"  class="tXt-aReA mRl10" placeholder="Start Date" name="startdate" value="{{startdate}}"><img alt="" src="/static/ui/images/icons/b/70.png" class="fd-icon">
             <input type="text" id="id_end_date" readonly="readonly" class="tXt-aReA" autocomplete="off" placeholder="End Date" name="enddate" value="{{enddate}}"><img alt="" src="/static/ui/images/icons/b/70.png" class="fd-icon">
             <input type="hidden" id="filter_module" name="module" value="{{module}}">
             <input type="hidden" id="filter_status" name="status" value="{{status}}">
             <input type="hidden" id="page" name="page" value="{{page}}">
             <button type="submit" class="btn-txt-blue"  style="height: 27px; margin-left: 10px;">
             <span class="cform-button-text">Load Results</span></button>
           </div>
        </form>
<div class="pD15">
    <table id="counttable">
        <tr class="title tXt-cTr tXt-tRf bDrL">
            <td class="tXt-lFt tDt">module</td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'all' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('all');$('#filter_form').submit();"{% endif %}>total (all)</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'drafted' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('drafted');$('#filter_form').submit();"{% endif %}>drafted</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'pending' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('pending');$('#filter_form').submit();"{% endif %}>pending</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'published' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('published');$('#filter_form').submit();"{% endif %}>published</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'rejected' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('rejected');$('#filter_form').submit();"{% endif %}>rejected</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'blocked' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('blocked');$('#filter_form').submit();"{% endif %}>blocked</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'expired' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('expired');$('#filter_form').submit();"{% endif %}>expired</a></td>
            <td class="tDt"><a href="javascript: void(0);" {% if module %}{% if status == 'scheduled' %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('scheduled');$('#filter_form').submit();"{% endif %}>scheduled</a></td>
        </tr>
    {% for item in content_counts %}
        {% for itemcount in item.count %}<tr class="bDrL">
            <td rowspan="" class="tXt-tRf"><a href="javascript: void(0);" {% if item.modulename == module %}style="color: #AF50D9;font-weight: bold;"{% endif %} onclick="$('#page').val('1');$('#filter_status').val('all');$('#filter_module').val('{{item.modulename}}');$('#filter_form').submit();">{{item.modulename}}</a></td>
            <td class="tnMbr">{{itemcount.total}}</td>
            <td class="tnMbr">{{itemcount.drafted}}</td>
            <td class="tnMbr">{{itemcount.pending}}</td>
            <td class="tnMbr">{{itemcount.published}}</td>
            <td class="tnMbr">{{itemcount.rejected}}</td>
            <td class="tnMbr">{{itemcount.blocked}}</td>
            <td class="tnMbr">{{itemcount.expired}}</td>
            <td class="tnMbr">{{itemcount.scheduled}}</td>
        </tr>{% endfor %}
    {% endfor %}
    </table>
</div>
{% if object_list %}
<div class="cat-list group pD15" id="member-account-list">
  <div id="id_users_listing"> 
    <h5 class="mRb6 tXt-tRf">{{status}} {{module}} listing ({{object_count}})</h5>
    <a href="javascript: void(0);" onclick="$('#page').val('1');$('#filter_module').val('{{item.modulename}}');$('#member-account-list').hide();" style="margin-top: -23px; float: right;">clear listing</a>
    <ul class="cat-list-container">
        <li class="cat-list-row hdr-rw">
            <div class="cat-list-row-inner group pDb0">
                <div class="cat-list-column member-login mRl10">
                    title                                                
                </div>
                <div class="cat-list-column member-display-name wTh">
                    created on
                </div>
                <div class="cat-list-column member-display-name wTh">
                    created by
                </div>
                <div class="cat-list-column member-display-name wTh">
                    visits
                </div>
                <div class="cat-list-column member-display-name wTh">
                    status
                </div>
                <!--
                <div class="action-buttons">
                </div>
                <div class="member-status">
                </div>
                -->                                                
            </div>
        </li> 
        {% for obj in object_list %}
        <li id="" class="cat-list-row bm-profile-list">
        <span class="checkbox-wrap">
            <span class="cform-checkbox-container"><input type="checkbox" class="check-overflow cbox" name="artCulture" id="id_user_action" value="3"><span class="cform-checkbox-element"></span></span>
        </span>
        
            <div class="cat-list-row-inner group">
                <div class="cat-list-column member-login mRl10">
                    <a class="" title="Profile Information" href="">
                        <h5 class="username">{{obj|truncatechars:24}}</h5>
                        <span title="someone@gmail.com" class="email">{{obj.created_by.useremail}}</span>
                    </a>                                                    
                </div>
                <div class="cat-list-column member-last-login wTh">
                    <span class="time">{{obj.created_on|date:'M d'}}</span>
                </div>
                <div class="cat-list-column member-last-login wTh">
                    <span class="time">{{obj.created_by}}</span>
                </div>
                <div class="cat-list-column member-last-login wTh">
                    <span class="time">{{obj.get_visits}}</span>
                </div>
                <div class="cat-list-column member-last-login wTh">
                    <div class="member-status pLlT">
                        <div id="" class="">
                            <span id="" class="status-inside wHt bX-sHdW bDr0 inline-block">
                                <span id="" class="status-idty tttxt left {{obj.status}} icon-{% if obj.status == 'D' %}drafted{% elif obj.status == 'N' %}pending{% elif obj.status == 'P' %}published{% elif obj.status == 'R' %}rejected{% elif obj.status == 'B' %}blocked{% elif obj.status == 'E' %}expired{% elif obj.status == 'S' %}scheduled{% endif %} bDrD3" title="{% if obj.status == 'D' %}Drafted{% elif obj.status == 'N' %}Pending{% elif obj.status == 'P' %}Published{% elif obj.status == 'R' %}Rejected{% elif obj.status == 'B' %}Blocked{% elif obj.status == 'E' %}Expired{% elif obj.status == 'S' %}Scheduled{% endif %}"></span>
                            </span>    
                        </div>                                                     
                    </div> 
                </div>
                                                               
            </div>
        </li> 
        {% endfor %}
    </ul>
  </div>
  {% include 'admin/reports/listing_pagination.html' %} 
</div>
{% endif %}
</div>
</div>
</div>
<script type="text/javascript" src="{{STATIC_URL}}ui/js/jquery.ui.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/jquery/jquery.ui.datepicker.js"></script>
<script>
$(document).ready(function(){
    {% if object_list %}
        var scrollTop = $('#member-account-list').offset().top;
        $('html,body').animate({ scrollTop: scrollTop - 65}, 'slow');
    {% endif %}
    $( "#useremail" ).autocomplete({
        source: '{% url 'auto_suggest_user' %}',
    });
    if($("#id_start_date").length){
        $("#id_start_date").datepicker({ dateFormat: "dd/mm/yy",maxDate: new Date(),
            onSelect: function(){
                enddate = $(this).val();
                splittedval = enddate.split('/');
                var date = new Date(splittedval[2], splittedval[1]-1, splittedval[0]);
                date.setDate(date.getDate() + 1);
                $("#id_end_date").datepicker( "option", "minDate", date );
            }
        });
    }
    if($("#id_end_date").length){
    	var tomorrow = new Date();
    	tomorrow.setDate(tomorrow.getDate() + 1);
        $("#id_end_date").datepicker({ dateFormat: "dd/mm/yy",maxDate: tomorrow});
    }
});
</script>
{% endblock %}