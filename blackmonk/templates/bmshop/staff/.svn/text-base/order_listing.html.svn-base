{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% block navigation %}
	{% activetab "selmodule" "bm_shop" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Order History' %} {% endblock %}
{% block content %}
<div id="staff-platform" class="group">
  	<div class="header-bar"><h2>{% trans 'Orders' %}</h2></div>
	<div id="core-wraper" class="group">
    	<div class="staff-main">
          	<div class="page-wrap">
				<div id="transaction-history" class="cat-list group">
                    <section class="toolbars" style=" background:none; border:none; padding:10px 0;">
                    <div class="group">
                    	<div class="inline-block" style="width:380px">
                        	<label for="" style="color:#AAA; padding:5px 8px 0 0;float:left">View: </label>
							<input type="hidden" id="filter" value="{% if filter %}{{filter}}{% endif %}">
                            <select onchange="filter($(this).val());" id="orderSelect" dataplaceHolder="Filter By" class="select-menu" style="width:160px;" onchange="$('#id_view_by').val($(this).val()),filter_content();">
							  <option value="">{% trans 'All' %}</option>
							   <optgroup label="{% trans 'Payment Gateway' %}">
								   <option {% if filter == 'PP' %}selected="selected"{% endif %} value="PP">{% trans 'PayPal' %}</option>
								   <option {% if filter == 'GC' %}selected="selected"{% endif %} value="GC">{% trans 'GoogleCheckout' %}</option>
							   </optgroup>
							   <optgroup label="{% trans 'Status' %}">
								   <option {% if filter == '1' %}selected="selected"{% endif %} value="1">{% trans 'Paid' %}</option>
								   <option {% if filter == '0' %}selected="selected"{% endif %} value="0">{% trans 'Not Paid' %}</option>
								   <option {% if filter == '4' %}selected="selected"{% endif %} value="4">{% trans 'Pending' %}</option>
								</optgroup>
                            </select> 
                        </div>
                    	<div class="right">
                            <form class="search-items module-search" id="member-search-form" action="javascript:void(0);">
                            	<input type="hidden" id="id_search" value="{% if search %}true{% endif %}">
								<div class="inline-block relative-block" style="position:absolute;">
									<span onclick="clear_search();" class="reset txt-button tttxt" id="close_search" title="{% trans 'Clear Search' %}" style="{% if not search %}display:none;{% endif %}">Clear search</span>
								</div>
                                <input type="text" class="search-field" value="{% if search %}{{search}}{% endif %}" name="search_keyword" placeholder="{% trans 'Search Order Number' %}" id="id_search_keyword">
                                <button type="button" class="cform-button search-button" onclick="if($('#id_search_keyword').val()!=''){sort_search();}" role="button"><span class="search-icon">Search</span></button>
                            </form>                                                
						</div>
                       
                    </div>
                </section>
				<div id="content_ajax_loading" style="display:none;">
					<ul class="cat-list-container">
					    <li class="cat-list-row hdr-rw">
					        <div class="cat-list-row-inner group">
					            <div class="cat-list-column transaction-id">
					            	{% trans 'Order No.' %}                                                
					            </div>
					            <div class="cat-list-column transaction-status">
					            	{% trans 'Status' %}
					            </div>
					            <div class="cat-list-column transaction-date">
					            	{% trans 'Date' %}
					            </div>
					            <div class="cat-list-column transaction-amount">
					            	{% trans 'Amount' %}
					            </div>
					            <div class="cat-list-column transaction-account">
					            	{% trans 'Customer' %}
					            </div>
					            <div class="cat-list-column transaction-system">
					            	{% trans 'Payment Method' %}
					            </div>
							</div>
						</li>
					</ul>
					<div style="text-align:center; padding-top:75px;">
						<img src="{{STATIC_URL}}ui/images/global/loading-s.gif"></p>
					</div>
				</div>     
				<div id="content_ajax">
					{% include 'bmshop/staff/ajax_order_listing.html' %}    
				</div>   
            </div> <!-- end table -->
          </div>  <!-- end page wrap -->
    </div>  <!-- end main-col -->                            
    <div id="aside" class="side-bar">
    	<ul class="side-navigation">
            <li><a href="{%url 'staff_bmshop_product_list' %}">{% trans 'Product' %}</a></li>
			<li><a href="{%url 'staff_bmshop_group_property_list' %}">{% trans 'Property Group' %}</a></li>
            <li><a href="{%url 'staff_bmshop_property_list' %}">{% trans 'Property' %}</a></li>
            <li><a href="{%url 'staff_bmshop_varients_list' %}">{% trans 'Variants' %}</a></li>
            <li class="active"><a href="javascript:void(0)">Orders</a></li>
        </ul>
        {#% include 'payments/staff/faq.html' %#}                                    
    </div>                            
</div>
</div>
{% endblock %}			
{% block footer_include %}
<script type="text/javascript">
function filter(value){
	$('#filter').val(value);
	var dataString="&filter="+value;
	if($('#id_search').val()=='true'){dataString+="&search="+$('#id_search_keyword').val();}
	$('#content_ajax').css('opacity','0.5');
	$.ajax({
		type: "GET",
		url: '{% url 'staff_bmshop_ajax_payment_orders' %}',
		data: dataString,
		success: function(data){
			
			$('#content_ajax').css('opacity','0');
			$('#content_ajax').empty().html(data);
			$('#content_ajax').css('opacity','1');
			
		}
	});
}
function sort_search(){
	$('#close_search').show();
	$('#id_search').val('true');
	var dataString="&search="+$('#id_search_keyword').val();
	if($('#filter').val()!=''){dataString+="&filter="+$('#filter').val();}
	$('#content_ajax').css('opacity','0.5');
	$.ajax({
		type: "GET",
		url: '{% url 'staff_bmshop_ajax_payment_orders' %}',
		data: dataString,
		success: function(data){
			$('#content_ajax').css('opacity','0');
			$('#content_ajax').empty().html(data);
			$('#content_ajax').css('opacity','1');
		}
	});
}
function goto_list(page){
	var dataString='page='+page;
	if($('#filter').val()!=''){dataString+="&filter="+$('#filter').val();}
	if($('#id_search').val()=='true'){dataString+="&search="+$('#id_search_keyword').val();}
	$('#content_ajax').css('opacity','0.5');
	$.ajax({
		type: "GET",
		url: '{% url 'staff_bmshop_ajax_payment_orders' %}',
		data: dataString,
		success: function(data){
			$('#content_ajax').css('opacity','0');
			$('#content_ajax').empty().html(data);
			$('#content_ajax').css('opacity','1');
		}
	});
}
function clear_search(){
	$('#id_search').val('');
	$('#id_search_keyword').val('');
	$('#close_search').hide();
	filter($('#filter').val());
}
function change_delivery_staus(id){
	
	$('#delivery_status_'+id).hide();
	$('#d_status_btn_'+id).hide();
	$('#ajax_loading_'+id).show();
	$.ajax({
		type: "GET",
		url: '{% url 'staff_bmshop_chane_delivery_status' %}',
		data: 'id='+id,
		dataType:'JSON',
		success: function(data){
			if(data.status){
				$('#ajax_loading_'+id).hide();
				$('#delivery_status_'+id).empty().html(data.html);
				$('#delivery_status_'+id).show();
			}	
		}
	});
	
}

</script>
{% endblock %}	
				