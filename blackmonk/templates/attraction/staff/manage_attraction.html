{% extends "staff_base.html" %}
{% load tabs %}
{% block navigation %}
	{% activetab "selmodule" "attraction" %}
	{{ block.super }} 
{% endblock %}
{% block pagetitle %}Manage Attraction{% endblock %}
{% block head %}
<script type="text/javascript">
function atr_action(id){
	var ids=[];
	var action=$(id).val();
	$(".cbox").each(function(){
		if($(this).attr('checked')){
			ids.push($(this).val());
		}
	});
	if(action!="#" && ids !=""){
		if(confirm('Are you sure you want to proceed ?')){
			window.location.replace('{% url 'staff_bulk_action_attraction' %}?page={{page}}&action='+action+'&ids='+ids);
		}else{return false;}
	}
	if(ids ==""){
		alert('Please choose attraction for more action.');
	}
}
function atr_filter(id){
	filter=$(id).val();
	if(filter!="#"){
		if(filter=="F1"){
			window.location.replace('{% url 'staff_manage_attraction' %}?filter=1&featured=True');
		}
		else if(filter=="F0"){
			window.location.replace('{% url 'staff_manage_attraction' %}?filter=0&featured=True');
		}
		else{
			window.location.replace('{% url 'staff_manage_attraction' %}?filter='+filter);
		}
	}
}
</script>
{% endblock %}
{% block content %}
<div class="page_title group" style="display:block; overflow:hidden; padding:10px 0 20px 0;">
	<div class="bread-crumb clearfix">
        <ul>
            <li><a href="/staff/" style="background:#666;font-size:12px; padding:2px 4px; -moz-border-radius:4px;color:#FFF">Staff Home</a></li>
            <li style="background:#eee;font-size:12px; padding:2px 4px; -moz-border-radius:4px;color:#666">Manage Attraction</li>
        </ul>
    </div> 
</div>
<div class="main" style="margin-bottom:20px;">
	<div class="main_col" style="float:left; width:920px;">
		{% if msg %}
			<div style="clear:both;"></div>
			 <div class="message" id="id_m">
			 	{{ msg }}
				<script type="text/javascript">
    	    		setTimeout('$("#id_m").fadeOut()',5 * 1000); //5 sec
    	    	</script>
			 </div>
		{% endif %}
		<div class="page_title group" style="display:block; overflow:hidden; padding-top:10px;">
    		<div class="all_control">
                <select name="attraction_action" id="attraction_action" class="textField small" style="width:170px;" onchange="atr_action(this);">
                   <option value="#">More Action</option>
				   <option value="1">Activate</option>
				   <option value="0">Deactivate</option>
				   <option value="F1">Feature</option>
				   <option value="F0">Non Feature</option>
				   <option value="D">Delete</option>
				   
                </select>  
  			</div>	
			<div class="all_control">
                <select name="attraction_filter" id="attraction_filter" class="textField small" style="width:170px;" onchange="atr_filter(this);">
                   <option value="#">Filter By</option>
				   <option value="name" {% if filter == 'name' %}selected="selected"{% endif %}>By Name</option>
				   <option value="1" {% if filter == '1' and not featured %}selected="selected"{% endif %}>Active</option>
				   <option value="0" {% if filter == '0' and not featured %}selected="selected"{% endif %}>InActive</option>
				   <option value="F1" {% if filter == '1' and featured %}selected="selected"{% endif %}>Featured</option>
				   <option value="F0" {% if filter == '0' and featured %}selected="selected"{% endif %}>Not Featured</option>
                </select>  
  			</div>	
			<div class="all_control" style="width:300px;">
				<form action="{% url 'staff_manage_attraction' %}">
					<input type="text" name="q" id="q" style="padding:2px;border:solid 1px #aaa;" value="{%if q %}{{q}}{% endif %}">
					<input type="submit" value="Search" class="inputsubmit on">
				</form>
			</div>	
			<div class="quick_nav">
                <a href="{% url 'staff_add_attraction' %}" class="thick_link_plus">Add an Attraction</a>
            </div>
		 </div>                           
		<table class="staff content" align="center" cellspacing="0" cellpadding="0" width="920">
			<colgroup>
				<col width="15">
				<col width="300">                            
				<col width="300">
				<col width="180">
				<col width="100">
			</colgroup>				
			<tbody>
				<tr class="head">
					<th class="check"><input name="selectall"  id="id_bus_cb" type="checkbox"></th>
					<th class="thumb"><div>Name</div></th>                                
					<th class="thumb"><div>Venue/Posted Details</div></th>
					<th class="company"><div>Status</div></th>
					<th class="action" style="text-align:left;"><div>Actions</div></th>
				</tr>					
				<form action="" id="id_form_action" method="post" name="id_form_action">{% csrf_token %}
				<input type="hidden" name="bus_action" id="id_bus_action">
				{% for attraction in attractions %}
				<tr class="row">
					<td class="check" style="padding-top:22px">
						<input class="cbox" name="trashchecked" value="{{attraction.id}}" type="checkbox">
					</td>
                    <td class="thumb">
                        <a href="javascript:void(0)">
                        	{{attraction.name}}
                        </a>
					</td>                                
					<td class="company">
						<div class="comp-details">
							<h5><a href="javascript:void(0)">{{ attraction.venue }}</a></h5>
							<p style="padding-top:3px;">
								On <span style="color:#666; padding-right:5px; border-right:1px solid #ccc; margin-right:5px;">
								{{ attraction.created_on|date:"M d Y H:i a" }}</span>By 
								<a href="javascript:void(0)">{{ attraction.created_by }}</a>
							</p>											
						</div>
					</td>
					<td class="status">
						<div>
							{% if attraction.is_active %}
							<h5><a href="{% url 'staff_change_status_attraction' %}?id={{attraction.id}}&page={{page}}" onclick="if(!confirm('Are you sure you want to Inactivate this attraction?')){return false;}" style="color:#2B5B0E;">Active</a></h5>
							 {% else %}
							 <h5><a href="{% url 'staff_change_status_attraction' %}?id={{attraction.id}}&page={{page}}" style="color:#ff0000;">InActive</a></h5>
							 {% endif %}
						</div>
					</td>
					<td class="action">
						<div class="action_link">
							<div class="action_nav">
							<span>
								<a href="{% url 'staff_edit_attraction' %}?id={{attraction.id}}&page={{page}}" class="edit">Edit</a>&nbsp;|&nbsp;<a href="{% url 'staff_seo_attraction' %}?id={{attraction.id}}&page={{page}}" class="seo">SEO</a>&nbsp;|&nbsp;<a href="{% url 'staff_delete_attraction' %}?id={{attraction.id}}&page={{page}}" onclick="if(!confirm('Are you sure you want to delete this attraction?')){return false;}" class="delete">Delete</a>
							</span>
							{% if attraction.is_featured %}
								<a onclick="if(!confirm('Are you sure want to proceed ?')){return false;}" href="{% url 'staff_change_feature_status_attraction' %}?id={{attraction.id}}&page={{page}}" style="background-color:	#696565;padding:4px 20px;border-radius:3px;color:#fff; text-decoration:none; font-weight:bolder;">
								 Featured</a>
							{%else%}
							<a href="{% url 'staff_change_feature_status_attraction' %}?id={{attraction.id}}&page={{page}}" style="background-color:	#aaaaaa;padding:4px 5px;border-radius:2px;color:#fff; text-decoration:none; font-weight:bolder;">
								List as Feature</a>
							{%endif%}		
							</div>
						</div>
					</td>
				 </tr>
				{% endfor %}
			</form>	 															
			</tbody>
		</table>
		{% include 'attraction/staff/pagenation.html' %}
	</div> 
    <hr/>
</div>
{% endblock %}