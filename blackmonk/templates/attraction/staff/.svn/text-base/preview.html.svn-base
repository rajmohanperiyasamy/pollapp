{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% load thumbnail %}
{% load truncate_filter %}
{% block navigation %}
	{% activetab "selmodule" "attraction" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Preview - Attraction' %} {% endblock %}
{% block head %}
{% endblock %}
{% block content %}
<div id="staff-platform" class="group">
	<div class="header-bar has-preview-head">
        <h2 onclick="window.location.replace('{% url 'staff_manage_attraction' %}')" style="cursor:pointer;">Attractions</h2>
        <section class="sub-header-bar">
            <div class="preview-head">
            	{% if attraction.is_featured %}
        		<span class="list-type featured-item"><a class="tttxt" original-title="{% trans 'Item listed as featured' %}" href="javascript:void(0);">{% trans 'Featured' %}</a></span>
		 		{% endif %}
                <div class="item-title">
                    <h1>{{ attraction.name|truncate_chars:91}}</h1>
                    <p class="ltxt80">By <a href="{% url 'user_profile' attraction.created_by.profile_slug %}">{{attraction.created_by.display_name}}</a> <span class="divider12">|</span> {{attraction.created_on|date:"M d, Y"}}</p>
				</div>                                   
                <ul class="status-tabs group">
                	 <li>{{attraction.view_count}}<span class="meta">{% trans 'views' %}</span></li>
                    <!--li> <a href="#">4<span class="meta">{% trans 'comments' %}</span></a> </li-->
                </ul>                                
            </div>                                
        </section>                          
    </div>
    <div id="core-wraper" class="group">
        <div class="staff-main">
            <div class="page-wrap">
                <div id="article-preview" class="preview-center group">
                    <div class="preview-items">
                        <div class="preview-group">  
                        	<div class="preview-items-head">
								{% if perms.attraction.change_attraction %}
                                <div class="right-item"><div class="cform-button"><a href="{% url 'staff_edit_attraction' attraction.id %}"><span>{% trans 'Edit' %}</span></a></div></div>
                            	{% endif %}
								<h3 style="vertical-align:top">{% trans 'Attraction Details' %}</h3>
                            </div>            
                            <div class="preview-item title">
                                <div class="label"><h4>{% trans 'Name' %}</h4></div>
                                <div class="value">{{ attraction.name }}</div>
                            </div> 
							<div class="preview-item title">
                                <div class="label"><h4>{% trans 'Alias' %}</h4></div>
                                <div class="value">{{ attraction.alias }}</div>
                            </div> 
							<div class="preview-item title">
                                <div class="label"><h4>{% trans 'Category' %}</h4></div>
                                <div class="value">
                                	{% for cat in attraction.category.all %}{{ cat }}{% if not forloop.last %},{% endif %}{% endfor%}
								</div>
                            </div> 
							{% if attraction.start_time or attraction.end_time %}
							<div class="preview-item title">
                                <div class="label"><h4>{% trans 'Timing' %}</h4></div>
                                <div class="value">
                                	{% trans 'From' %} {{attraction.start_time }} {% trans 'to' %} {{attraction.end_time}}
								</div>
                            </div> 
							{% endif %}
							<div class="preview-item title">
                                <div class="label"><h4>{% trans 'Description' %}</h4></div>
                                <div class="value">{% autoescape off %}{{ attraction.description }}{% endautoescape %}</div>
                            </div> 
							{% if attraction.venue %}                                           
                            <div class="preview-item address map">
                                <div class="label"><h4>{% trans 'Venue' %}</h4></div>
                                <div class="value">
									<div class="inline-block map-preview"  style="width: 190px; height: 150px;" id="map"></div>                                             
                                    	<div class="inline-block valign-top" style="width:324px;">
                                        <span class="address-name"><strong>{{ attraction.venue.venue }}</strong></span>                             
                                        <span class="address-details">{{ attraction.venue.address1 }}{% if attraction.venue.address2 %},{{ attraction.venue.address2 }}{% endif %}{% if attraction.venue.zip %} - {{ attraction.venue.zip }}{% endif %}</span>                             
                                       	{% if attraction.venue.email %}<span class="address-number">Email: {{ attraction.venue.email }}</span>{% endif %} 
										{% if attraction.venue.website %}<span class="address-number">Website: {{ attraction.venue.website }}</span>{% endif %} 
									    {% if attraction.venue.telephone1 %}<span class="address-number">Phone: {{ attraction.venue.telephone1 }}</span>{% endif %} 
										{% if attraction.venue.mobile %}<span class="address-number">Mobile: {{ attraction.venue.mobile }}</span>{% endif %}
										{% if attraction.venue.description %}<span class="address-number">Note: {{ attraction.venue.description }}</span>{% endif %} 
									</div>                                                        
                                </div>
                            </div>
								{% endif %} 
							{% if not attraction.ticket_cost_free %}
                            <div class="preview-item price">
                                <div class="label"><h4>{% trans 'Ticket Cost' %}</h4></div>
                                <div class="value">
                                	<span>{% trans 'Adult' %} : {{globalsettings.currency}}{{attraction.ticket_cost_adult}}</span>
									<span>{% trans 'Child' %} : {{globalsettings.currency}}{{attraction.ticket_cost_child}}</span>
								</div>
                            </div> 
							{% endif %}
							{% if attraction.ticket_url %}
                            <div class="preview-item url">
                                <div class="label"><h4>{% trans 'Ticket URL' %}</h4></div>
                                <div class="value">
                                	<span class="url">
                                        <a href="{{attraction.ticket_url}}" target="_blank">{{attraction.ticket_url}}</a>
                                    </span>
								</div>
                            </div> 
							{% endif %}
							{% if attraction.website_url or attraction.fb_url or attraction.twitter_url or attraction.gooleplus_url %}   
                            <div class="preview-item url">
                                <div class="label"><h4>{% trans 'Website/Profiles' %}</h4></div>
                                <div class="value">
                                	<span class="url">
                                        {% if attraction.website_url %}<a href="{{attraction.website_url}}" target="_blank">{{attraction.website_url}}</a><br>{% endif %}
                                        {% if attraction.fb_url %}<a href="{{attraction.fb_url}}" target="_blank">{{attraction.fb_url}}</a><br>{% endif %}
										{% if attraction.twitter_url %}<a href="{{attraction.twitter_url}}" target="_blank">{{attraction.twitter_url}}</a><br>{% endif %}
                                        {% if attraction.gooleplus_url %}<a href="{{attraction.gooleplus_url}}" target="_blank">{{attraction.gooleplus_url}}</a>{% endif %}
                                    </span>
								</div>
                            </div>
							{% endif %}
							{% if videos %}  
                            <div class="preview-item medias">
                                <div class="label"><h4>{% trans 'Video' %}</h4></div>
                                <div class="value">
                                    <div id="id_video_slider">
										<ul class="videos-scroll">
											{% for video in videos %}
											<li class="videos-selectable videos-slctbl inline-block"> 
												<div class="video-selectable-area" style="width:120px;">
										    		<div class="thumb-wrap inline-block">
										    			<div>
									    					<span class="video-thumb">
									    					<span class="clip"><img id="{{video.video_url}}" alt="Thumbnail "src="http://i2.ytimg.com/vi/{{video.video_url}}/default.jpg"></span></span>
														</div>
														<!--span class="play-icon" title="Attraction {% if video.is_vimeo %}Vimeo{% else %}YouTube{% endif %} Video"></span-->
														<span onclick="play_video('{{video.video_url}}','{{video.is_vimeo}}')" title="{{video.title|title}}" class="play-icon"></span>                                                            
													</div>
												</div>
											</li>
											{% endfor %}
										</ul>
									</div>
                                </div>
                            </div>
							{% endif %}  
							{% if attraction.get_attraction_photos %}  
                            <div class="preview-item medias">
                                <div class="label"><h4>{% trans 'Photos' %}</h4></div>
                                <div class="value">
                                    <div class="item-photos">
                                        <ul  class="image-scroll fxslider1">
                                        	{% for photo in attraction.album.get_gallery_uploaded_images %}
                                            <li class="inline-block" data-src="{{photo.photo.url}}">
                                                <div class="photos-preview"><img src="{% thumbnail photo.photo 110x0 %}"><a class="icon-view preview-item" title="{% trans 'Large preview' %}" href="#"></a></div>
                                            </li>
											{% endfor %}
                                        </ul>
                                    </div>
								</div>
                            </div>
							{% endif %} 
							{% if attraction.tag.all %}  
                            <div class="preview-item tags">
                                <div class="label"><h4>{% trans 'Tags' %}</h4></div>
                                <div class="value">
                                	<span class="note">{% for tag in attraction.tag.all %}{{ tag.tag }}{% if not forloop.last %}, {% endif %}{% endfor %}</span>
								</div>
                            </div> 
							{% endif %}                                                                                       
                        </div>   
                    </div>                                            
                </div><!-- end table -->
            </div> <!-- end page wrap -->
        </div> <!-- end main-col -->                            
        <div id="aside" class="side-bar">
        	<div class="preview-aside-meta group">
                <ul class="side-navigation">
                    <li class="active"><a href="{% url 'staff_preview_attraction' attraction.id %}">{% trans 'Attraction Details' %}</a></li>
					<li><a href="{% url 'staff_photos_attraction' attraction.id %}">{% trans 'Photos' %}</a></li>
					{% if perms.attraction.add_attraction or perms.attraction.change_attraction %}
					<li><a href="{% url 'staff_attraction_videos' %}?aid={{attraction.id}}">{% trans 'Videos' %}</a></li>
					{% endif %}
                </ul>
			</div>       
             {#% include 'attraction/staff/faq.html' %#}         
        </div>                            
    </div>                                                    
</div>
{% endblock %}
{% block footer_include %}
<script src="http://maps.googleapis.com/maps/api/js?v=3&sensor=false{% if globalsettings.google_map_key %}&key={{ globalsettings.google_map_key }}{% endif %}" type="text/javascript"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/general/google_map.js"></script>
<script src="{{STATIC_URL}}themes/js/fxslider.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}ui/css/fxslider.css" />
<script type="text/javascript">
	setTimeout(function() {
		{% if attraction.venue.lat %}
			load('map',{{ attraction.venue.lat }}, {{ attraction.venue.lon }}, {{ attraction.venue.zoom }},"{{ attraction }}","{{ attraction.venue.address1 }}<br>{{ globalsettings.city }} - {{ attraction.venue.zip }}");
		{% else %}
			load('map',{{ globalsettings.google_map_lat }}, {{ globalsettings.google_map_lon }}, {{ globalsettings.google_map_zoom }},"{{ globalsettings.city }}","select the location");
		{% endif%}
	}, 500);
	html_var='<div class="preview">';
    {% if video.is_vimeo %}
			html_var+='<iframe src="http://player.vimeo.com/video/{{video.video_url}}/?autoplay=1" width="514px" height="289px" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'
		{% else %}
			html_var+='<iframe  wmode="opaque" width="514px" height="289px" src="http://www.youtube.com/embed/{{video_video_url}}/?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>';
		{% endif %}
	html_var+='</div>';
	$('.play-icon').colorbox({html:html_var,initialWidth: "560", top:"5%", initialHeight: "200"});
$(document).ready(function(){
	$(".fxslider1").fxslider();
	setTimeout(function(){
	{% if video.is_vimeo %}
	    $.ajax({
	        type:'GET',
	        url: 'http://vimeo.com/api/v2/video/{{video.video_url}}.json',
			jsonp: 'callback',
	        dataType: 'jsonp',
	        success: function(data){
	            var thumbnail_src = data[0].thumbnail_medium;
	            $('#vimeo_{{video.video_url}}').attr('src',thumbnail_src);
	        }
	    });
	{% endif %}
},100);
});
function play_video(vurl,vimeo){
    html_var='<div class="preview">';
    if(vimeo == 'True'){html_var+='<iframe src="http://player.vimeo.com/video/'+vurl+'/?byline=0&autoplay=1" width="514px" height="289px" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}
    else{html_var+='<iframe  wmode="opaque" width="514px" height="289px" src="http://www.youtube.com/embed/'+vurl+'/?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>';}
    html_var+='</div>';
    $('.play-icon').colorbox({html:html_var, width:"514", initialWidth: "514", top:"5%", initialHeight: "200"});                     
} 
</script> 
{% endblock %}