{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% load upload_tags %}
{% load thumbnail %}
{% block navigation %}
	{% activetab "selmodule" "restaurants" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Menu - Restaurant' %} {% endblock %}
{% block head %}
<link type="text/css" rel="stylesheet" href="{{STATIC_URL}}css/bm.jfp.ui.css">
{% endblock %}
{% block content %}
<div id="staff-platform" class="group">
  	<div class="header-bar has-preview-head">
        <h2 onclick="window.location.replace('{% url 'staff_restaurant_home' %}')" style="cursor:pointer;"><span class="go_back"></span>Restaurant</h2>
        <section class="sub-header-bar">
            <div class="preview-head">
                <div class="item-title">
                    <h1>{{ restaurant }}</h1>
                    <p class="ltxt80">By <a href="#">{{restaurant.created_by.profile.get_full_name}}</a> <span class="divider12">|</span> {{restaurant.created_on|date:"M d, Y"}}</p>
				</div>                                   
                                             
            </div>                                
        </section>                          
    </div>
    <div id="core-wraper" class="group">
        <div class="staff-main">
            <div class="page-wrap">
                <div id="menus" class="preview-center group">
                	<div class="preview-group">
						<div class="preview-items-head" id="add_head" style="{% if not restaurant.restaurant_menus.all %}display:none;{% endif %}">
                      <!----------- add a menu -------------->
							<div class="right-item">
								<span class="btn-txt-inline-prime bm-add-menu">
								<a href="{% url 'staff_restaurant_menu_add' restaurant.id %}" title="{% trans 'Add new menu' %}" class="bm-add-gadget"><span class="btn-txt">{% trans 'Add new menu' %}</span></span></a>
							</div>
                            <h3>{% trans 'Menus' %}</h3>
                        </div>
						<ol class="data-table-inset" imenuuct_list">
							<li class="table-list-row" style="text-align:center;padding:10px;display:none;" id="ajax_content_loading_list">
								<img src="{{STATIC_URL}}ui/images/global/loading-s.gif">
							</li>
							{% if restaurant.restaurant_menus.all %}
							{% for menu in restaurant.restaurant_menus.all %}
                        	<li class="table-list-row manage-items has-thumb90" id="li_{{menu.id}}">
                                <div class="table-list-row-inner group">
                                    
									<div class="item-detail">
										<h4>{{menu.title}}</h4>
										<a href = "{{MEDIA_URL}}{{ menu.files }}">{{ menu.files }}</a>
									</div>
									
						<!-------- Edit  a menu---->
                                   	<div class="action-buttons">
                                        <div>
                                            <a href="{% url 'staff_restaurant_menu_add' restaurant.id %}/?mid={{menu.id}}" class="bm-add-gadget" original-title="{% trans 'Edit Menu' %} {{menu}}"><span class="action-icon icon-edit"></span></a>
                                            <a href="javascript:delete_menu({{menu.id}})" class="tttxt-w" original-title="Delete"><span class="action-icon icon-delete"></span></a>
										</div>                                                            
                                  	</div>
									
                                </div>
							</li>
							{% endfor %}
							{% endif %}

                        </ol> <!-- end table --> 

					<!----------- add a menu -------------->
                        <div class="no-data" style="{% if restaurant.restaurant_menus.all %}display:none;{% endif %}">
                        	<p>{% trans 'No Menus found for this restaurant. Add Now!' %}.</p>
                            <div class="button-insde">
                            	<span class="btn-txt-inline-prime bm-add-menu">
									<a href="{% url 'staff_restaurant_menu_add' restaurant.id %}" title="{% trans 'Add new menu' %}" class="bm-add-gadget">
										<span class="btn-txt">{% trans 'Add new menu' %}</span>
									</a>
								</span>
	                        </div>
                        </div>
					</div>
                </div><!-- end table -->
            </div> <!-- end page wrap -->
        </div> <!-- end main-col -->                            
        <div id="aside" class="side-bar">
        	<div class="preview-aside-meta group">
                <ul class="side-navigation">
                    <li><a href="{% url 'staff_preview_restaurant' restaurant.id %}">Restaurant Details</a></li>
					<li class="active"><a href="{% url 'staff_restaurant_menu' restaurant.id %}">Menus</a></li>
                    <li><a href="{% url 'staff_restaurant_image' restaurant.id %}">Images</a></li>
					<li><a href="{% url 'staff_restaurant_videos' %}?rid={{restaurant.id}}">Videos</a></li>
                </ul>
				<div class="preview-item-stats">
					<a href="{% url 'staff_preview_restaurant' restaurant.id %}" class="btn-txt-blue" style="display:block; text-align:center"><span class="btn-txt">Preview this Restaurant</span></a>
                </div>                              
			</div>    
			<div class="section">
				<h6>Manage Menus</h6>
				<p>Add the Menus or merchandise the restaurant offers to it customers.</p>
			</div>
        </div>                            
    </div>                                                    
</div>
{% endblock %}
{% block footer_include %}
{% upload_js %}
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.jfp.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.fup.appln.js"></script>
<script src="{{ STATIC_URL }}js/ckeditor/ckeditor.js" type="text/javascript"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}ui/js/listing_settings.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/business/staff.js"></script>
<script type="text/javascript">




function load_append_html(id){
	$.ajax({
		type: "POST",
		url:'{% url 'staff_restaurant_menu_load_html' %}',
		data:'id='+id,
		dataType:'JSON',
		success: function(responseData){
			try{$('#li_'+id).remove();}
			catch(e){}
			$('#ajax_content_loading_list').hide();
			$(responseData.html).insertAfter("#ajax_content_loading_list")
			$(".bm-add-menu").colorbox({width:"700",height:"560",initialWidth: "700", top:"5%", initialHeight: "200",title:function(){return getLBTitle($(this));}});
		}
	});
}
function delete_menu(id){
	if(confirm(gettext('Are you sure want to delete this menu ?'))){
		$.ajax({
			type: "POST",
			url:'{% url 'staff_restaurant_menu_delete' %}',
			data:'id='+id,
			dataType:'JSON',
			success: function(responseData){
				show_msg(responseData.msg,responseData.mtype);
				if(responseData.status==1){
					$('#li_'+id).remove();
					if($('#menu_list').find('li').length==1){
						$('.no-data').show();
						$('#add_head').hide();
					}
				}
			}
		});
	}
}
</script>
{% endblock %}