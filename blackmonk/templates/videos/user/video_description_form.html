<div class="pD10 pDt0">                                                                                     
    <div class="row-fluid mRt20">
        <form class="uSr-aCnT mRb0" action="{% url 'user_video_edit_selected_video' %}" id="form_category_submit_id" method="post">{% csrf_token %}
            <ul class="modulesBrowseData tWcL-lT mDa-lT mDa-oT-tP bRdR0 pDfX dSrS480 gTtR010 cLrFx">
				<input type="hidden" name="ids" value="{{ids}}">
                {% for video in videos %}
                    <li class="mDa">
                        <div class="mDa-iN">
                            <div class="mDa-wPr mRb20"> 
                                <span class="bUi-tMb-wPr tMb-60 fLxiMgH">
                                    <span class="bUi-tMb">
                                        <span class="bUi-tMb-pRpL">
                                            <span class="bUi-tMb-cLp">
                                                <span class="bUi-tMb-cLp-iN"> <img id="vimeo_{% if video.is_vimeo %}{{video.video_id}}{% endif %}" class="mDa-oT" src="{% if not video.is_vimeo %}{{video.get_hq_thumb}}{% endif %}" alt="">
                                                    <span class="vRtL-aLn"> </span>
                                                </span>
                                            </span>
                                        </span>
                                    </span>
                                </span>
                                <div class="mDa-hVr cVr tR-hVr"><span class="bR5"><span class="lBl dRk mNi" href="#">{{video.duration}}</span></span></div> 
                            </div>
                            <div class="mDa-bDy">
                                <fieldset>
                                    <div class="control-group mRb0">
                                        <label class="control-label">Title</label>
                                        <div class="controls">
                                            <input type="text" class="" maxlength="150" value="{{video.title}}" name="title{{video.id}}">
                                        </div>
                                    </div>
                                    <div class="control-group mRb0">
                                        <label class="control-label">Category</label>
                                        <div class="controls">
                                            <select class="bM-sLt" data-size="5" name="video_category"  id="video_category{{video.id}}">
                                                {% for cat in categories %}
                                                    <option value="{{cat.id}}">{{cat.name}}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group mRb0">
                                        <label class="control-label">Description</label>
                                        <div class="controls">
                                            <textarea rows="5" name="description{{video.id}}" maxlength="800" value="description{{video.id}}" class="fS12">{{video.description}}</textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
            <hr class="oTsT-hRz20 mRb0 mRt0">
            <div class="row-fluid">
                <div class="form-actions pD0 pLrT">
                    <button class="btn btn-primary fS12 fW-bLd mRl5" type="button" id="id_save_videos" onclick="save_all_videos();">Finish</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript">
$(document).ready(function(){
    setTimeout(function(){
        {% for video in videos %}
            {% if video.is_vimeo %}
                $.ajax({
                    type:'GET',
                    url: 'http://vimeo.com/api/v2/video/{{video.video_id}}.json',
                    jsonp: 'callback',
                    dataType: 'jsonp',
                    success: function(data){
                        var thumbnail_src = data[0].thumbnail_large;
                        $('#vimeo_{{video.video_id}}').attr('src',thumbnail_src);
                    }
                });
            {% endif %}
        {% endfor %}    
    },100);
});
$(document).ready(function(){
	$("#form_category_submit_id").validate({
		ignore:'',
		highlight: function(element, errorClass){
			$(element).parent('div').parent('div').addClass('error');
			$(element).parent('div').addClass('error');
			$(element).addClass('error');
		},
		unhighlight: function(element, errorClass){
			$(element).parent('div').parent('div').removeClass('error');
			$(element).parent('div').removeClass('error');
			$(element).removeClass('error');
		},
		errorPlacement: function(error, element){},
	   	rules:{
			{% for video in videos %}
			title{{video.id}}: "required",
			{% endfor %}
	   	}
	});
});
function save_all_videos(){
	var flag = $('#form_category_submit_id').validate().form()
	if (flag){
		$('#id_save_videos').attr('disabled','disabled');
		$('#id_save_videos').addClass('dSbLd');
		$('#id_save_videos').text('Saving...');
		$('#form_category_submit_id').submit();
	}
}

</script>
