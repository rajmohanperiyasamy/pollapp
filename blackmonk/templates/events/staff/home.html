{% extends "staff_base.html" %}
{% load tabs %}
{% load i18n %}
{% block navigation %}
	{% activetab "selmodule" "events" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Events' %} {% endblock %}
{% block head %}
	<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}themes/green/css/LE_MetaId99.css">
	
	
{% endblock %}
{% block content %}
<div id="staff-platform" class="group">
                  	<div class="header-bar has-sub">
					<h2>{% trans 'Events' %}</h2>
                        <section class="sub-header-bar">
                            <div class="group">
                                  <div class="filter-view-tabs">
                                        <ul class="left">
                                              <li><label>{% trans 'View:' %}</label></li>
                                              <li class="view-tab tip tip1" id="filter_a">
                                                    <a title="{% trans 'View All' %}" name="all" id="listing_all" class="view-both tttxt-n active first" href="javascript:void(0)"><span>All</span></a>
                                                    <a title="{% trans 'Pending Only' %}" name="N" id="listing_pending" class="view-pending tttxt-n" href="javascript:void(0)"><span>Pending</span></a>
                                                    <a title="{% trans 'Published only' %}"  name="P" id="listing_published" class="view-published tttxt-n" href="javascript:void(0)"><span>Published</span></a>
                                                    <a title="{% trans 'Rejected only' %}" name="R" id="listing_rejected" class="view-rejected tttxt-n" href="javascript:void(0)"><span>Rejected</span></a>
													<a title="{% trans 'Blocked only' %}" name="B" id="listing_blocked" class="view-withdrawn tttxt-n" href="javascript:void(0)"><span>{% trans 'Blocked' %}</span></a>
													<a title="{% trans 'Expired only' %}" name="E" id="listing_expired" class="view-expired tttxt-n last" href="javascript:void(0)"><span>Expired</span></a>     
                                                   
                                              </li>
                                              <li class="view-tab tip tip2" id="filter_b">
                                                    <a title="{% trans 'View All' %}" name="all" class="view-both tttxt-n active first" href="javascript:void(0)"><span>{% trans 'All' %}</span></a>
                                                    <a title="{% trans 'Show Featured' %}" name="F" class="view-featured tttxt-n" href="javascript:void(0)"><span>{% trans 'Featured' %}</span></a>
                                                    <a title="{% trans 'Show Sponsored' %}" name="S" class="view-sponsored tttxt-n" href="javascript:void(0)"><span>{% trans 'Sponsored' %}</span></a>
													<a title="{% trans 'Show Free' %}" name="B" class="view-free tttxt-n last last" href="javascript:void(0)"><span>{% trans 'Free' %}</span></a>
                                              </li>
                                              <li class="view-tab tip tip3" id="filter_c">
                                                    <a title="{% trans 'View All' %}" class="view-both tttxt-n active first" name="all" href="javascript:void(0)"><span>{% trans 'All' %}</span></a>
                                                    <a title="{% trans 'Show my events' %}"  name="CSM" class="view-mine tttxt-n" href="javascript:void(0)"><span>{% trans 'Your' %}</span></a>
                                                    <a title="{% trans 'Show events posted by others' %}" name="CSO" class="view-others tttxt-n last" href="javascript:void(0)"><span>{% trans 'Others' %}</span></a>
                                              </li>
                                        </ul>
                                        <form action="#" id="article-search-form" class="module-search tip tip4">
                                            <button role="button" class="cform-button search-button" type="button" id="btnSearch" onclick="$('#id_search').val('true'),hm_search();"><span class="search-icon">{% trans 'Search' %}</span></button>
                                            <div class="inline-block relative-block">
                                            	<!--span onclick="clear_search();" class="reset txt-button tttxt" id="close_search" title="{% trans 'Clear Search' %}" style="{% if not search %}display:none;{% endif %}">Clear search</span-->
                                                <input type="text" placeholder="{% trans 'Search events' %}" onkeydown="if (event.keyCode == 13) document.getElementById('btnSearch').click();" onkeyup="$('.search_adv2').val(this.value);" onkeyup="$('.search_adv2').val(this.value);" name="search_keyword" id="id_search_keyword" class="search-list-items search_adv1" style="width:147px;">
                                                <div class="call-advanced-search">
                                                    <span class="arrow-down tttxt" title="{% trans 'Show search options' %}"></span>
                                                </div> 
                                                <div id="advanced-search-options" style="display: none;">
                                                	<div class="search-head">
                                                    	<!-- h5>Search</h5 -->
                                                    	<span class="inline-block icon-close close-this"></span>
                                                    </div>
	                                                <div class="advanced-search-fields">
                                                		<dl class="vertical">
                                                			<dt><label>{% trans 'Search' %}</label></dt>
                                                			<dd>
                                                            	<input type="text" class="search_adv2" onkeyup="$('.search_adv1').val(this.value);" placeholder="{% trans 'keywords' %}" name="search_keyword" id="id_search_keyword1" style="width:161px;height:25px;">
                                                			</dd>                                                        
                                                			<dt></dt>
                                                			<dd>
                                                            	<select style="width: 165px;" class="select-menu"  id="search_type">
                                                                    <option value="">{% trans 'All' %}</option>
							                                        <option value="title">{% trans 'Title' %}</option>
                                                                    <option value="venue">{% trans 'Venue' %}</option>
                                                                    <option value="zip">{% trans 'Zip' %}</option>
                                                				</select>
                                                			</dd>
															<dt></dt>
                                                             <dd>
                                                             	<input type="text" name="start_date" placeholder="{% trans 'Start date' %}" id="id_search_start_date" class="textField" style="width:75px;" value=""><input type="text" placeholder="{% trans 'End date' %}" name="end_date" id="id_search_end_date" class="textField" style="width:75px; float:right" value="">
                                                            </dd>
															<dt></dt>
                                                			<dd>
                                                            	<select style="width: 165px;" class="select-menu" id="search_category">
																	 <option value=""> {% trans 'All Categories' %} </option>
                                                                    {% for category in categorys %}
							                   							<option value="{{ category.id }}">{{ category.name }}</option>
							                   						{% endfor %}
                                                                </select>
															</dd>
                                               				<dt></dt>
                                                			<dd>
                                                            	<select style="width: 165px;" class="select-menu" id="search_status">
                                                                    <option value="">{% trans 'All Status' %} </option>
													                <option value="P">{% trans 'Published' %}</option>
											                        <option value="N">{% trans 'Pending' %}</option>
											                        <option value="E">{% trans 'Expired' %}</option>
																	<option value="B">{% trans 'Blocked' %}</option>
																	<option value="R">{% trans 'Rejected' %}</option>
                                                				</select>
			                                                </dd>
                                                		</dl>
													</div>                                                        
                                                	<div class="form-submit"><button type="button" class="btn-txt-blue small advnc_search" onclick="$('#id_search').val('true'),hm_search();" role="button"><span class="btn-txt">{% trans 'Search' %}</span></button></div>
                                                </div> 
                                                                                                                                         
											</div>                                                
                                        </form>
                                  </div>
								<div class="add-section-right has_icon">
									<a href="{% url 'events_staff_addevent' %}" class="btn-txt-prime bm-upload-videos {% if not perms.events.add_event %}disabled{% endif %}" title="{% trans 'Add New Event' %}"><span class="btn-txt">{% trans 'Add Event' %}</span></a>
								  	<a href="{% url 'staff_events_import_csv' %}" class="btn-txt-prime csv tttxt-n" title="Add Event via CSV"><span class="icon upload"></span></a>
								  	<a href="{% url 'staff_events_export_csv' %}" class="btn-txt-prime csv tttxt-n" title="Export Events to CSV"><span class="icon import"></span></a>
			                  </div> 
                            </div>
                        </section>                          
                 		</div>
						<div id="core-wraper" class="group">
                        	<div class="staff-main">
                              	<div class="page-wrap">
									<div id="articles" class="group">
                                        <section class="toolbars">
                                            <div class="group">
                                                <ul class="toolbar left">
                                                    <li class="master-check tool">
														<span class="cform-checkbox-container"><input type="checkbox" value="true"  id="master_check" name="master-check"><span class="cform-checkbox-element"></span></span>
													</li>
													{% if perms.events.publish_event or perms.events.delete_event %}
                                                    <li class="tool action_status tip tip5">
                                                        <select data-placeholder={% trans 'Action' %}  id="actionSelect" class="select-menu" onchange="$('#id_action').val($(this).val()),action();" style="width:140px;">
                                                          <option value="#"></option> 
                                                          	{% if perms.events.delete_event %}
	                                                          <option value="DEL">{% trans 'Delete' %}</option>
														  	{% endif %}
														  {% if perms.events.publish_events %}
                                                          <optgroup label="Status" class='action_status'>
                                                             	<option value="P" class='publish_action'>{% trans 'Publish' %}</option>
                                                              	<option value="R" class='reject_action'>{% trans 'Reject' %}</option>
                                                              	<option value="B" class='block_action'>{% trans 'Block' %}</option>
                                                          </optgroup>
														  {% endif %}
                                                        </select>
                                                    </li>
													{% endif %}
                                                    <li class="tool tip tip6">                                                       
                                                        <label class="inline-block">{% trans 'Sort by:' %}</label>
                                                        <select  id="orderSelect" onchange="$('#id_sort').val($(this).val()),hm_sort();" style="width:140px;" class="select-menu">
	                                                          <option value="-created_on">{% trans 'Newest' %}</option>
	                                                          <option value="created_on">{% trans 'Oldest' %}</option>
	                                                          <option value="-visits">{% trans 'Most viewed' %}</option>
                                                        </select>                                                    
                                                    </li>
                                                </ul>
                                                {% include 'common/pagination_top.html'%} <!-- pagination top -->  
                                            </div>
                                        </section>
										<span id="ajax_content_loading" class="load-list-items" style="display:none">
										 	<img src="{{STATIC_URL}}ui/images/global/loading.gif" align="...">
										</span>
										<div style="display:none;" class="info-bar" id="top_info_bar"></div>
										<div id="id_content_listing" class="group">
	                                           {% include 'events/staff/ajax-event-listing.html'%} 
										</div>	                                       
                                    </div> <!-- end table -->
                              </div>  <!-- end page wrap -->
                        </div>  <!-- end main-col -->                            
                        <div id="aside" class="side-bar">
                        	<input type="hidden" value="{% url 'events_staff_ajax__state' %}" name="id_event_status_url" id="id_event_status_url">
                        	<div id="module-stats" class="section">
                            	<div class="group">
                                    <h5>{% trans 'State' %}</h5>
                                    <div class="stats-toggle tip tip7">
                                        <a class="state-all statefltr {% if status == 'all' %}active{% endif %} tttxt" onclick="show_count('all');"  href="javascript:void(0)" id="id_status_all" title="{% trans 'Show all state' %}"><span class="icon-state-all"></span></a>                                                    
                                        <a class="state-you statefltr {% if status == 'mine' %}active{% endif %} tttxt" onclick="show_count('mine');" href="javascript:void(0)" id="id_status_mine" title="{% trans 'Show your state' %}"><span class="icon-state-you"></span></a>                             
                                    </div>
									<span id="ajax_loading" class="loading-stats"  style="display:none;"><img src="{{STATIC_URL}}ui/images/global/loading-s.gif" align="..."></span>
								</div>
                            	<ol class="stats-summary" id="id_module_state_listing">
                                	 <li class="pending-state"><strong id="id_pend">{{ pending }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Pending' %}</a></li>
							         <li class="published-state"><strong id="id_pub">{{ published }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Published' %}</a></li>
							         <li class="rejected-state"><strong id="id_rej">{{ rejected }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Rejected' %}</a></li>
							         <li class="expired-state"><strong id="id_exp">{{ expired }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Expired' %}</a></li>
							         <li class="blocked-state"><strong id="id_blk">{{ blocked }}</strong> {% trans 'in' %} <a href="javascript:void(0)">{% trans 'Blocked' %}</a></li>
							     	 <li class="sum"><strong id="id_tot">{{ total }}</strong> {% trans 'total events posted.' %}</li>
                               </ol>
                            </div>
                            {% include 'events/staff/event-faq.html' %}                                    
                        </div>                            
					</div>                                                    
				</div>
{% endblock %}			
{% block footer_include%}
<script type="text/javascript" src="{{ STATIC_URL }}js/gallery/setCoverPhoto.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery/bm.common.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/Event/events_staff.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.ui.datepicker.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}ui/js/listing_settings.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/payment/process_offline_payment.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		$('.tool.action_status .chzn-container').addClass('chzn-disabled , disabled_chosen');
		{% if recent %}
			$('#id_status').val('N');
			$('#filter_a a').removeClass('active');
			$('#listing_pending').addClass('active');
			filter_content();
		{% endif %}
		
	}); 			
	
		checkall = function(){
		var cb = document.getElementById("master_check");
		if(cb.checked){
			$(".cbox").attr("checked","true");
		}if(!cb.checked){
			$(".cbox").removeAttr("checked");
		}
		}
	
</script>
<script type="text/javascript">
function save_listing_type(id){
	var flag = $('#mform4').validate().form()
	if(flag==true){
		var dataString="id="+id;
		var payment_id=$('input[name=listingtype]:checked').val();
		dataString+='&listingtype='+payment_id;
		dataString+='&start_date='+$('#id_listing_start_date').val();
		dataString+='&end_date='+$('#id_listing_end_date').val();
		if(payment_id!=1){
			dataString+='&price_'+payment_id+'='+$('#price_'+payment_id).val();
		}
		$.ajax({
		type: "POST",
		url: "{% url 'staff_events_listing_type' %}",
		data: dataString,
		dataType:'JSON',
		success: function(data){
				show_msg(data.msg,data.mtype);
				filter_content();
				$.colorbox.close();
			}
		});
	}	
}
</script>
<script type="text/javascript">
function txtarealimit(txtobj,len){
	var txtvalue = txtobj.value;
	var the_len = txtvalue.length;
	if (the_len > len){
		txtobj.value = txtvalue.substring(0,len);
	}
	txtobj.scrollTop=txtobj.scrollHeight;
}
function save_seo(option){
	var flag = $('#mform').validate().form()
	var id=0;
	if(flag==true){
		var dataString='&slug='+encodeURIComponent($('#id_slug').val());
		dataString+='&seo_title='+encodeURIComponent($('#id_seo_title').val());
		dataString+='&seo_description='+encodeURIComponent($('#id_seo_description').val());
		$('#ajax_content_seo').hide();
		$('#ajax_content_loading_seo').show();
		$.ajax({
		type: "POST",
		url: $("#mform").attr("action"),
		data: dataString,
		dataType:'JSON',
		success: function(data){
				$('#ajax_content_loading_seo').html(data.msg);
				if(data.status){
					show_msg(data.msg,data.mtype);
					$.colorbox.close();
					
				}else{
					$('#ajax_content_loading_seo').hide();
					$('#ajax_content_seo').empty().html(data.lightbox_html);
					$('#ajax_content_seo').fadeIn(2000);
				}
			}
		});
	}
}
</script>
<ul class="tour_link">
    <li class="tool-tip tttxt-t1"><a class="link1" href="/bmt/tour/events/staff/status.html"></a></li>
    <li class="tool-tip tttxt-t2"><a class="link2" href="/bmt/tour/events/staff/listing_type.html"></a></li>
    <li class="tool-tip tttxt-t3"><a class="link3" href="/bmt/tour/events/staff/submissions.html"></a></li>
    <li class="tool-tip tttxt-t4"><a class="link4" href="/bmt/tour/events/staff/search.html"></a></li>
    <li class="tool-tip tttxt-t5"><a class="link5" href="/bmt/tour/events/staff/actions.html"></a></li>
    <li class="tool-tip tttxt-t6"><a class="link6" href="/bmt/tour/events/staff/sorting.html"></a></li>
    <li class="tool-tip tttxt-t7"><a class="link7" href="/bmt/tour/events/staff/state.html"></a></li>
    <li class="tool-tip tttxt-t8"><a class="link8" href="/bmt/tour/events/staff/status_aside.html"></a></li>
    <li class="tool-tip tttxt-t9"><a class="link9" href="/bmt/tour/events/staff/settings.html"></a></li>
</ul>
{% endblock %}	
