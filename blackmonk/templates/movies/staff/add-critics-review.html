{% load i18n %}    
<div id="critics-review">
{% if form.errors %}
	<div class="messageerror" style="background:#FCF4F4;padding:10px;color:#FF9902; box-shadow:0 0 2px rgba(0, 0, 0, 0.1);border-bottom:1px solid #e1e1e1">
		<strong style="font-weight:bold;">{% trans 'There is a problem with your submission' %}</strong>
		<ul style="list-style:square;margin-left:20px;">
			{% for field in form %}
				{% if  field.errors%}<li>{%for error in field.errors%}{{error}}{%endfor%} - {{field.name}}</li>{% endif %}
			{% endfor %}
		</ul>
	</div>
{% endif %}
    <form action="{% url 'movie_ajax_add_critics' %}?movie_id={{movie_preview.id}}" name="f_addnew" id="f_addnew" method="post">{% csrf_token %}
    <div class="fields hform">
            <div class="field-group"> 
            <div class="field select-field">
                            <div class="label"><label>{% trans 'Critics Source' %}<span class="required-field">*</span></label></div>
                            <div class="value">
                                    {{form.source}}
                            </div>
                        </div>
                        <div class="field text-field">
                            <div class="label"><label>{% trans 'Title'%}<span class="required-field">*</span></label></div>
                            <div class="value">
                            <span>{{form.title}}</span>
                        </div>
                        <div class="field text-field">
                            <div class="label"><label>{% trans 'Reviewed By'%}<span class="required-field">*</span></label></div>
                            <div class="value">
                            <span>{{form.reviewed_by}}</span>
                        </div>
                        <div class="field text-field">
                            <div class="label"><label>{% trans 'Rating'%}<span class="required-field">*</span></label></div>
                            <div class="value ">
                                 <select name="rating" data-placeHolder="{% trans 'Select Rating' %}" id="id_rating" class="lb_select-menu fl">
                                    <option value=""></option>
                                    <option value="1">{% trans 'Poor' %}</option>
                                    <option value="2">{% trans 'Average' %}</option>
                                    <option value="3">{% trans 'Good' %}</option>
                                    <option value="4">{% trans 'Very Good' %}</option>
                                    <option value="5">{% trans 'Excellent' %}</option>
                                 </select>  
                            </div>
                        </div>

                        <div class="field text-field">
                            <div class="label"><label>{% trans 'Review'%}<span class="required-field">*</span></label>(add upto 2000 characters)</div>
                            <div class="value">{{form.review}}</div>
                        </div>
            </div>                       
</div>    
</div>
<div class="modal-base form-submit group">
   <button type="submit" class="cform-button prime right id_critic_submit" role="button"><span class="cform-button-text">{% trans 'Finish' %}</span></button>
</div>
</form>

</div>              
 <script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.ui.datepicker.js"></script>
 <script type="text/javascript" src="{{STATIC_URL}}ui/js/inline.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery/jquery.ui.core.js"></script> 

<script type="text/javascript">
function updateTextArea(){
    CKEDITOR.tools.setTimeout( function(){ 
        $('#id_review').val(edt.getData());
        $("#id_review").trigger('keyup');
    }, 0);  
}
$(document).ready(function(){
    if($("#id_published_on").length){
            $("#id_published_on").datepicker({ dateFormat: "dd/mm/yy" });
    }
});
var edt=CKEDITOR.replace( 'id_review',
	{                    
	    customConfig : '{{ STATIC_URL }}js/ckeditor/custome_config.js',
	    toolbar : 'Basic', 
	    height : 150
	});
try{
    var instance = CKEDITOR.instances['id_review'];
    CKEDITOR.remove(instance);
	}
	catch(e){}
	/*
	CKEDITOR.on( 'instanceCreated', function( e ){
	    e.editor.addCss('body { font-size:12px; font-family:Arial, "Times New Roman", Verdana;}');
	});
	*/
edt.on('key', function(event) {updateTextArea();});
</script> 
<script>
$(document).ready(function(){
    $.validator.addMethod("desc_required", function(value, element) {  
        $('#id_review').val(edt.getData());
        if($('#id_review').val()!=''){return true;}
        else{return false;}
    },"Please enter a description.");
    $("#f_addnew").validate({
        ignore:'',
        highlight: function(element, errorClass){$(element).parent().parent().addClass('field-error');$(element).addClass("error");},
        unhighlight: function(element, errorClass){$(element).parent().parent().removeClass('field-error');$(element).removeClass("error");},
        errorPlacement: function(error, element){},
           rules:{
            source: "required",
            reviewed_by: "required",
            title: "required",
            rating: "required",
            review: "desc_required",
           },
			submitHandler: function(form) {
				$('.id_critic_submit').attr('disabled','disabled');
				$('.id_critic_submit').css('opacity',0.5);
				form.submit();
			}    
    });
	$( ".id_article_submit" ).click(function(event){
		setTimeout(function(){
			$('.id_critic_submit').removeAttr('disabled'),event.preventDefault();
			$('.id_critic_submit').css('opacity',1);
		},3000);
	});

	$('.lb_select-menu').bind("change", function(){
		$("#f_addnew").validate().element($(this));
	});

});
</script>
   
