{% load i18n %}
<div id="ajax_content_loading_update_gallery" style="display:none;padding-top:100px;text-align:center;">
	<img src="{{STATIC_URL}}ui/images/global/loading-s.gif"><br><p>{% trans 'Please wait...' %}</p>
</div>
<div id="ajax_content_gallery_update">
	<div class="group relative-block">
        <div class="upload-gadget-main">
            <form class="modal-form" id="galleryeditform" action="{% url 'staff_gallery_update' gallery.id %}">
                <div class="fields hform">
                    <div class="field-group"> 
                    	<div class="fields-head">
                        	<h3>{% trans 'Update Gallery' %}</h3>
                            <p class="ltxt80">{#% trans '' %#}</p> 
                        </div> 
						{% if form.errors %} 
							<div class="field">
								<div class="messageerror" >
									<strong>{% trans 'There is a problem with your submission' %}</strong>
						            <ul style="list-style:square;margin-left:20px;">
						           		{% for field in form %}
						           			{% if  field.errors%}<li>{%for error in field.errors%}{{error}}{%endfor%}</li>{% endif %}
						          	 	{% endfor %}
									</ul>
							 	</div>
	                        </div>  
						{% endif %}               
                        <div class="field type-text">
                            <div class="label"><label>{% trans 'Gallery Name' %} <span class="required-field">*</span></label></div>
                            <div class="value">{{form.title}}</div>
                        </div> 
                        <div class="field select-field">
                            <div class="label"><label>{% trans 'Category' %} <span class="required-field">*</span></label></div>
                            <div class="value">{% if gallery.is_editable %}{{form.category}}{% else %}<input type="hidden" value="{{gallery.category.id}}" id="id_category" name="category"><input class="fl" type="text" value="{{gallery.category}}" readonly="readonly">{% endif %}</div>
                        </div>
                        <div class="field text-field">	
                            <div class="label"><label for="-button">{% trans 'Description' %}</label></div>	
                            <div class="value">{{form.summary}}</div>	
                        </div>
                        <div class="field text-field">	
                            <div class="label"><label for="-button">{% trans 'Tags' %}</label></div>
                            <div class="value has-fd-icon">
                                <input id='tags' type="hidden" class='tags' name="tags"  value="">
								<ul id="mytags" class="fl"></ul>
								<span class="tip">{% trans "Add multiple tags separated by comas ',' or use 'tab' key" %}</span>
                            </div>
                        </div>                            
                    </div>            
                </div>    
                <div class="modal-base form-submit group">
                   <button role="button" class="cform-button prime bm-upload-photos" type="button" onclick="save_updated_album()" title="Upload photos"><span class="cform-button-text">{% trans ' Update' %}</span></button>
                </div>           
            </form>
        </div> 
	</div>           
<script type="text/javascript" src="{{STATIC_URL}}ui/js/inline.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	$("#mytags").tagit({
		singleField: true,
		singleFieldNode: $('#tags'),
		allowSpaces:true,
		tagSource: function( request, response ) {
		 $.ajax({
		       url: '{% url 'gallery_auto_suggest_tag' %}',
		       data: { term:request.term },
		       dataType: "json",
		       success: function( data ) {
		       response( $.map( data, function( item ) {
		       return {
			   	label: item.label, value: item.value 
				}}
			));
			}
		});
		},
		onTagAdded: function(event, tag) {
	        $.colorbox.resize();
	    },
		onTagRemoved: function(event, tag) {
	        $.colorbox.resize();
	    }
	});
	{% for tag in gallery.tags.all %}
	  	$("#mytags").tagit('createTag','{{tag}}');
	  {% endfor%}
	  
	  
	  $("#galleryeditform").validate({
		ignore: "",
		highlight: function(element, errorClass){add_error_class(element)},
		unhighlight: function(element, errorClass){remove_error_class(element)},
		errorPlacement: function(error, element){},
	   	rules:{
	    	title: "required",
			category:"required"
	   	}
	});
	$('.select-menu').bind("change", function(){
		$("#galleryeditform").validate().element($(this));
	});
	  
	  
})

</script>
