{% extends "dashboard_base.html" %}
{% load tabs %}
{% load i18n %}
{% load humanize %}
{% block navigation %}
	{% activetab "selmodule" "dashboard" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Dashboard' %} {% endblock %}
{% block head %}
<link rel="stylesheet" href="{{STATIC_URL}}ui/css/datepicker.css" type="text/css" />
<!--[if lt IE 9]>
        <link rel="stylesheet" type="text/css" href="ui/css/ielt9.css" />
<![endif]-->
<!--[if lte IE 8]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<style>
	#modules-overview .rw{padding:0 20px;}
	#modules-overview h4.module-name{font-size:13px; display:inline-block; width:120px;}	
	#modules-overview .inline-col{display:inline-block; padding:0 10px;font-size:10px; text-transform:uppercase; color:#9A9A9A}
	#modules-overview .num{font-size:16px; font-weight:bold; color:#333;display:block;}
	#labels{font-size:11px; font-weight:bold; color:#333; display:block;}
	#labels ol{font-size:11px; display:inline;float:left;color:#333;}
	#labels ol li{font-size:11px; list-style:none;display:block;color:#333;float:left;padding:5px;-moz-border-radius:5px;border:1px dotted #333;}
	.hAxis-points{width:100%;padding:5px 0;margin:0;}
	.hAxis-points li {display:block;float:left;color:#666; text-align:center;font-size:10px;}
</style>
<script>
    		var analytic_url = "{{ globalsettings.website_url }}";
    		var pathname = window.location.pathname;
    	</script>
<!--script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script-->
{% endblock %}
{% block content %}
<div id="staff-platform" class="group">
	<div class="staff-main col_12">
		<div class="statitics box group">
			<div class="section-header">
				<h2>Statistics</h2>
				<div class="tabs">
					<ul class="group ">
						<li><a href="/staff/dashboard" id="Content" class="selected">Content</a></li>
						<li><a href="/staff/dashboard/user_stats" id="new_registration">New Registration</a></li>
						<li><a href="{% url 'staff_analytic_home' %}"  onclick="location.replace('{% url 'staff_analytic_home' %}');" id="Traffic" >Traffic</a></li>
						<li><a href="{% url 'staff_analytic_live' %}" onclick="location.replace('{% url 'staff_analytic_live' %}');" id="Live" >Live</a></li>
						
						<!--li><a href="#" id="new_registration">New Registration</a></li-->
					</ul>
				</div>
			</div>
			<div class="traffic-header group" style="padding:10px 15px;">
				<h2 style="float:left; font-size:20px; font-weight:bold;" id="Content_label">Contents</h2>
<div id="report-date-control">
				                    <div id="date-field">
				                        <span class="date-range" id="date-value">{{start_date|date:'d M Y'}} - {{end_date|date:'d M Y'}}</span>
				                        <span class="arw" id="arw"></span>
				                    </div>
				                    <div id="calendar-sets"></div>
				                </div>
				<div class="btn-group right bm-report" id="date_label">
					<a class="" href="javascript:void(0);" id="Day">
						<span>Day</span>
					</a>
					<a class="" href="javascript:void(0);" id="2day">
						<span>2 Day</span>
					</a>
					<a class="first active" href="javascript:void(0);" id="Week">
						<span>Week</span>
					</a>
					<a class="last" href="javascript:void(0);" id="Month">
						<span>Month</span>
					</a>
					<a class="last" href="javascript:void(0);" id="Year">
						<span>Year</span>
					</a>
				</div>
			</div>
			<div id="user-overview">
				<div class="visits">
					<div class="report-head group">
						<div class="chart-legend">
							<div class="item">
								<span style="border-color:#058DC7;" class="bullet">
								</span>&nbsp;Staff</div>
							<div class="item">
								<span style="border-color:#c70505" class="bullet">
								</span>&nbsp;Users</div>
						</div>
					</div>
					<div id="Contentviews" class="chart" style="height:240px;overflow:hidden;">
						<div id="Day_chart" class="bm-chart-div" style="display:none;" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
						<div id="2day_chart" class="bm-chart-div" style="display:none;" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
						<div id="Week_chart" class="bm-chart-div" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
						<div id="Month_chart" class="bm-chart-div" style="display:none;" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
						<div id="Year_chart" class="bm-chart-div" style="display:none;" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
						<div id="date_range_all_chart" class="bm-chart-div" style="display:none;" align="center">
							<img src="{{STATIC_URL}}/ui/images/global/loading.gif" />
						</div>
					</div>
				</div>
			</div>
			<!-- /visits -->
			<div class="score-card">
			</div>
			<!-- /score-card -->
			<div class="more-stats">
				<div class="btn-group right bm-data" id="date_label">
					<a class="first active" href="javascript:void(0);" id="modules_all">
						<span>all</span>
					</a>
					<a class="" href="javascript:void(0);" id="modules_staff">
						<span>Staff</span>
					</a>
					<a class="last" href="javascript:void(0);" id="modules_users">
						<span>Users</span>
					</a>
				</div>
				<div class="left-col">
					<div class="left-col-inner">
					</div>
				</div>
				<div class="left-tab-content" width="400px" height="300px">
					<div id="modules_all_chart" class="bm-pie-div" width="400px" height="300px" align="center">
						<img style="padding-top:125px;" src="{{STATIC_URL}}/ui/images/global/loading.gif" />
					</div>
					<div id="modules_staff_chart" class="bm-pie-div" width="400px" height="300px" style="display:none;" align="center">
						<img style="padding-top:125px;" src="{{STATIC_URL}}/ui/images/global/loading.gif" />
					</div>
					<div id="modules_users_chart" class="bm-pie-div" width="400px" height="300px" style="display:none;" align="center">
						<img style="padding-top:125px;" src="{{STATIC_URL}}/ui/images/global/loading.gif" />
					</div>
				</div>
			</div>
			<!-- /more-stats -->
		</div>
		<!-- /Content-overview -->
	</div>
	<div id="aside" class="side-bar col_4 mr_0">
		
	</div>
</div>
{% endblock %}	
{% block footer_include %}
<script type="text/javascript" src="{{STATIC_URL}}js/datepicker.js">
</script>
<script type="text/javascript" src="https://www.google.com/jsapi">
</script>
<script type="text/javascript">
//datepicker
	
	
	   $(document).ready(function(){
{% if filter_dates %}
$('.bm-chart-div').hide();
$('#date_range_all_chart').show();
{% endif %}

            var now3 = new Date('{{start_date|date:'m/d/Y'}}'); 
            var now4 = new Date('{{end_date|date:'m/d/Y'}}');   
$('.bm-report a').click(function(){
$('#date-value').html("-");
	});
            $('#calendar-sets').DatePicker({ 
                flat: true, 
                format: 'd B, Y', 
				date: [new Date(now3), new Date(now4)],
                calendars: 3, 
                mode: 'range',
				position: ['top'], 
                starts: 3,
				onRender: function(date) {
					return {
						disabled: (date.valueOf()> new Date()),
					}
				},
				onBeforeShow: function(date){
						shiftTo='True';
 						$(this).DatePickerSetDate(date, shiftTo);
				},
                onChange: function(formated) { 
                    $('#date-field span').get(0).innerHTML = formated.join(' - ');
					$('#apply').removeAttr("disabled");
					$('#cancel').css("pointer-events","auto");

                } 
            }); 

            var state = false; 
            $('#date-field').bind('click', function(){
                //$('#calendar-sets').stop().css('display', 'block'); 				
                //$('#calendar-sets').stop().animate({height: state ? 0 : $('#calendar-sets div.datepicker').get(0).offsetHeight, borderWidth:state ? 0:1}, 300); 
				$('#calendar-sets').css({height: state ? 0 : $('#calendar-sets div.datepicker').get(0).offsetHeight, borderWidth:state ? 0:1});
                state = !state; 
				if(state){$('#calendar-sets').css('box-shadow', '0px 0px 2px 1px rgba(0,0,0,0.08)');}
				else{$('#calendar-sets').css('box-shadow', 'none');}				
                return false; 
            });
			
			
		
			$('#calendar-sets div.datepicker').css('position', 'absolute');
			
			/*$(document).live('click', function(){
			//$('#calendar-sets').DatePickerHide();
			$('#calendar-sets').css({height: state ? 0 : $('#calendar-sets div.datepicker').get(0).offsetHeight, borderWidth:state ? 0:1});
			//return false;
			});*/		 
       		
	 		$('#calendar-sets div.datepicker').css('position', 'absolute');
			$('#cancel').bind('click', function(){
			date=[new Date(now3), new Date(now4)];
			shiftTo='True';
 			$('#calendar-sets').DatePickerSetDate(date, shiftTo);
			});




    //Jquery for day,2day,week,month 
    $('.bm-report a').click(function(){

    	if(!$(this).hasClass('active')){
        	$('.bm-report a').removeClass('active');
            $(this).addClass('active');
            $('.bm-chart-div').hide();
            $('#'+$(this).attr('id')+'_chart').show();
		}
	});

	//Jquery for staff,user
	$('.bm-data a').click(function(){
    	if(!$(this).hasClass('active')){
        	$('.bm-data a').removeClass('active');
            $(this).addClass('active');
            $('.bm-pie-div').hide();
            $('#'+$(this).attr('id')+'_chart').show();
			$('#'+$(this).attr('id')+'_data').show();
		}
	});	
});	
	


//date range data

	google.load("visualization", "1", {packages:["corechart"]});
	google.setOnLoadCallback(date_range_allChart);
	function date_range_allChart() {
		var data = google.visualization.arrayToDataTable([
	    	['Modules', 'Staff', 'Users'],
			{% for m in modules_sequence %}
				{% for k,v in modules_staff_date_range.items %}
					{% if m == k %}
						{%for a,b in modules_user_date_range.items %}
							{% if k == a %}
					  			['{{k}}',{{v}},{{b}}],
							{% endif %}
						{% endfor %}
					{% endif %}
				{% endfor %}
			{% endfor %}
		]);
		var options = {
			backgroundColor: '#FEFEFE',
			width: 733,
			height: 270,
			colors:['#058DC7','#c70505'],
			chartArea: {left:0, top:15,width:"733", height:"200"},
			legend: {position: 'none'},
			titlePosition: 'in', 
			axisTitlesPosition: 'in',
			hAxis: {
				textPosition: 'out', 
				slantedTextAngle: '90',
				textStyle: {color: '#666',fontSize:9},
				gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
				viewWindow:{min:'0'},
			}, 
			vAxis: {
				textPosition: 'in',
				baselineColor: "#AAA",
				textStyle: {color: '#666',fontSize:10},
				gridlines: {color: "#ECECEC", count: "6"},
				viewWindow:{min:'0'},
			},
		};
		var chart = new google.visualization.ColumnChart(document.getElementById('date_range_all_chart'));
	    	chart.draw(data, options);
		}



//All contents
	google.load("visualization", "1", {packages:["corechart"]});
	google.setOnLoadCallback(dayChart);
	function dayChart() {
		var data = google.visualization.arrayToDataTable([
	    	['Modules', 'Staff', 'Users'],
			{% for m in modules_sequence %}
				{% for k,v in modules_staff_day.items %}
					{% if m == k %}
						{%for a,b in modules_user_day.items %}
							{% if k == a %}
					  			['{{k}}',{{v}},{{b}}],
							{% endif %}
						{% endfor %}
					{% endif %}
				{% endfor %}
			{% endfor %}
		]);
		var options = {
			backgroundColor: '#FEFEFE',
			width: 733,
			height: 270,
			colors:['#058DC7','#c70505'],
			chartArea: {left:0, top:15,width:"733", height:"200"},
			legend: {position: 'none'},
			titlePosition: 'in', 
			axisTitlesPosition: 'in',
			hAxis: {
				textPosition: 'out', 
				slantedTextAngle: '90',
				textStyle: {color: '#666',fontSize:9},
				gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
				viewWindow:{min:'0'},
			}, 
			vAxis: {
				textPosition: 'in',
				baselineColor: "#AAA",
				textStyle: {color: '#666',fontSize:10},
				gridlines: {color: "#ECECEC", count: "6"},
				viewWindow:{min:'0'},
			},
		};
		var chart = new google.visualization.ColumnChart(document.getElementById('Day_chart'));
	    	chart.draw(data, options);
		}

//2day
	google.load("visualization", "1", {packages:["corechart"]});
	google.setOnLoadCallback(todayChart);
	function todayChart() {
		var data = google.visualization.arrayToDataTable([
	    	['Modules', 'Staff', 'Users'],
			{% for m in modules_sequence %}
				  {% for k,v in modules_staff_2day.items %}
				  		{% if m == k %}
								{%for a,b in modules_user_2day.items %}
										{% if k == a %}
									          ['{{k}}',{{v}},{{b}}],
										{% endif %}
								{% endfor %}
						{% endif %}
					{% endfor %}
	          {% endfor %}
			  ]);
	        var options = {
				backgroundColor: '#FEFEFE',
				width: 733,
				height: 270,
				colors:['#058DC7','#c70505'],
				chartArea: {left:0, top:15,width:"733", height:"200"},
				legend: {position: 'none'},
				titlePosition: 'in', 
				axisTitlesPosition: 'in',
				hAxis: {
					textPosition: 'out', 
					slantedTextAngle: '90',
					textStyle: {color: '#666',fontSize:9},
					gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
					viewWindow:{min:'0'},
				}, 
				vAxis: {
					textPosition: 'in',
					baselineColor: "#AAA",
					textStyle: {color: '#666',fontSize:10},
					gridlines: {color: "#ECECEC", count: "6"},
					viewWindow:{min:'0'},
				},
	        };
	        var chart = new google.visualization.ColumnChart(document.getElementById('2day_chart'));
	        chart.draw(data, options);
	      }

	//week
			google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(weekChart);
      function weekChart() {
        var data = google.visualization.arrayToDataTable([
          ['Modules', 'Staff', 'Users'],
		  {% for m in modules_sequence %}
			  {% for k,v in modules_staff_week.items %}
			  		{% if m == k %}
							{%for a,b in modules_user_week.items %}
									{% if k == a %}
								          ['{{k}}',{{v}},{{b}}],
									{% endif %}
							{% endfor %}
					{% endif %}
				{% endfor %}
          {% endfor %}
		  ]);
        var options = {
			backgroundColor: '#FEFEFE',
			width: 733,
			height: 270,
			colors:['#058DC7','#c70505'],
			chartArea: {left:0, top:15,width:"733", height:"200"},
			legend: {position: 'none'},
			titlePosition: 'in', 
			axisTitlesPosition: 'in',
			hAxis: {
				textPosition: 'out', 
				slantedTextAngle: '90',
				textStyle: {color: '#666',fontSize:9},
				gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
				viewWindow:{min:'0'},
			}, 
			vAxis: {
				textPosition: 'in',
				baselineColor: "#AAA",
				textStyle: {color: '#666',fontSize:10},
				gridlines: {color: "#ECECEC", count: "6"},
				viewWindow:{min:'0'},
			},

					
        };
		

        var chart = new google.visualization.ColumnChart(document.getElementById('Week_chart'));
        chart.draw(data, options);
      }
      	



	//month
			
			google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(monthChart);
      function monthChart() {
        var data = google.visualization.arrayToDataTable([
          ['Modules', 'Staff', 'Users'],
		  {% for m in modules_sequence %}
		  
			  {% for k,v in modules_staff_month.items %}
			   
			  		{% if m == k %}
					
							{%for a,b in modules_user_month.items %}
									
									{% if k == a %}
				  			
								          ['{{k}}',{{v}},{{b}}],
										
									{% endif %}
										
							{% endfor %}
				
					{% endif %}
										
				{% endfor %}
						  
          {% endfor %}
		  ]);
		  

        var options = {
			backgroundColor: '#FEFEFE',
			width: 733,
			height: 270,
			colors:['#058DC7','#c70505'],
			chartArea: {left:0, top:15,width:"733", height:"200"},
			legend: {position: 'none'},
			titlePosition: 'in', 
			axisTitlesPosition: 'in',
			hAxis: {
				textPosition: 'out', 
				slantedTextAngle: '90',
				textStyle: {color: '#666',fontSize:9},
				gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
				viewWindow:{min:'0'},
			}, 
			vAxis: {
				textPosition: 'in',
				baselineColor: "#AAA",
				textStyle: {color: '#666',fontSize:10},
				gridlines: {color: "#ECECEC", count: "6"},
				viewWindow:{min:'0'},

			},

					
        };
		

        var chart = new google.visualization.ColumnChart(document.getElementById('Month_chart'));
        chart.draw(data, options);
      }
      	
	//year
			
			google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(yearChart);
      function yearChart() {
        var data = google.visualization.arrayToDataTable([
          ['Modules', 'Staff', 'Users'],
		  {% for m in modules_sequence %}
		  
			  {% for k,v in modules_staff_year.items %}
			   
			  		{% if m == k %}
					
							{%for a,b in modules_user_year.items %}
									
									{% if k == a %}
				  			
								          ['{{k}}',{{v}},{{b}}],
										
									{% endif %}
										
							{% endfor %}
				
					{% endif %}
										
				{% endfor %}
						  
          {% endfor %}
		  ]);
		  

        var options = {
			backgroundColor: '#FEFEFE',
			width: 733,
			height: 270,
			colors:['#058DC7','#c70505'],
			chartArea: {left:0, top:15,width:"733", height:"200"},
			legend: {position: 'none'},
			titlePosition: 'in', 
			axisTitlesPosition: 'in',
			hAxis: {
				textPosition: 'out', 
				slantedTextAngle: '90',
				textStyle: {color: '#666',fontSize:9},
				gridlines: {color: "#ECECEC",count: "6"},minValue:'0',
				viewWindow:{min:'0'},
			}, 
			vAxis: {
				textPosition: 'in',
				baselineColor: "#AAA",
				textStyle: {color: '#666',fontSize:10},
				gridlines: {color: "#ECECEC", count: "6"},
				viewWindow:{min:'0'},

			},

					
        };
		

        var chart = new google.visualization.ColumnChart(document.getElementById('Year_chart'));
        chart.draw(data, options);
      }


		//pie modules	

      google.setOnLoadCallback(drawpieChart);

      function drawpieChart(){
	  
	  	// Create the data table.
				var data = new google.visualization.DataTable();
				data.addColumn('string', 'modules');
				data.addColumn('number', 'contents');
				data.addRows([
				{% for k,v in total_modules %}
			  		{% for m,n in percentage_modules %}
						{% if k == m %}
					  		['{{k}} - {{n}}% ',{{v}}],
						{% endif %}
					{% endfor %}
				{% endfor %}
         
        		]);
				
				// Set chart options
				var options = {
					'title': 'Total Contents Overview',
					'width': 400,
					'height': 300,
					is3D:true,
					titleTextStyle: {
						color: '#000',
						fontName: 'Lucida Sans',
						fontSize: 12
					},
					titlePosition: 'out',
					hAxis: {
						titleTextStyle: {
							color: '#000'
						},
						textPosition: 'in'
					},
					vAxis: {
						title: '{{ name }}',
						titleTextStyle: {
							color: '#C6D9FD'
						},
						textPosition: 'out'
					},
					axisTitlesPosition: 'out',
					legend: 'right',
					legendTextStyle: {
						fontSize: 11
					},
					//toolltip:{textStyle: {color: '#FF0000'}, showColorCode: true},
					//colors: ['#58db25', '#2e7114', '#4ec221'],
					chartArea: {
						left: 30,
						top: 40,
						width: "100%",
						height: "70%"
					},
					pieSliceText:'none',
					tooltip:{text:'value'},
					pieSliceBorderColor: 'black',
					
				
				};
				
				// Instantiate and draw our chart, passing in some options.
				var chart = new google.visualization.PieChart(document.getElementById('modules_all_chart'));
				chart.draw(data, options)
			}
	




//staff modules	

      google.setOnLoadCallback(drawstaffChart);

      function drawstaffChart(){
	  
	  	// Create the data table.
				var data = new google.visualization.DataTable();
				data.addColumn('string', 'staff');
				data.addColumn('number', 'contents');
				data.addRows([
				{% for k,v in staff_module %}
			  		{% for m,n in percentage_staff %}
						{% if k == m %}
					  		['{{k}} - {{n}}% ',{{v}}],
						{% endif %}
					{% endfor %}
				{% endfor %}
         
        		]);
				
				// Set chart options
				var options = {
					'title': 'Staff Contents Overview',
					'width': 400,
					'height': 300,
					is3D:true,
					titleTextStyle: {
						color: '#000',
						fontName: 'Lucida Sans',
						fontSize: 12
					},
					titlePosition: 'out',
					hAxis: {
						titleTextStyle: {
							color: '#000'
						},
						textPosition: 'in'
					},
					vAxis: {
						title: '{{ name }}',
						titleTextStyle: {
							color: '#C6D9FD'
						},
						textPosition: 'out'
					},
					axisTitlesPosition: 'out',
					legend: 'right',
					legendTextStyle: {
						fontSize: 11
					},
					//toolltip:{textStyle: {color: '#FF0000'}, showColorCode: true},
					//colors: ['#58db25', '#2e7114', '#4ec221'],
					chartArea: {
						left: 30,
						top: 40,
						width: "100%",
						height: "70%"
					},
					pieSliceText:'none',
					tooltip:{text:'value'}
				
				};
				
				// Instantiate and draw our chart, passing in some options.
				var chart = new google.visualization.PieChart(document.getElementById('modules_staff_chart'));
				chart.draw(data, options)
			}
//users modules	

      google.setOnLoadCallback(drawuserChart);

      function drawuserChart(){
	  
	  	// Create the data table.
				var data = new google.visualization.DataTable();
				data.addColumn('string', 'uesrs');
				data.addColumn('number', 'contents');
				data.addRows([
				{% for k,v in users_module %}
			  		{% for m,n in percentage_users %}
						{% if k == m %}
					  		['{{k}} - {{n}}% ',{{v}}],
						{% endif %}
					{% endfor %}
				{% endfor %}
         
        		]);
				
				// Set chart options
				var options = {
					'title': 'User Contents Overview',
					'width': 400,
					is3D:true,
					'height': 300,
					titleTextStyle: {
						color: '#000',
						fontName: 'Lucida Sans',
						fontSize: 12
					},
					titlePosition: 'out',
					hAxis: {
						titleTextStyle: {
							color: '#000'
						},
						textPosition: 'in'
					},
					vAxis: {
						title: '{{ name }}',
						titleTextStyle: {
							color: '#C6D9FD'
						},
						textPosition: 'out'
					},
					axisTitlesPosition: 'out',
					legend: 'right',
					legendTextStyle: {
						fontSize: 11
					},
					//toolltip:{textStyle: {color: '#FF0000'}, showColorCode: true},
					//colors: ['#58db25', '#2e7114', '#4ec221'],
					chartArea: {
						left: 30,
						top: 40,
						width: "100%",
						height: "70%"
					},
					pieSliceText:'none',
					tooltip:{text:'value'}
				
				};
				
				// Instantiate and draw our chart, passing in some options.
				var chart = new google.visualization.PieChart(document.getElementById('modules_users_chart'));
				chart.draw(data, options)
			}
	
	
   </script>
	
{% endblock %}