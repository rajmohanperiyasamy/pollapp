{% extends "user_base.html" %}
{% load tabs %}
{% load i18n %}
{% load upload_tags %}
{% block navigation %}
	{% activetab "selmodule" "payment_history" %}
{% include "account/account_side_bar.html" %}
{% endblock %}
{% block pagetitle %}{% trans 'Transaction' %} {% endblock %}
{% block head %}
	<link type="text/css" rel="stylesheet" href="{{STATIC_URL}}css/bm.jfp.ui.css">
{% endblock %}
{% block content %}
<div class="span10 sP9mX979 sP12mX767">
    <div class="row-fluid">
		<div class="main span9">
			<section class="sCn pD0">
				<div class="cLrFx pD20">
					<div class="pLlT w100mP">
						<h3 class="mR0 fS16 fW-bLd tRnCt">{% trans 'Transactions' %}</h3>
					</div>
                    
				</div>
				<div class="pD20 pDt0">
					<div class="tLbR mRb10 pD0">
                        <div class="tLbR-iR">
                        	<!--div class="pLlT mRr10">
                            	<span class="ib mRr15 mRt4"><input type="checkbox" class="" name="item-select-all" id="item-select-all"></span>
                        	</div>
                        	<div class="pLlT">
                            	<button class="btn btn-light btn-small mRl5" title="Delete"><i aria-hidden="true" class="bUi-iCn-rCyL-16 ib"></i></button>
                        	</div -->
                        	<div class="pLlT mRt10">
                        		<span class="pLlT fS11 pDt7 cLr-gRy">{% trans 'View' %}:  </span>
								<input type="hidden" id="filter" value="{% if filter %}{{filter}}{% endif %}">
								<select id="orderSelect" dataplaceHolder="Filter By" onchange="$('#id_view_by').val($(this).val()),filter_content(1);" class="bUiSlCtbtn-link tXt-sMl pLrT">
									<option value="">{% trans 'All transactions' %}</option>
									<optgroup label="{% trans 'Payment' %}&nbsp;{% trans 'Gateway' %}">
									   <option {% if filter == 'Paypal' %}selected="selected"{% endif %} value="Paypal">{% trans 'PayPal' %}</option>
									   <option {% if filter == 'Authorize.net' %}selected="selected"{% endif %} value="Authorize.net">{% trans 'Authorize.Net' %}</option>
									   <option {% if filter == 'Stripe' %}selected="selected"{% endif %} value="Stripe">{% trans 'Stripe' %}</option>
									   <option {% if filter == 'Offline' %}selected="selected"{% endif %} value="Offline">{% trans 'Offline' %}</option>
									</optgroup>
									<optgroup label="{% trans 'Status' %}">
										<option {% if filter == 'Success' %}selected="selected"{% endif %} value="Success">{% trans 'Payment Success' %}</option>
								  		<option {% if filter == 'Pending' %}selected="selected"{% endif %} value="Pending">{% trans 'Payment Pending' %}</option>
									</optgroup>
									<optgroup label="{% trans 'Modules' %}">
										<option {% if filter == 'articles' %}selected="selected"{% endif %} value="article">{% trans 'Articles' %}</option>
									    <option {% if filter == 'business' %}selected="selected"{% endif %} value="business">{% trans 'Business' %}</option>
									    <option {% if filter == 'classifieds' %}selected="selected"{% endif %} value="classifieds">{% trans 'Classifieds' %}</option>
									    <option {% if filter == 'deal' %}selected="selected"{% endif %} value="deal">{% trans 'Deals' %}</option>
									    <option {% if filter == 'event' %}selected="selected"{% endif %} value="event">{% trans 'Events' %}</option>
										<option {% if filter == 'banner advertisements' %}selected="selected"{% endif %} value="banner advertisements">{% trans 'Banners' %}</option>
									</optgroup>
								</select>
                        	</div>
							<div class="pLrT pLlTSmP mRt10SmP">
                                <form class="form-search mRb0" id="member-search-form" action="javascript:void(0);">
									<a><span onclick="clear_search();" class="reset txt-button tttxt" id="close_search" title="{% trans 'Clear Search' %}" style="{% if not search %}display:none;cursor: pointer;{% endif %}">Clear search</span></a>
									<input type="hidden" id="id_search" value="{% if search %}true{% endif %}">
									<div class="input-append iNsD">
                                        <input type="text" class="search-query fS13 pD510 h34" value="{% if search %}{{search}}{% endif %}" name="search_keyword" placeholder="{% trans 'Search Invoice/Transaction ID' %}" id="id_search_keyword" maxlength="100">
                                        <button type="submit" class="btn btn-link pD510 cLr-gRy" onclick="if($('#id_search_keyword').val()!=''){sort_search();}" role="button"><i aria-hidden="true" class="bUi-iCn-sRh-16 fS14 ib"></i></button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
					<div id="content_ajax">
						{% include 'payments/user/ajax_payment_history.html' %}    
					</div>
		            
				</div>
			</section>
		</div> <!-- /.main -->
		<aside class="sD-bR span3">
			<div>
				<section class="tXt-cTr pD0 bNr-aD"> 
                   
                </section>
			</div>
		</aside>
	</div>  <!-- /.row-fluid -->
</div>  <!-- /.span10 -->
<div id="loading_image" style="display:none;">
	<div style="text-align: center; width: 100%;">
		<img src="{{STATIC_URL}}ui/images/global/loading.gif" align="...">
	</div>
</div>
<div id="transactionsDetails" class="modal hide fade mW40" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 id="myModalLabel" class="mR50">Transactions Details</h4>
    </div>
    <div class="modal-body">
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="submit" data-dismiss="modal">Done</button>
    </div>
</div>
<div id="stripeunsubscribe" class="modal hide fade mW40" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 id="myModalLabel" class="mR50">Transactions Details</h4>
    </div>
    <div class="modal-body">
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="submit" data-dismiss="modal">Done</button>
    </div>
</div>
{% endblock %}			
{% block footerarea %}
<script type="text/javascript">
function filter_content(val,page){
	if (page == '1') {
	    var page = page;
	} else {
	    var page = $('#id_pagentn').val()
	}
    var value = $('#orderSelect').val();
	var dataString="&filter="+value+'&page='+page;
	if($('#id_search').val()=='true'){dataString+="&search="+$('#id_search_keyword').val();}
	$('#content_ajax').addClass('oP50'); 
	$.ajax({
		type: "GET",
		url: '{% url 'user_ajax_view_payment_history' %}',
		data: dataString,
		success: function(data){
			$('#content_ajax').empty().html(data);
			$('#content_ajax').removeClass('oP50'); 
			$('html,body').animate({ scrollTop: 0 }, 'slow');
		}
	});
}
function sort_search(){
	$('#close_search').show();
	$('#id_search').val('true');
	var dataString="&search="+$('#id_search_keyword').val();
	if($('#filter').val()!=''){dataString+="&filter="+$('#filter').val();}
	$('#content_ajax').hide();
	$('#content_ajax_loading').show();
	$.ajax({
		type: "GET",
		url: '{% url 'user_ajax_view_payment_history' %}',
		data: dataString,
		success: function(data){
			$('#content_ajax').show();
			$('#content_ajax_loading').hide();
			$('#content_ajax').empty().html(data);
		}
	});
}
function goto_list(page){
	var dataString='page='+page;
	if($('#filter').val()!=''){dataString+="&filter="+$('#filter').val();}
	if($('#id_search').val()=='true'){dataString+="&search="+$('#id_search_keyword').val();}
	$('#content_ajax').hide();
	$('#content_ajax_loading').show();
	$.ajax({
		type: "GET",
		url: '{% url 'user_ajax_view_payment_history' %}',
		data: dataString,
		success: function(data){
			$('#content_ajax').show();
			$('#content_ajax_loading').hide();
			$('#content_ajax').empty().html(data);
		}
	});
}
function clear_search(){
	$('#id_search').val('');
	$('#id_search_keyword').val('');
	$('#close_search').hide();
	filter_content();
}
</script>
{% endblock %}	

