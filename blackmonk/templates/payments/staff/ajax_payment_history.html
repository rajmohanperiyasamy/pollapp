{% load i18n %}
{% load tz %}
<ul class="cat-list-container">
    <li class="cat-list-row hdr-rw">
        <div class="cat-list-row-inner group">
            <div class="cat-list-column transaction-id">
            	{% trans 'Invoice Id' %}                                                
            </div>
            <div class="cat-list-column transaction-status">
            	{% trans 'Status' %}
            </div>
            <div class="cat-list-column transaction-date">
            	{% trans 'Date' %}
            </div>
            <div class="cat-list-column transaction-amount">
            	{% trans 'Amount' %}
            </div>
            <div class="cat-list-column transaction-account">
            	{% trans 'Module' %}
            </div>
            <div class="cat-list-column transaction-system">
            	{% trans 'Gateway' %}
            </div>
		</div>
	</li>       
	{% if payments %}                              
	    {% for payment in payments %}
		<li class="cat-list-row">
	        <div class="cat-list-row-inner group">
	            <div class="cat-list-column transaction-id">
					<span class="id">{% if payment.txn_type == 'subscr_payment' %}{% trans "Subscription" %}{% else %}{{payment.invoice_no}}{% endif %}</span>
	            </div>
	            <div class="cat-list-column transaction-status">
	            	<div class="item-status no-options">
	                    <span class="status-inside inline-block"><span class="inline-block status-idty {% if payment.status == 'Success' %}icon-approved{% elif payment.status == 'Pending' %}icon-pending{% elif payment.status == 'Expired' %}icon-rejected{% endif %}"></span><span class="arrow"></span></span>	 
	                </div>
	            </div>
	            <div class="cat-list-column transaction-date">
	            	<span class="date">{{payment.created_on|date:'M-d Y'}}</span>
	                <span class="time">{{payment.created_on|localtime|time:"P"}}</span>
	            </div>
	            <div class="cat-list-column ovr-visible transaction-amount">
	            	<span class="amount">{{globalsettings.currency}} {{payment.amount|floatformat:2}}</span>                                  
	            </div>  
	            <div class="cat-list-column ovr-visible transaction-account">
	            	<span class="account">{{payment.content_type.name|capfirst}}</span>                                  
	            </div>
	            <div class="cat-list-column ovr-visible transaction-system">
	            	<span class="system">{{payment.payment_mode}}</span>                                  
	            </div> 
	            <div class="cat-list-column item-view-toggle">
	                 <a class="collapse-view" href="#">{% trans 'Expand View' %}</a>
	             </div>                                                                                             
			</div>
	        <ul class="sub-cat-list-container" style="display:none;">
	        	<li class="payment-detail-container group">
	                 <ul class="payment-detail">
	                	<li class="group row">
	                    	<div class="column-1">{% trans 'Product Name/Title' %} : </div>
	                        <div class="column-2">{{payment.object_name}}{% if not payment.content_object %} ({% trans 'Deleted'%}){% endif %}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Listing Type' %} : </div>
	                        <div class="column-2">{{payment.listing_type|capfirst}}</div>
	                    </li>
	                	<li class="group row">
	                    	<div class="column-1">{% trans 'Module' %} : </div>
	                        <div class="column-2">{{payment.content_type.name|capfirst}}</div>
	                    </li>
						{% if payment.start_date and payment.end_date %}
						<li class="group row">
	                    	<div class="column-1">{% trans 'Duration' %} : </div>
	                        <div class="column-2">
	                        	<span style=" display:block;">{{ payment.start_date|timesince:payment.end_date }}</span>
								<span style="color:#999; font-size: 11px;"> {{payment.start_date|date:"M d Y"}} - {{payment.end_date|date:"M d Y"}}</span> 
							</div>
	                    </li>
						{% endif %}
						<li class="group row">
	                    	<div class="column-1">{% trans 'Payment Mode' %} : </div>
	                        <div class="column-2">{{payment.payment_mode}}</div>
							{% if payment.payment_mode = 'Offline' and payment.status = 'Pending' and payment.content_object %}
							<div style="float: right;" ><a class="bm-add-gadget light_box" title='Receive Offline Payment' href='{% url "staff_ajax_offline_payment" payment.id %}'>Receive Payment</a></div>
	                    	{% endif %}
	                    </li>
						{% if payment.get_pay_obj %}
						<li class="group row">
	                    	<div class="column-1">{% trans 'Subscription ID' %} : </div>
	                        <div class="column-2">{{payment.get_pay_obj}}</div>
	                    </li>
						{% endif %}
						{% if payment.invoice_no %}
	                	<li class="group row">
	                    	<div class="column-1">{% trans 'Invoice No' %} : </div>
	                        <div class="column-2">{{payment.invoice_no}}</div>
	                    </li>
						{% endif %}
	                    <li class="group row">
	                    	<div class="column-1">{% trans 'Transaction ID' %} : </div>
	                        <div class="column-2">{% if payment.transactionid %}{{payment.transactionid}}{% else %}N/A{% endif %}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Contact Person' %} : </div>
	                        <div class="column-2">{% if payment.user.display_name %}{{payment.user.display_name|title}}{% else %}N/A{% endif %}</div>
	                    </li>
						{% if payment.payment_mode = 'Offline' %}
	                    <li class="group row">
	                    	<div class="column-1">{% trans 'Preferred Contact Mode' %} : </div>
	                        <div class="column-2">{% if payment.contact_mode %}{{payment.contact_mode|title}}{% else %}N/A{% endif %}</div>
	                    </li>
	                    <li class="group row">
	                    	<div class="column-1">{% trans 'Contact-Email' %} : </div>
	                        <div class="column-2">{% if payment.email %}{{payment.email}}{% else %}N/A{% endif %}</div>
	                    </li>
	                    <li class="group row">
	                    	<div class="column-1">{% trans 'Contact Number' %} : </div>
	                        <div class="column-2">{% if payment.phone_no %}{{payment.phone_no}}{% else %}N/A{% endif %}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Offline Payment Mode' %} : </div>
	                        <div class="column-2">{% if payment.offline_mode %}{{payment.offline_mode}}{% else %}N/A{% endif %}</div>
	                    </li>
						{% endif %}
						{% if payment.content_object.dealpayment.all %}
						{% for pay in payment.content_object.dealpayment.all %}
						{% if payment.transactionid == pay.transaction_no %}
						<li class="group row">
	                    	<div class="column-2" style="padding-left:20%;">
	                    		<h4>{% trans 'Billing Address'%} </h4>
							</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Name' %} : </div>
	                        <div class="column-2">{{pay.name}}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Address' %} : </div>
	                        <div class="column-2">{{pay.address}}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Mobile' %} : </div>
	                        <div class="column-2">{{pay.mobile}}</div>
	                    </li>
						<li class="group row">
	                    	<div class="column-1">{% trans 'Email' %} : </div>
	                        <div class="column-2">{{pay.email}}</div>
	                    </li>
						{% if pay.is_friend %}
							<li class="group row">
		                    	<div class="column-2" style="padding-left:20%;">
		                    		<h4>{% trans 'Gifted to'%} </h4>
								</div>
		                    </li>
							<li class="group row">
		                    	<div class="column-1">{% trans 'Name' %} : </div>
		                        <div class="column-2">{{pay.gift_addr.g_name}}</div>
		                    </li>
							<li class="group row">
		                    	<div class="column-1">{% trans 'Message' %} : </div>
		                        <div class="column-2">{{pay.gift_addr.g_message}}</div>
		                    </li>
							<li class="group row">
		                    	<div class="column-1">{% trans 'Mobile' %} : </div>
		                        <div class="column-2">{{pay.gift_addr.g_mobile}}</div>
		                    </li>
							<li class="group row">
		                    	<div class="column-1">{% trans 'Email' %} : </div>
		                        <div class="column-2">{{pay.gift_addr.g_email}}</div>
		                    </li>
						{% endif %}
						{% endif %}
						{% endfor %}
						{% endif %}
	                </ul>
	            </li>
	        </ul>
		</li>
		{% endfor %}
	{% else %}
	<li>
		<div class="no-data">
			<p>{% trans 'No Payment history found!!!' %}</p>	
		</div>
	</li>
	{% endif %}
</ul>
{% include 'payments/staff/pagenation.html' %}   