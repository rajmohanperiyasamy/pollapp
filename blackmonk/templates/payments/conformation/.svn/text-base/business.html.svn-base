{% extends "user_base.html" %}
{% load tabs %}
{% load i18n %}
{% load thumbnail %}
{% block navigation %}
	{% activetab "leftnav" "business" %}
	{{ block.super }}
{% endblock %}
{% block pagetitle %}{% trans 'Business Payment Conformation' %} {% endblock %}
{% block head %}
{% endblock %}
{% block content %}
<div class="span10 sP9mX979 sP12mX767">
		                <div class="row-fluid">
							<div class="main span9">
								<section class="sCn pD0">
									<div class="cLrFx pD20">
										<div class="pLlT">
											{% if claim == 1 %}
					                            <div class="mRr5 mRb15"><a class="btn btn-small btn-light" href="{% url 'user_claim_business' pay_obj.id %}"><i class="bUi-iCn-aRw-l-16  ib" aria-hidden="true"></i> <strong class="ib">Back</strong></a></div>
					                        {% else %}
					                            <div class="mRr5 mRb15"><a class="btn btn-small btn-light" href="{% url 'user_add_business_listing' pay_obj.id %}"><i class="bUi-iCn-aRw-l-16  ib" aria-hidden="true"></i> <strong class="ib">Back</strong></a></div>
					                        {% endif %}
											<h3 class="mR0 tRnCt">Business Summary</h3>
										</div>
									</div>
									<hr class="mRb12 mRt0">
									<div class="pD20">
                                        	<div class="sCn-tTl">
                                                <h3 class="clearfix oFl">
                                                    <span class="ib pLlT">Order Details</span>
                                                </h3>
                                            </div>
                                        	<table class="table table-bordered bDrT0Mp">
                                                <thead class="hMp bFa">
                                                    <tr>
                                                        <th class="span4">
                                                            <span>Item Details</span>
                                                        </th>
                                                        <th class="span1">
                                                            <span>Ad Type</span>
                                                        </th>
                                                        <th class="span2">
                                                            <span>Duration</span>
                                                        </th>
                                                        <th class="tXt-rT span1">
                                                            <span>Total</span>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td class="span4">
                                                            <div class="control-group">
                                                                <label class="control-label pDt0 vOp">Item Details</label>
                                                                <ul class="modulesBrowseData mDa-lT mDa-oT-lT dSrS480">
                                                                    <li class="mDa mRb0">
                                                                        <div class="mDa-iN bDr0 pD0">
                                                                            {% if pay_obj.logo %}
                                                                            <div class="mDa-wPr">
                                                                                <a class="bUi-tMb-wPr tMb-75 dSpD fLxiMgW bUi-tMb-110" href="{% url 'user_preview_business' pay_obj.id %}">
                                                                                    <span class="bUi-tMb">
                                                                                        <span class="bUi-tMb-pRpL">
                                                                                            <span class="bUi-tMb-cLp">
                                                                                                <span class="bUi-tMb-cLp-iN">
                                                                                                    <img class="mDa-oT" alt="{{ pay_obj.get_payment_title }}" title="{{ pay_obj.get_payment_title }}" src="{% if pay_obj.logo %}{% thumbnail pay_obj.logo.logo 110x0 %}{% else %}{{STATIC_URL}}ui/images/global/img-none.png{% endif %}">
                                                                                                    <span class="vRtL-aLn">
                                                                                                    </span>
                                                                                                </span>
                                                                                            </span>
                                                                                        </span>
                                                                                    </span>
                                                                                </a>
                                                                            </div>
                                                                            {% endif %}
                                                                            <div class="mDa-bDy">
                                                                                <h4 title="{{ pay_obj.get_payment_title }}" class="mDa-hD tRnCt0 rLvE">
                                                                                    {{ pay_obj.get_payment_title }}
                                                                                </h4>
                                                                                <div class="mDa-dTa">
                                                                                    <ul class="iCnC-lSt iCn10 iCn-gRy">
                                                                                        <li class="iCnC-lSt-iTm" style="white-space: normal;">
                                                                                            <i class="bUi-iCn-mP-mKr-12" aria-hidden="true"></i>
                                                                                            {% with pay_obj.address.all.0 as address %}{{address.address1}}, {% if address.address2 %}{{address.address2}}, {% endif %}{{address.zip}}{% endwith %}
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </td>
                                                        <td class="span1">
                                                            <div class="control-group">
                                                                <div class="controls">
                                                                    <label class="control-label pDt0 vOp">Ad Type</label>
                                                                    <label class="fW-nRmL">{% if level %}
																		{{level.level_label|title}}
																		{% else %}
										                        		{{pay_obj.get_payment_listing_type|title}}
																	{% endif %} </label>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="span2">
                                                            <div class="control-group">
                                                                <label class="control-label pDt0 vOp">Duration</label>
                                                                <div class="controls">
                                                                    <label class="fW-nRmL">
																		{% if payment_config %}{{ payment_config.currency_symbol }}{% else %}{{globalsettings.currency}}{% endif %}{{listing_price|floatformat:2}} for each 
																		{% if listing_period == 'M' or listing_period == 'm' %}
																			{% trans 'Month' %}
																		{% else %}
																			{% trans 'Year' %}
																		{% endif  %}
																		Effective Date: {{lstart_date|date:'M j Y'}}<br/>
																		End Date: {{lend_date|date:'M j Y'}}																			
																	</label>
                                                                    <!--p class="fS12 cLr-gRy">
                                                                        <span class="fS11 cLr-lTgRy">{{lstart_date|date:'M j Y'}} </span>
                                                                        <span class="fS11 cLr-lTgRy sPrTr">{{lend_date|date:'M j Y'}}</span>
                                                                    </p-->
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="tXt-rT span1"><strong class="fS13 pLlT vOp">Total</strong><strong class="fS14"> {% if payment_config %}{{ payment_config.currency_symbol }}{% else %}{{globalsettings.currency}}{% endif %}{{listing_price|floatformat:2}} </strong></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div class="row-fluid mRb10 tXt-rT">
                                                <div class="ib mRr10 cLr-gRy">You pay :</div>
                                                <h3 class="ib">{% if payment_config %}{{ payment_config.currency_symbol }}{% else %}{{globalsettings.currency}}{% endif %}{{listing_price|floatformat:2}}</h3>
                                            </div>
											{% if payment_config %}
                                            <div class="control-group">
                                                <label class="control-label">Payment gateway</label>
                                                <div class="controls">
													{% if payment_config.paypal_payment %}
														<label class="radio fW-nRmL mRb0"><input type="radio" class="mRt3" name="payment_option" value="paypal" checked="checked">{% trans "Paypal" %}</label>
											   		{% endif %}
				                                    
													{#% if payment_config.authorize %#}
													<!--label class="radio fW-nRmL"><input type="radio" class="mRt3" name="payment_option" value="authorizenet">{% trans "Authorizenet" %}</label-->
				                                    {#% endif %#}
													
													{% if payment_config.stripe %}
															<label class="radio fW-nRmL"><input type="radio" class="mRt3" name="payment_option" value="creditcard">{% trans "Credit Card" %}</label>
														{% endif %}
															<!--span class="cform-radio-container"><input type="radio" name="payment_option" value="googlecheckout"><span class="cform-radio-element"></span></span-->
                                                </div>
                                            </div>
											{% endif %}
											{% if paid_object %}
											<label class="control-label">You have opted to pay offline.Please verify the below details.</label>
											<form method="post" id="pform" class="form-horizontal uSr-aCnT mRb0" action="{% url 'business_payments_offline_confirm' pay_obj.id business_price.id %}">
												<input type ='hidden' value='banners' name='type' id='type'>
												<div class="control-group">
					                                <label class="control-label">Name:</label>
					                                <div class="controls">
					                                    <input type="text" value="{{paid_object.user.display_name}}" placeholder="Name" name="pay_name" maxlength="30" id="pay_name" class="iSp8" autocomplete="off">
					                                </div>
					                            </div>
												<div class="control-group">
					                                <label class="control-label">Email:<em class="cLr-rEd">*</em></label>
					                                <div class="controls">
					                                    <input type="text" value="{{paid_object.user.useremail}}" placeholder="Email" name="pay_email" maxlength="30" id="pay_email" class="iSp8" autocomplete="off">
					                                </div>
					                            </div>
												<div class="control-group">
					                                <label class="control-label">Phone No:<em class="cLr-rEd">*</em></label>
					                                <div class="controls">
					                                    <input type="text" placeholder="Phone No" name="pay_phone" maxlength="16" id="pay_phone" class="iSp8" autocomplete="off">
					                                </div>
					                            </div>
												<div class="control-group">
					                                <label class="control-label">How would you like to be contacted:<em class="cLr-rEd">*</em></label>
					                                <div class="controls">
					                                    <label for="id_is_contact_mode_1"><input type="radio" value="email" name="contact_mode" id="contact_mode_1" checked="checked">Email</label>
														<label for="id_is_contact_mode_2"><input type="radio" value="phone" name="contact_mode" id="contact_mode_2">Phone</label>
					                                </div>
					                            </div>
												<div class="control-group">
					                                <label class="control-label">Mode of payment:<em class="cLr-rEd">*</em></label>
					                                <div class="controls">
					                                    <label for="id_is_pay_mode_1"><input type="radio" value="cash" name="pay_mode" id="pay_mode_1" checked="checked">Cash</label>
														<label for="id_is_pay_mode_2"><input type="radio" value="cheque" name="pay_mode" id="pay_mode_2" >Cheque</label>
														<label for="id_is_pay_mode_3"><input type="radio" value="dd" name="pay_mode" id="pay_mode_3">Demand Draft(DD)</label>
					                                </div>
					                            </div>
												<div class="row-fluid">
					                                <div class="form-actions pD0 pLrT">
														<input type="submit" name="offlinesubmit" class="btn btn-primary fS12 fW-bLd mRl5" value="{% trans 'Submit' %}" />
					                                </div>
					                            </div>
											</form>
											{% endif %}
                                            <div class="control-group">
                                                <div class="controls">
                                                    <label for="gender1" class="checkbox inline fW-nRmL fS12">
                                                        <input type="checkbox" id="terms" name="terms">
                                                        I have read and agreed to the
                                                        <a href="/terms-of-use.html" target="_blank">Terms of Service</a>
                                                        and
                                                        <a href="/privacy-policy.html" target="_blank">Privacy Policy</a>
                                                    </label>
                                                </div>
                                            </div>
                                            <hr class="oTsT-hRz20 mRb0">
                                            <div class="row-fluid">
                                                <div class="form-actions pD0 pLlT">
												{% if payment_config.paypal_payment %}
														<form action="" method="post" id="paypal_form">{% csrf_token %}
															<input type="hidden" value="authorizenet" name="payment_options" />
														   	<input type="submit" name="submit" class="btn btn-primary fS12 fW-bLd mRl5" value="{% trans 'Proceed' %}" />
														</form>
													{% endif %}
					
												{% if payment_config.stripe %}
													<form method="post" id="stripe_form">
														<input type="hidden" name="stripeToken" id="stripeToken">
														<input type="hidden" name="stripePeriod" id="stripePeriod" value="{% if listing_period == 'M' or listing_period == 'm' %}month{% else %}year{% endif %}">
														<input style="display:none;" type="submit" id="stripe_button" class="btn btn-primary fS12 fW-bLd mRl5" value="{% trans 'Proceed' %}" />
													</form>
												{% endif %}														
                                                </div>
                                            </div>
									</div>
								</section>
							</div> <!-- /.main -->
							<aside class="sD-bR span3">
								<div>
									<section class="tXt-cTr pD0 bNr-aD"> 
			                           
			                        </section>
								</div>
							</aside>
						</div>  <!-- /.row-fluid -->
					</div>  <!-- /.span10 -->
{% if payment_config.stripe %}
<script src="https://checkout.stripe.com/v2/checkout.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	$('#stripe_button').click(function(){
		if(!$('#terms').attr('checked')){
			alert('Please agree to the Terms of Use & Privacy Policy');
			return false;
		}
	  var token = function(res){
		$('#stripeToken').val(res.id);
		$('#stripe_form').submit()
	  };
	  StripeCheckout.open({
	    key:         '{{payment_config.stripe_public_key}}',
	    amount:      {{stripe_sp_cost}},
	    name:        '{{ pay_obj.get_payment_title|capfirst }}',
	    description: '{% if level %}{{level.level_label|title}}{% else %}{{pay_obj.get_payment_listing_type|title}}{% endif %} {% if listing_period == 'M' or listing_period == 'm' %}{% trans 'Monthly' %}{% else %}{% trans 'Yearly' %}{% endif  %}',
	    token:       token,
		image:		'{% if pay_obj.get_payment_photo %}{% thumbnail pay_obj.get_payment_photo 110x0 %}{% else %}{{STATIC_URL}}ui/images/global/img-none.png{% endif %}',
		currency:	'{{ payment_config.currency_code }}',
		panelLabel:'{% if level.level_label = 'Featured' %}Subscribe{% else %}Pay{% endif %}',
	  });
	  return false;
	});
});
</script>
{% endif %}
<script type="text/javascript">
$(document).ready(function(){
	$('input[name=submit]').click(function(){
		if(!$('#terms').attr('checked')){
			alert('Please agree to the Terms of Use & Privacy Policy');
			return false;
		}
	});
	$("#pform").validate({
        ignore:'',
			highlight: function(element, errorClass){
				$(element).parent('div').parent('div').addClass('error');
				$(element).parent('div').addClass('error');
				$(element).addClass('error');
			},
			unhighlight: function(element, errorClass){
				$(element).parent('div').parent('div').removeClass('error');
				$(element).parent('div').removeClass('error');
				$(element).removeClass('error');
			},
        errorPlacement: function(error, element){},
           rules:{
            pay_name: "required",
			pay_phone: {required:true,number:true},
            pay_email: {required:true,email:true},
           },
    });
	$('input[name=offlinesubmit]').click(function(){
		if(!$('#terms').attr('checked')){
			alert('Please agree to the Terms of Use & Privacy Policy');
			return false;
		}
	});
	$('input[name=payment_option]').change(function(){
		if($(this).val()=='paypal'){
			$('#paypal_form').show();
			$('#stripe_button').hide();
		}
		if($(this).val()=='creditcard'){
			$('#stripe_button').show();
			$('#paypal_form').hide();

		}
	});
});
</script>
{% endblock %}	
				