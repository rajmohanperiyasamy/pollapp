{%extends "staff_base.html"%}
{% load comparison %}
{% load tabs %}
{% block navigation %}
	{% activetab "selmodule" "classifieds" %}
	{{ block.super }}
{% endblock %}
{% block head %} 
<script type="text/javascript"><!--
		function goto_next_list(p){
			var url="{{base_url}}/?page="+p;
			window.location.replace(url);
		}//-->
	</script> 
	<script type="text/javascript">
	function moreactions(objselect){
		if(objselect.value!=''){
			var v = objselect.value;
			if(v=='dlt'){actn='delete'}else if(v=='actv'){actn='activate'}else if(v=='deactv'){actn='deactivate';}
			var win = window.document.f_abuse
			if(v=='0'){return 0;}
			else if(v.length==1){
				window.location.replace('/staff/classifieds/abuse/filterby/?filter='+v);
				return 0;
			}else{
				for(var i=0;i<win.trashchecked.length;i++){
					if(win.trashchecked[i].checked==true){
						if(confirm("Do you want to "+actn+" all selected classified(s)?")){
						document.getElementById('action_').value=v;
						return 1;
						}else{
							return 0;
						}
					}
				}
				try{if(win.trashchecked.checked==true){return 1;}}catch(e){}
				alert("Please select classified(s).");
				objselect.value="0";
				return 0;
			}
		}
	}
	</script>
{%endblock%}
{%block content%}
        	<div class="page_title group" style="display:block; overflow:hidden; padding:10px 0 20px 0;">
            	<div class="bread-crumb clearfix">
                    <ul>
                        <li><a href="/staff" style="background:#666;font-size:12px; padding:2px 4px; -moz-border-radius:4px;color:#FFF">Staff Home</a></li>
                        <li><a href="/staff/classifieds" style="background:#666;font-size:12px; padding:2px 4px; -moz-border-radius:4px;color:#FFF">Classifieds</a></li>                        <li style="background:#eee;font-size:12px; padding:2px 4px; -moz-border-radius:4px;color:#666">Manage Abuse</li>
                    </ul>
                </div> 
            </div>
			<div class="page_title group" style="display:block; overflow:hidden;">
                <h2 style="display:block; margin:0; padding-left:10px; line-height:normal">Classifieds</h2> 
            </div>            
        	<div class="main" style="margin-bottom:20px;">
            	{% activetab "leftnav" "abuse" %}
				{% include 'classifieds/staff/part_nav.html' %}
               
            	<div class="main_col" style="float:left; width:740px;">
					<div class="page_title group" style="display:block; overflow:hidden; padding-top:10px;">
                		<div class="all_control">
                            <select name="category" id="qna_cat" onChange="if(1==moreactions(this)){window.document.f_abuse.submit();};" class="textField small" style="width:105px;">
                            	<option value="" style="padding-left:5px;">More actions</option>
                                <optgroup style="border-top:1px dotted #7d7d7d; margin:5px; padding-top:5px;">
                                    <option value="actv">Activate</option>
                                    <option value="deactv">Deactivate</option>
                                    <option value="dlt">Delete</option>                                            
                                </optgroup>
                                <option value="" style="padding-left:5px;">Filter by type</option>
                                <optgroup style="border-top:1px dotted #7d7d7d; margin:5px; padding-top:5px;">
                                    <option value="o">Offensive</option>
                                    <option value="s">Spam </option>
                                    <option value="d">Old Ad</option>
                                </optgroup>
                             </select>                                                         
              			</div>	
           			 </div>                           
                                 {%if message%}
                	    		<div id="m" style="padding:10px;background:lightyellow;color:#333;margin-top:5px;">
                	    			{{message}}
                	    			<script type="text/javascript">
                	    			setTimeout('hideMessage()',5 * 1000); //5 sec
                	    			hideMessage = function(){
                	    				$("#m").fadeOut();
                	    			}
                	    			</script>
                	    		</div>
                	    		{%endif%}                                       
						<table class="staff content" align="center" cellpadding="0" cellspacing="0" width="740">
							<colgroup>
								<col width="15">
								<col width="300">
								<col width="150">
								<col width="200">							
							</colgroup>	
							<script type="text/javascript">
							checkall = function(){
								var check_ = document.getElementById('sall');
								if(!check_.checked){
									$(".cb").removeAttr('checked');
								}
								if(check_.checked){
									$(".cb").attr('checked','true');
								}
							}
							</script>			
							<tbody>
								<tr class="head" style="">
									<th class="check">
										<span class="cform-checkbox-container"><input name="selectall" id="sall" onclick="checkall()" value="" type="checkbox"><span class="cform-checkbox-element"></span></span>
									</th>
									<th class="title"><div>Classified</div></th>
									<th class="posted_by"><div>Posted by / on </div></th>
									<th class="status" style="text-align: left;"><div>Abuse</div></th>								
								</tr>				
								<form action="/staff/classifieds/bulkactions/" method="post" name="f_abuse">{% csrf_token %}	
								<input type="hidden" name="action" id="action_" value=""/>
								{%for c in classified%}
								<tr class="row">
									<td class="check">
										<span class="cform-checkbox-container"><input class="cb" name="trashchecked" value="{{c.id}}" type="checkbox"><span class="cform-checkbox-element"></span></span>
									</td>	                                
									<td class="classified">
										<div class="classified_details">
											<h5><a href="#" title="See event details">{{c.title}}</a></h5>
                                            <p>
                                            {%for t in c.get_tag%}
                                            	<a href="#">{{t.tag}}</a>{%if forloop.last %}{%else%},{%endif%}
                                            {%endfor%} 
											</p> 
										</div>
									</td>
									<td class="posted_by">
										<div>
											<h5 style="font-size:12px; font-weight:normal;margin:0;"><a href="#">{{c.posted_by}}</a></h5>
											<p>On:<span> {{c.posted_on|date:"M d,Y"}}<!-- May 23, 2009 --></span></p>
										</div>											
									</td>	                                    
									<td class="status">
										<p style="color:#000">{{c.get_offensive_classifieds_report}} <span style="color:#808080; padding-right:5px; margin-right:5px; border-right:1px solid #c7c7c7;">Offensive</span>{{c.get_spam_classifieds_report}} <span style="color:#808080; padding-right:5px; margin-right:5px; border-right:1px solid #c7c7c7;">Spam</span>{{c.get_old_classifieds}} <span style="color:#808080; ">Old AD</span> 
									</p>
									</td>
									
								</tr>
								{%endfor%}
								</form>
							</tbody>
						</table>
                        {% include 'classifieds/staff/pagenation.html' %}
                </div> 
              {%endblock%}
